<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>5m10v3 blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-04-16T13:13:53.819Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>5m10v3</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>è¿‘æ—¥å­¦ä¹ æ€»ç»“</title>
    <link href="http://example.com/2024/04/15/%E8%BF%91%E6%97%A5%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/"/>
    <id>http://example.com/2024/04/15/%E8%BF%91%E6%97%A5%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/</id>
    <published>2024-04-14T16:00:00.000Z</published>
    <updated>2024-04-16T13:13:53.819Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸€å‘¨çš„å­¦ä¹ ä¸»è¦è¿˜æ˜¯ä¸ºäº†å¼„æ‡‚å¦‚ä½•åŠ¨æ€è°ƒè¯•é©±åŠ¨ï¼Œä»¥åŠå¦‚ä½•å’Œé©±åŠ¨è¿›è¡Œé€šä¿¡</p><p>ï¼Œåœ¨IOé€šä¿¡å­¦ä¹ ä¸Šæ€»æ„Ÿè§‰ç¼ºäº†ä¸€ç‚¹ä¸œè¥¿ï¼Œæˆ‘è§‰å¾—å¯èƒ½æ˜¯ç»ƒçš„å¤ªå°‘äº†ï¼Œæ²¡æœ‰å½»åº•ç†è§£å®ƒçš„å®ç°åŸç†</p><p>ä½†æ˜¯åœ¨ä¸é•¿åŸæ¯çš„é‚£é“ez_driverè¿›è¡Œé€šä¿¡çš„æ—¶å€™ï¼Œå‘ç°è¿™ä¸ªé©±åŠ¨ä¸èƒ½è¢«åŠ è½½ï¼Œåº”è¯¥æ˜¯è®¾ç½®äº†ä¸æ‰§è¡Œï¼Œç°åœ¨çš„ç›®æ ‡æ˜¯æŠŠè¿™ä¸ªåŸå› æ‰¾å‡ºæ¥å¹¶ä¸”è§£å†³ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ä¸€å‘¨çš„å­¦ä¹ ä¸»è¦è¿˜æ˜¯ä¸ºäº†å¼„æ‡‚å¦‚ä½•åŠ¨æ€è°ƒè¯•é©±åŠ¨ï¼Œä»¥åŠå¦‚ä½•å’Œé©±åŠ¨è¿›è¡Œé€šä¿¡&lt;/p&gt;
&lt;p&gt;ï¼Œåœ¨IOé€šä¿¡å­¦ä¹ ä¸Šæ€»æ„Ÿè§‰ç¼ºäº†ä¸€ç‚¹ä¸œè¥¿ï¼Œæˆ‘è§‰å¾—å¯èƒ½æ˜¯ç»ƒçš„å¤ªå°‘äº†ï¼Œæ²¡æœ‰å½»åº•ç†è§£å®ƒçš„å®ç°åŸç†&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åœ¨ä¸é•¿åŸæ¯çš„é‚£é“ez_driverè¿›è¡Œé€šä¿¡çš„æ—¶å€™ï¼Œå‘ç°è¿™ä¸ªé©±åŠ¨ä¸èƒ½è¢«åŠ è½½ï¼Œåº”è¯¥æ˜¯è®¾ç½®</summary>
      
    
    
    
    <category term="æ—¥è®°" scheme="http://example.com/categories/%E6%97%A5%E8%AE%B0/"/>
    
    
    <category term="å­¦ä¹ " scheme="http://example.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Windowså†…æ ¸é©±åŠ¨å­¦ä¹ (å…«)</title>
    <link href="http://example.com/2024/04/14/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E5%85%AB)/"/>
    <id>http://example.com/2024/04/14/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E5%85%AB)/</id>
    <published>2024-04-13T16:00:00.000Z</published>
    <updated>2024-04-16T13:14:07.179Z</updated>
    
    <content type="html"><![CDATA[<h2 id="IOé€šä¿¡"><a href="#IOé€šä¿¡" class="headerlink" title="IOé€šä¿¡"></a>IOé€šä¿¡</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;IOé€šä¿¡&quot;&gt;&lt;a href=&quot;#IOé€šä¿¡&quot; class=&quot;headerlink&quot; title=&quot;IOé€šä¿¡&quot;&gt;&lt;/a&gt;IOé€šä¿¡&lt;/h2&gt;</summary>
      
    
    
    
    <category term="å†…æ ¸é©±åŠ¨" scheme="http://example.com/categories/%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8/"/>
    
    
    <category term="Windowså†…æ ¸é©±åŠ¨å¼€å‘" scheme="http://example.com/tags/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Windowså†…æ ¸é©±åŠ¨å­¦ä¹ (ä¸ƒ)</title>
    <link href="http://example.com/2024/04/13/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%B8%83)/"/>
    <id>http://example.com/2024/04/13/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%B8%83)/</id>
    <published>2024-04-12T16:00:00.000Z</published>
    <updated>2024-04-16T13:05:17.993Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è“å±åˆ†æ"><a href="#è“å±åˆ†æ" class="headerlink" title="è“å±åˆ†æ"></a>è“å±åˆ†æ</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;è“å±åˆ†æ&quot;&gt;&lt;a href=&quot;#è“å±åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;è“å±åˆ†æ&quot;&gt;&lt;/a&gt;è“å±åˆ†æ&lt;/h2&gt;</summary>
      
    
    
    
    <category term="å†…æ ¸é©±åŠ¨" scheme="http://example.com/categories/%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8/"/>
    
    
    <category term="Windowså†…æ ¸é©±åŠ¨å¼€å‘" scheme="http://example.com/tags/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Windowså†…æ ¸é©±åŠ¨å­¦ä¹ (å…­)</title>
    <link href="http://example.com/2024/04/12/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E5%85%AD)/"/>
    <id>http://example.com/2024/04/12/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E5%85%AD)/</id>
    <published>2024-04-11T16:00:00.000Z</published>
    <updated>2024-04-13T05:17:29.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é©±åŠ¨æ–­é“¾"><a href="#é©±åŠ¨æ–­é“¾" class="headerlink" title="é©±åŠ¨æ–­é“¾"></a>é©±åŠ¨æ–­é“¾</h2><p>æœ¬æ–‡å‚è€ƒ<a href="https://www.cnblogs.com/LyShark/p/11652019.html">é©±åŠ¨å¼€å‘ï¼šDKOM å®ç°è¿›ç¨‹éšè—</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;é©±åŠ¨æ–­é“¾&quot;&gt;&lt;a href=&quot;#é©±åŠ¨æ–­é“¾&quot; class=&quot;headerlink&quot; title=&quot;é©±åŠ¨æ–­é“¾&quot;&gt;&lt;/a&gt;é©±åŠ¨æ–­é“¾&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡å‚è€ƒ&lt;a href=&quot;https://www.cnblogs.com/LyShark/p/11652019.html&quot;&gt;</summary>
      
    
    
    
    <category term="å†…æ ¸é©±åŠ¨" scheme="http://example.com/categories/%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8/"/>
    
    
    <category term="Windowså†…æ ¸é©±åŠ¨å¼€å‘" scheme="http://example.com/tags/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Windowså†…æ ¸é©±åŠ¨å­¦ä¹ (äº”)</title>
    <link href="http://example.com/2024/04/11/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%BA%94)/"/>
    <id>http://example.com/2024/04/11/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%BA%94)/</id>
    <published>2024-04-10T16:00:00.000Z</published>
    <updated>2024-04-13T05:17:03.985Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å­—ç¬¦ä¸²æ“ä½œ"><a href="#å­—ç¬¦ä¸²æ“ä½œ" class="headerlink" title="å­—ç¬¦ä¸²æ“ä½œ"></a>å­—ç¬¦ä¸²æ“ä½œ</h2><p>åŸºæœ¬æ•°æ®ç±»å‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">long</span> é‡å®šä¹‰ä¸º ULONGã€‚ </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> é‡å®šä¹‰ä¸º UCHARã€‚ </span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> é‡å®šä¹‰ä¸º UINTã€‚ </span><br><span class="line"><span class="type">void</span> é‡å®šä¹‰ä¸º VOIDã€‚ </span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> *é‡å®šä¹‰ä¸º PULONGã€‚ </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> * é‡å®šä¹‰ä¸º PUCHARã€‚ </span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> *é‡å®šä¹‰ PUINTã€‚ </span><br><span class="line"><span class="type">void</span> *é‡å®šä¹‰ä¸º PVOIDã€‚</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ntifs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ntstrsafe.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">VOID <span class="title function_">UnDriver</span><span class="params">(PDRIVER_OBJECT driver)</span></span><br><span class="line">&#123;</span><br><span class="line">DbgPrint(<span class="string">&quot;é©±åŠ¨å¸è½½æˆåŠŸ \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">NTSTATUS <span class="title function_">DriverEntry</span><span class="params">(IN PDRIVER_OBJECT Driver, PUNICODE_STRING RegistryPath)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// å®šä¹‰å†…æ ¸å­—ç¬¦ä¸²</span></span><br><span class="line">ANSI_STRING ansi;</span><br><span class="line">UNICODE_STRING unicode;</span><br><span class="line">UNICODE_STRING str;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æ™®é€šå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="type">char</span> * char_string = <span class="string">&quot;hello lyshark&quot;</span>;</span><br><span class="line"><span class="type">wchar_t</span> *wchar_string = (WCHAR*)<span class="string">&quot;hello lyshark&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å­—ç¬¦ä¸²çš„å¤šç§æ–¹å¼</span></span><br><span class="line">RtlInitAnsiString(&amp;ansi, char_string);</span><br><span class="line">RtlInitUnicodeString(&amp;unicode, wchar_string);</span><br><span class="line">RtlInitUnicodeString(&amp;str, <span class="string">L&quot;hello lyshark&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ”¹å˜åŸå§‹å­—ç¬¦ä¸²ï¼ˆä¹±ç ä½ç½®ï¼Œæ­¤å¤„ä»…ç”¨äºæ¼”ç¤ºèµ‹å€¼æ–¹å¼ï¼‰</span></span><br><span class="line">char_string[<span class="number">0</span>] = (CHAR)<span class="string">&quot;A&quot;</span>;         <span class="comment">// charç±»å‹æ¯ä¸ªå ç”¨1å­—èŠ‚</span></span><br><span class="line">char_string[<span class="number">1</span>] = (CHAR)<span class="string">&quot;B&quot;</span>;</span><br><span class="line"></span><br><span class="line">wchar_string[<span class="number">0</span>] = (WCHAR)<span class="string">&quot;A&quot;</span>;        <span class="comment">// wcharç±»å‹æ¯ä¸ªå ç”¨2å­—èŠ‚</span></span><br><span class="line">wchar_string[<span class="number">2</span>] = (WCHAR)<span class="string">&quot;B&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºå­—ç¬¦ä¸² %Z</span></span><br><span class="line">DbgPrint(<span class="string">&quot;è¾“å‡ºANSI: %Z \n&quot;</span>, &amp;ansi);</span><br><span class="line">DbgPrint(<span class="string">&quot;è¾“å‡ºWCHAR: %Z \n&quot;</span>, &amp;unicode);</span><br><span class="line">DbgPrint(<span class="string">&quot;è¾“å‡ºå­—ç¬¦ä¸²: %wZ \n&quot;</span>, &amp;str);</span><br><span class="line"></span><br><span class="line">DbgPrint(<span class="string">&quot;é©±åŠ¨åŠ è½½æˆåŠŸ \n&quot;</span>);</span><br><span class="line">Driver-&gt;DriverUnload = UnDriver;</span><br><span class="line"><span class="keyword">return</span> STATUS_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨vs2019 ä¸­ æŸ¥æ‰¾ <strong>RtlInitAnsiString</strong>ï¼Œ<strong>RtlInitUnicodeString</strong>ï¼Œ<strong>RtlInitUnicodeString</strong>çš„å®šä¹‰</p><p><img src="/../image/624.png" class="lazyload" data-srcset="/../image/624.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="624"></p><p><img src="/../image/625.png" class="lazyload" data-srcset="/../image/625.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="625"></p><p>æˆ‘ä»¬å‘ç°éƒ½æ˜¯è¿™æ ·çš„å½¢å¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RtlInitAnsiString(&amp;ansi, char_string);</span><br><span class="line">RtlInitUnicodeString(&amp;unicode, wchar_string);</span><br><span class="line">RtlInitUnicodeString(&amp;str, <span class="string">L&quot;hello lyshark&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h2><p>åœ¨<code>Windows</code>å†…æ ¸ä¸­ï¼Œä¸ºäº†å®ç°é«˜æ•ˆçš„æ•°æ®ç»“æ„æ“ä½œï¼Œé€šå¸¸ä¼šä½¿ç”¨é“¾è¡¨å’Œç»“æ„ä½“ç›¸ç»“åˆçš„æ–¹å¼è¿›è¡Œæ•°æ®å­˜å‚¨å’Œæ“ä½œã€‚å†…æ ¸æä¾›äº†ä¸€ä¸ªä¸“é—¨ç”¨äºé“¾è¡¨æ“ä½œçš„æ•°æ®ç»“æ„<code>LIST_ENTRY</code>ï¼Œå¯ä»¥ç”¨æ¥æè¿°ä¸€ä¸ªé“¾è¡¨ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><p>ä½¿ç”¨é“¾è¡¨æ¥å­˜å‚¨ç»“æ„ä½“æ—¶ï¼Œéœ€è¦åœ¨ç»“æ„ä½“ä¸­åµŒå…¥ä¸€ä¸ª<code>LIST_ENTRY</code>ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œç”¨æ¥è¿æ¥ç›¸é‚»çš„èŠ‚ç‚¹ã€‚é€šè¿‡ä¸€äº›åˆ—é“¾è¡¨æ“ä½œå‡½æ•°ï¼Œå¦‚<code>InitializeListHeadã€InsertHeadListã€InsertTailListã€RemoveEntryList</code>ç­‰ï¼Œå¯ä»¥å¯¹é“¾è¡¨ä¸­çš„ç»“æ„ä½“è¿›è¡Œæ’å…¥ã€åˆ é™¤ã€éå†ç­‰æ“ä½œã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ntifs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ntstrsafe.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span>  <span class="keyword">struct</span>  <span class="title class_">_XXX</span></span><br><span class="line">&#123;</span><br><span class="line">LIST_ENTRY List;</span><br><span class="line">DWORD x;</span><br><span class="line">&#125;XXX,*PXXX;</span><br><span class="line"><span class="function">VOID <span class="title">DriverUnload</span><span class="params">(PDRIVER_OBJECT driver)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">DbgPrint</span>(<span class="string">&quot;é©±åŠ¨å¸è½½æˆåŠŸ \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">NTSTATUS <span class="title">DriverEntry</span><span class="params">(IN PDRIVER_OBJECT Driver, PUNICODE_STRING RegistryPath)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">XXX headList;</span><br><span class="line">XXX x1;</span><br><span class="line">XXX x2;</span><br><span class="line">headList.x = <span class="number">5</span>;</span><br><span class="line">x1.x = <span class="number">0x10</span>;</span><br><span class="line">x2.x = <span class="number">0x20</span>;</span><br><span class="line"><span class="built_in">InitializeListHead</span>(&amp;headList.List);<span class="comment">//ç›´æ¥è°ƒç”¨APIåˆå§‹åŒ–é“¾è¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">InitializeListHead</span>(&amp;x1.List);</span><br><span class="line"><span class="built_in">InitializeListHead</span>(&amp;x2.List);</span><br><span class="line"><span class="comment">//InsertHeadList(&amp;headList.List, &amp;x1.List);//æ’å…¥å¤´è¡¨</span></span><br><span class="line"><span class="built_in">InsertTailList</span>(&amp;headList.List, &amp;x1.List);<span class="comment">//æ’å…¥å°¾è¡¨</span></span><br><span class="line"><span class="built_in">InsertTailList</span>(&amp;headList.List, &amp;x2.List);<span class="comment">//æ’å…¥å°¾è¡¨</span></span><br><span class="line"><span class="comment">/*RemoveEntryList(&amp;x1.List);</span></span><br><span class="line"><span class="comment">RemoveHeadList(&amp;x1.List);*/</span></span><br><span class="line">PLIST_ENTRY pTempNext = &amp;headList.List;</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">&#123;</span><br><span class="line">PXXX temp = (PXXX)pTempNext;</span><br><span class="line"><span class="keyword">if</span> (temp-&gt;x == <span class="number">0x20</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">DbgPrintEx</span>(<span class="number">77</span>, <span class="number">0</span>, <span class="string">&quot;find value =%x\r\n&quot;</span>, temp-&gt;x);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">pTempNext = pTempNext-&gt;Flink;</span><br><span class="line">&#125; <span class="keyword">while</span> (pTempNext != &amp;headList.List);</span><br><span class="line">Driver-&gt;DriverUnload = DriverUnload;</span><br><span class="line"><span class="keyword">return</span> STATUS_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../image/644.png" class="lazyload" data-srcset="/../image/644.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="644"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å­—ç¬¦ä¸²æ“ä½œ&quot;&gt;&lt;a href=&quot;#å­—ç¬¦ä¸²æ“ä½œ&quot; class=&quot;headerlink&quot; title=&quot;å­—ç¬¦ä¸²æ“ä½œ&quot;&gt;&lt;/a&gt;å­—ç¬¦ä¸²æ“ä½œ&lt;/h2&gt;&lt;p&gt;åŸºæœ¬æ•°æ®ç±»å‹&lt;/p&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td clas</summary>
      
    
    
    
    <category term="å†…æ ¸é©±åŠ¨" scheme="http://example.com/categories/%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8/"/>
    
    
    <category term="Windowså†…æ ¸é©±åŠ¨å¼€å‘" scheme="http://example.com/tags/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>åŒå‘é“¾è¡¨åŠåŒå‘å¾ªç¯é“¾è¡¨(Cè¯­è¨€)</title>
    <link href="http://example.com/2024/04/11/[%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84]%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8%E5%8F%8A%E5%8F%8C%E5%90%91%E5%BE%AA%E7%8E%AF%E9%93%BE%E8%A1%A8(C%E8%AF%AD%E8%A8%80)/"/>
    <id>http://example.com/2024/04/11/[%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84]%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8%E5%8F%8A%E5%8F%8C%E5%90%91%E5%BE%AA%E7%8E%AF%E9%93%BE%E8%A1%A8(C%E8%AF%AD%E8%A8%80)/</id>
    <published>2024-04-10T16:00:00.000Z</published>
    <updated>2024-04-11T16:26:57.507Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŒå‘é“¾è¡¨"><a href="#åŒå‘é“¾è¡¨" class="headerlink" title="åŒå‘é“¾è¡¨"></a>åŒå‘é“¾è¡¨</h1><h2 id="åŒå‘é“¾è¡¨æ¦‚å¿µ"><a href="#åŒå‘é“¾è¡¨æ¦‚å¿µ" class="headerlink" title="åŒå‘é“¾è¡¨æ¦‚å¿µ"></a>åŒå‘é“¾è¡¨æ¦‚å¿µ</h2><p>åŒå‘é“¾è¡¨ä¹Ÿå«åŒé“¾è¡¨ï¼Œå…¶æ¯ä¸ªæ•°æ®ç»“ç‚¹ä¸­éƒ½æœ‰ä¸¤ä¸ªæŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘ç›´æ¥<strong>åç»§</strong>å’Œç›´æ¥<strong>å‰é©±</strong>ã€‚åœ¨å•å‘é“¾è¡¨ä¸­è‹¥è¦æ‰¾åˆ°æŸä¸ªèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ï¼Œéœ€è¦å…ˆéå†åˆ°è¿™ä¸ªèŠ‚ç‚¹ï¼Œç„¶åå†éå†ä¸€æ¬¡æ‰¾åˆ°å…¶å‰é©±èŠ‚ç‚¹ï¼Œè¿™æ— ç–‘æ˜¯ååˆ†ä½æ•ˆçš„ã€‚è€ŒåŒå‘é“¾è¡¨å¯ä»¥åšåˆ°æ­£å‘åå‘éå†ï¼Œç”±æ­¤ç›¸æ¯”å•å‘é“¾è¡¨å¯ä»¥æ›´é«˜æ•ˆåœ°æ‰¾åˆ°æŸä¸ªèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ã€‚</p><h1 id="åŒå‘é“¾è¡¨çš„åˆ›å»º"><a href="#åŒå‘é“¾è¡¨çš„åˆ›å»º" class="headerlink" title="åŒå‘é“¾è¡¨çš„åˆ›å»º"></a>åŒå‘é“¾è¡¨çš„åˆ›å»º</h1><h2 id="åŒå‘é“¾è¡¨çš„èŠ‚ç‚¹æ„æˆ"><a href="#åŒå‘é“¾è¡¨çš„èŠ‚ç‚¹æ„æˆ" class="headerlink" title="åŒå‘é“¾è¡¨çš„èŠ‚ç‚¹æ„æˆ"></a>åŒå‘é“¾è¡¨çš„èŠ‚ç‚¹æ„æˆ</h2><h4 id="åŒå‘é“¾è¡¨çš„å•ä¸ªèŠ‚ç‚¹å«æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼Œä¸€ä¸ªå€¼åŸŸã€‚"><a href="#åŒå‘é“¾è¡¨çš„å•ä¸ªèŠ‚ç‚¹å«æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼Œä¸€ä¸ªå€¼åŸŸã€‚" class="headerlink" title="åŒå‘é“¾è¡¨çš„å•ä¸ªèŠ‚ç‚¹å«æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼Œä¸€ä¸ªå€¼åŸŸã€‚"></a>åŒå‘é“¾è¡¨çš„å•ä¸ªèŠ‚ç‚¹å«æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼Œä¸€ä¸ªå€¼åŸŸã€‚</h4><p><img src="/../image/638.png" class="lazyload" data-srcset="/../image/638.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="638"></p><p>ç»“æ„ä½“</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Elemtype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Elemtype data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">prior</span>;</span> <span class="comment">//å‰é©±æŒ‡é’ˆ</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">next</span>;</span>  <span class="comment">//åé©±æŒ‡é’ˆ</span></span><br><span class="line">&#125;Duplist;</span><br></pre></td></tr></table></figure><h2 id="åŒå‘é“¾è¡¨çš„åˆå§‹åŒ–åˆ›å»º"><a href="#åŒå‘é“¾è¡¨çš„åˆå§‹åŒ–åˆ›å»º" class="headerlink" title="åŒå‘é“¾è¡¨çš„åˆå§‹åŒ–åˆ›å»º"></a>åŒå‘é“¾è¡¨çš„åˆå§‹åŒ–åˆ›å»º</h2><p>åŒå‘é“¾è¡¨åŸºæœ¬ä¸Šå°±æ˜¯åœ¨å•å‘é“¾è¡¨çš„åŸºç¡€ä¸Šå¤šäº†ä¸€ä¸ªå‰é©±æŒ‡é’ˆï¼Œç”¨ç±»ä¼¼çš„æ–¹å¼å»ºç«‹æ¯ä¸ªèŠ‚ç‚¹ä¸å‰é©±ä¹‹é—´å…³ç³»å°±å¯ä»¥äº†ğŸ¤ªã€‚<br>åˆ›å»ºåˆå§‹åŒå‘é“¾è¡¨ä¸€èˆ¬éƒ½æ˜¯åœ¨é“¾è¡¨å°¾éƒ¨æ’å…¥æ–°èŠ‚ç‚¹ï¼š<br>ï¼ˆ1ï¼‰å°† <strong>end</strong> çš„ <em><strong>next</strong></em> æŒ‡å‘æ–°èŠ‚ç‚¹ <strong>node</strong>;<br>ï¼ˆ2ï¼‰å°† <strong>node</strong> çš„ <em><strong>prior</strong></em> æŒ‡å‘ <strong>end</strong>ã€‚</p><h4 id="åŒå‘é“¾è¡¨å›¾"><a href="#åŒå‘é“¾è¡¨å›¾" class="headerlink" title="åŒå‘é“¾è¡¨å›¾"></a>åŒå‘é“¾è¡¨å›¾</h4><p><img src="/../image/639.png" class="lazyload" data-srcset="/../image/639.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="639"></p><h4 id="åŒå‘é“¾è¡¨åˆ›å»ºä»£ç "><a href="#åŒå‘é“¾è¡¨åˆ›å»ºä»£ç " class="headerlink" title="åŒå‘é“¾è¡¨åˆ›å»ºä»£ç "></a>åŒå‘é“¾è¡¨åˆ›å»ºä»£ç </h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Duplist *<span class="title function_">Create_DuplistxLinklist</span><span class="params">(Duplist *head,<span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    head = (Duplist*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Duplist));</span><br><span class="line">    head-&gt;prior=<span class="literal">NULL</span>;</span><br><span class="line">    head-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    Duplist *end=head;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åˆ›å»ºåŒå‘é“¾è¡¨è¾“å…¥ %d ä¸ªæ•°æ®: &quot;</span>, n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;head-&gt;data);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//åˆå§‹åŒ–ç»“ç‚¹</span></span><br><span class="line">        Duplist *node = (Duplist*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Duplist));</span><br><span class="line">        node-&gt;prior=<span class="literal">NULL</span>:</span><br><span class="line">        node-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,node-&gt;data);</span><br><span class="line">        </span><br><span class="line">        end-&gt;next=node;   <span class="comment">//endçš„nextæŒ‡å‘æ–°èŠ‚ç‚¹node</span></span><br><span class="line">        node-&gt;prior=end; <span class="comment">//æ–°èŠ‚ç‚¹nodeçš„å‰é©±prioræŒ‡å‘ä¹‹å‰çš„end</span></span><br><span class="line">        end=node;           <span class="comment">//endæŒ‡å‘æœ€åçš„nodeèŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åŒå‘é“¾è¡¨çš„æ’å…¥æ“ä½œ"><a href="#åŒå‘é“¾è¡¨çš„æ’å…¥æ“ä½œ" class="headerlink" title="åŒå‘é“¾è¡¨çš„æ’å…¥æ“ä½œ"></a>åŒå‘é“¾è¡¨çš„æ’å…¥æ“ä½œ</h1><p>åŒå‘é“¾è¡¨çš„æ’å…¥åˆ†ä¸ºä¸‰ç§ï¼Œåˆ†åˆ«ä¸ºè¡¨å¤´æ’å…¥ï¼Œè¡¨ä¸­æ’å…¥å’Œè¡¨å°¾æ’å…¥ã€‚</p><h2 id="è¡¨å¤´æ’å…¥"><a href="#è¡¨å¤´æ’å…¥" class="headerlink" title="è¡¨å¤´æ’å…¥"></a>è¡¨å¤´æ’å…¥</h2><h4 id="è¡¨å¤´æ’å…¥æ“ä½œ-è¿™é‡Œé¡ºåºæ— æ‰€è°“-ï¼š"><a href="#è¡¨å¤´æ’å…¥æ“ä½œ-è¿™é‡Œé¡ºåºæ— æ‰€è°“-ï¼š" class="headerlink" title="è¡¨å¤´æ’å…¥æ“ä½œ(è¿™é‡Œé¡ºåºæ— æ‰€è°“)ï¼š"></a>è¡¨å¤´æ’å…¥æ“ä½œ(è¿™é‡Œé¡ºåºæ— æ‰€è°“)ï¼š</h4><p>ï¼ˆ1ï¼‰å°† <strong>head</strong> çš„ <em><strong>prior</strong></em> æŒ‡å‘æ–°èŠ‚ç‚¹ <strong>node</strong>;<br>ï¼ˆ2ï¼‰å°† <strong>node</strong> çš„ <em><strong>next</strong></em> æŒ‡å‘ <strong>head</strong>ï¼›<br>ï¼ˆ3ï¼‰å°† <strong>head</strong> æŒ‡å‘æ–°èŠ‚ç‚¹ <strong>node</strong>ã€‚</p><p>ç¬”è€…è‡ªå·±çš„ç†è§£</p><p>æ—¢ç„¶æ˜¯è¡¨å¤´äº†ï¼Œé‚£è‚¯å®šç”¨çš„æ˜¯å‰é©±æŒ‡é’ˆ</p><p>å‰é©±æŒ‡é’ˆæŒ‡å‘è¦æ’å…¥çš„èŠ‚ç‚¹ï¼Œç”±äºæ˜¯åŒå‘é“¾è¡¨è‚¯å®šæ’å…¥çš„èŠ‚ç‚¹çš„åé©±æŒ‡é’ˆè¦æŒ‡å‘head</p><h4 id="è¡¨å¤´æ’å…¥å›¾è§£"><a href="#è¡¨å¤´æ’å…¥å›¾è§£" class="headerlink" title="è¡¨å¤´æ’å…¥å›¾è§£"></a>è¡¨å¤´æ’å…¥å›¾è§£</h4><p><img src="/../image/640.jpg" class="lazyload" data-srcset="/../image/640.jpg" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="640"></p><h2 id="è¡¨ä¸­æ’å…¥"><a href="#è¡¨ä¸­æ’å…¥" class="headerlink" title="è¡¨ä¸­æ’å…¥"></a>è¡¨ä¸­æ’å…¥</h2><h4 id="è¡¨ä¸­æ’å…¥æ“ä½œ-è¿™é‡Œçš„é¡ºåºä¸èƒ½è½»æ˜“æ”¹å˜ï¼Œç”»å›¾æœ‰åŠ©äºç†è§£-ï¼š"><a href="#è¡¨ä¸­æ’å…¥æ“ä½œ-è¿™é‡Œçš„é¡ºåºä¸èƒ½è½»æ˜“æ”¹å˜ï¼Œç”»å›¾æœ‰åŠ©äºç†è§£-ï¼š" class="headerlink" title="è¡¨ä¸­æ’å…¥æ“ä½œ(è¿™é‡Œçš„é¡ºåºä¸èƒ½è½»æ˜“æ”¹å˜ï¼Œç”»å›¾æœ‰åŠ©äºç†è§£)ï¼š"></a>è¡¨ä¸­æ’å…¥æ“ä½œ(è¿™é‡Œçš„é¡ºåºä¸èƒ½è½»æ˜“æ”¹å˜ï¼Œç”»å›¾æœ‰åŠ©äºç†è§£)ï¼š</h4><p>æ‰¾åˆ°æ’å…¥ä½ç½®å¤„posä¹‹å‰çš„èŠ‚ç‚¹ <strong>t</strong>;<br>ï¼ˆ1ï¼‰å°† <strong>t</strong> çš„ <em><strong>next</strong></em> çš„ <em><strong>prior</strong></em> æŒ‡å‘æ–°èŠ‚ç‚¹ <strong>node</strong>;<br>ï¼ˆ2ï¼‰å°† <strong>node</strong> çš„ <em><strong>next</strong></em> æŒ‡å‘ <strong>t</strong> çš„ <em><strong>next</strong></em>;<br>ï¼ˆ3ï¼‰å°† <strong>t</strong> çš„ <em><strong>next</strong></em> æŒ‡å‘æ–°èŠ‚ç‚¹ <strong>node</strong>;<br>ï¼ˆ4ï¼‰å°† <strong>node</strong> çš„ <em><strong>prior</strong></em> æŒ‡å‘ <strong>t</strong>ã€‚</p><h4 id="è¡¨ä¸­æ’å…¥å›¾è§£"><a href="#è¡¨ä¸­æ’å…¥å›¾è§£" class="headerlink" title="è¡¨ä¸­æ’å…¥å›¾è§£"></a>è¡¨ä¸­æ’å…¥å›¾è§£</h4><p><img src="/../image/641.png" class="lazyload" data-srcset="/../image/641.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="641"></p><h2 id="è¡¨å°¾æ’å…¥"><a href="#è¡¨å°¾æ’å…¥" class="headerlink" title="è¡¨å°¾æ’å…¥"></a>è¡¨å°¾æ’å…¥</h2><h4 id="è¡¨å°¾æ’å…¥æ“ä½œï¼š"><a href="#è¡¨å°¾æ’å…¥æ“ä½œï¼š" class="headerlink" title="è¡¨å°¾æ’å…¥æ“ä½œï¼š"></a>è¡¨å°¾æ’å…¥æ“ä½œï¼š</h4><p>ï¼ˆ1ï¼‰å°† <strong>end</strong> çš„ <em><strong>next</strong></em> æŒ‡å‘æ–°èŠ‚ç‚¹ <strong>node</strong>;<br>ï¼ˆ2ï¼‰å°† <strong>node</strong> çš„ <em><strong>prior</strong></em> æŒ‡å‘ <strong>end</strong>;<br>ï¼ˆ3ï¼‰å°† <strong>end</strong> æŒ‡å‘æ–°èŠ‚ç‚¹ <strong>node</strong>ã€‚</p><p>è¡¨å°¾æ“ä½œï¼Œæ„æ€å°±æ˜¯è·Ÿè¡¨å¤´æ’å…¥ç›¸å</p><h4 id="è¡¨å°¾æ’å…¥å›¾è§£"><a href="#è¡¨å°¾æ’å…¥å›¾è§£" class="headerlink" title="è¡¨å°¾æ’å…¥å›¾è§£"></a>è¡¨å°¾æ’å…¥å›¾è§£</h4><p><img src="/../image/641.png" class="lazyload" data-srcset="/../image/641.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="641"></p><h2 id="åŒå‘é“¾è¡¨æ’å…¥æ“ä½œä»£ç "><a href="#åŒå‘é“¾è¡¨æ’å…¥æ“ä½œä»£ç " class="headerlink" title="åŒå‘é“¾è¡¨æ’å…¥æ“ä½œä»£ç "></a>åŒå‘é“¾è¡¨æ’å…¥æ“ä½œä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ’å…¥æ–°èŠ‚ç‚¹(åŒ…å«ä¸‰ç§æƒ…å†µ å¤´æ’ å°¾æ’ å’Œ æŒ‡å®šä½ç½®æ’å…¥)</span></span><br><span class="line">Duplist *<span class="title function_">Insert_DuplistxLinklist</span><span class="params">(Duplist *head,<span class="type">int</span> pos,<span class="type">int</span> data)</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">//åˆå§‹åŒ–æ’å…¥æ–°èŠ‚ç‚¹</span></span><br><span class="line">   Duplist *node =(Duplist*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Duplist));</span><br><span class="line">   node-&gt;prior=<span class="literal">NULL</span>;</span><br><span class="line">   node-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">   <span class="keyword">if</span>(pos==<span class="number">1</span>) <span class="comment">//æ’åœ¨é“¾è¡¨å¤´çš„æƒ…å†µ</span></span><br><span class="line">   &#123;</span><br><span class="line">       head-&gt;prior=node;<span class="comment">//æ–°èŠ‚ç‚¹nodeçš„nextæŒ‡å‘ä¹‹å‰çš„å¤´head</span></span><br><span class="line">       node-&gt;next=head;<span class="comment">//ä¹‹å‰çš„headçš„å‰é©±prioræŒ‡å‘äº†node</span></span><br><span class="line">       head=node;<span class="comment">//headé‡æ–°æŒ‡å‘äº†æ’åœ¨è¡¨å¤´çš„æ–°èŠ‚ç‚¹</span></span><br><span class="line">   &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Duplist *t = head; <span class="comment">//tä¸ºéå†æŒ‡é’ˆ</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;pos<span class="number">-1</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            t=t-&gt;next;</span><br><span class="line">            <span class="keyword">if</span>(t-&gt;next==<span class="literal">NULL</span>)<span class="comment">//æ’åœ¨é“¾è¡¨å°¾çš„æƒ…å†µ</span></span><br><span class="line">            &#123;</span><br><span class="line">                t-&gt;next=node;</span><br><span class="line">                node-&gt;prior=t;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="comment">//æ’åœ¨è¡¨ä¸­çš„æƒ…å†µ</span></span><br><span class="line">            &#123;</span><br><span class="line">                t-&gt;next-&gt;prior=node;<span class="comment">////tçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹(è¦ä»£æ›¿ä½ç½®çš„èŠ‚ç‚¹)çš„å‰é©±æŒ‡å‘æ–°node</span></span><br><span class="line">                node-&gt;next=t-&gt;next;<span class="comment">//æ–°nodeçš„nextæŒ‡å‘äº†ä¹‹å‰tçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">                t-&gt;next = node;               <span class="comment">//tçš„nexté‡æ–°æŒ‡å‘æ–°node</span></span><br><span class="line">    node-&gt;prior = t;              <span class="comment">//nodeå‰é©±prioræŒ‡å‘äº†t </span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åŒå‘é“¾è¡¨çš„åˆ é™¤æ“ä½œ"><a href="#åŒå‘é“¾è¡¨çš„åˆ é™¤æ“ä½œ" class="headerlink" title="åŒå‘é“¾è¡¨çš„åˆ é™¤æ“ä½œ"></a>åŒå‘é“¾è¡¨çš„åˆ é™¤æ“ä½œ</h1><p>åŒå‘é“¾è¡¨åˆ é™¤èŠ‚ç‚¹ä¹Ÿå¯ä»¥åˆ†æˆä¸‰ç§ï¼Œè¡¨å¤´åˆ é™¤ã€è¡¨ä¸­åˆ é™¤å’Œè¡¨å°¾åˆ é™¤ã€‚</p><h2 id="è¡¨å¤´åˆ é™¤"><a href="#è¡¨å¤´åˆ é™¤" class="headerlink" title="è¡¨å¤´åˆ é™¤"></a>è¡¨å¤´åˆ é™¤</h2><h3 id="è¡¨å¤´åˆ é™¤æ“ä½œ"><a href="#è¡¨å¤´åˆ é™¤æ“ä½œ" class="headerlink" title="è¡¨å¤´åˆ é™¤æ“ä½œ:"></a>è¡¨å¤´åˆ é™¤æ“ä½œ:</h3><p>ï¼ˆ1ï¼‰<strong>head</strong> åç§»;<br>ï¼ˆ2ï¼‰æ­¤æ—¶çš„ <strong>head</strong> çš„ <em><strong>prior</strong></em> ç½®NULLã€‚<br>æ“ä½œæ¯”è¾ƒç®€å•å°±çœç•¥å›¾è§£äº†</p><h2 id="è¡¨ä¸­åˆ é™¤"><a href="#è¡¨ä¸­åˆ é™¤" class="headerlink" title="è¡¨ä¸­åˆ é™¤"></a>è¡¨ä¸­åˆ é™¤</h2><h3 id="è¡¨ä¸­åˆ é™¤æ“ä½œ"><a href="#è¡¨ä¸­åˆ é™¤æ“ä½œ" class="headerlink" title="è¡¨ä¸­åˆ é™¤æ“ä½œ:"></a>è¡¨ä¸­åˆ é™¤æ“ä½œ:</h3><p>ï¼ˆ1ï¼‰<strong>t</strong> çš„ <em><strong>prior</strong></em> çš„ <em><strong>next</strong></em> æŒ‡å‘ <strong>t</strong> çš„ <em><strong>next</strong></em>ï¼›<br>ï¼ˆ2ï¼‰<strong>t</strong> çš„ <em><strong>next</strong></em> çš„ <em><strong>prior</strong></em> æŒ‡å‘ <strong>t</strong> çš„ <em><strong>prior</strong></em>ã€‚</p><h3 id="è¡¨ä¸­åˆ é™¤å›¾è§£"><a href="#è¡¨ä¸­åˆ é™¤å›¾è§£" class="headerlink" title="è¡¨ä¸­åˆ é™¤å›¾è§£"></a>è¡¨ä¸­åˆ é™¤å›¾è§£</h3><p><img src="/../image/642.png" class="lazyload" data-srcset="/../image/642.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="642"></p><h2 id="è¡¨å°¾åˆ é™¤"><a href="#è¡¨å°¾åˆ é™¤" class="headerlink" title="è¡¨å°¾åˆ é™¤"></a>è¡¨å°¾åˆ é™¤</h2><h3 id="è¡¨å°¾åˆ é™¤æ“ä½œ"><a href="#è¡¨å°¾åˆ é™¤æ“ä½œ" class="headerlink" title="è¡¨å°¾åˆ é™¤æ“ä½œ"></a>è¡¨å°¾åˆ é™¤æ“ä½œ</h3><p>å¦‚æœ <strong>t</strong> æŒ‡å‘è¡¨å°¾<br>ï¼ˆ1ï¼‰ç›´æ¥å°†æ­¤æ—¶ <strong>t</strong> çš„ <em><strong>prior</strong></em> çš„ <em><strong>next</strong></em> ç½® NULLã€‚<br>æ“ä½œæ¯”è¾ƒç®€å•å°±çœç•¥å›¾è§£äº†</p><h2 id="åŒå‘é“¾è¡¨åˆ é™¤æ“ä½œä»£ç "><a href="#åŒå‘é“¾è¡¨åˆ é™¤æ“ä½œä»£ç " class="headerlink" title="åŒå‘é“¾è¡¨åˆ é™¤æ“ä½œä»£ç "></a>åŒå‘é“¾è¡¨åˆ é™¤æ“ä½œä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ é™¤æŒ‡å®šä½ç½®èŠ‚ç‚¹</span></span><br><span class="line">Duplist* <span class="title function_">Delete_DuplexLinklist</span><span class="params">(Duplist *head, <span class="type">int</span> pos)</span> &#123;</span><br><span class="line">Duplist *t = head;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; pos; i++)</span><br><span class="line">t = t-&gt;next;                  <span class="comment">//æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (t-&gt;prior == <span class="literal">NULL</span>) &#123;       <span class="comment">//å¦‚æœæ˜¯å¤´èŠ‚ç‚¹</span></span><br><span class="line">head = t-&gt;next;           <span class="comment">//headå¾€åç§»</span></span><br><span class="line"><span class="built_in">free</span>(t);</span><br><span class="line">head-&gt;prior = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (t-&gt;next == <span class="literal">NULL</span>) &#123; <span class="comment">//å¦‚æœæ˜¯å°¾èŠ‚ç‚¹</span></span><br><span class="line">t-&gt;prior-&gt;next = <span class="literal">NULL</span>;    <span class="comment">//è¡¨å°¾çš„å‰ä¸€ä¸ªèŠ‚ç‚¹çš„nextç½®NULL</span></span><br><span class="line"><span class="built_in">free</span>(t);</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;                      <span class="comment">//åˆ é™¤è¡¨ä¸­èŠ‚ç‚¹çš„æƒ…å†µ</span></span><br><span class="line">t-&gt;prior-&gt;next = t-&gt;next; <span class="comment">//è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹çš„nextè·¨è¶Šç›´æ¥æŒ‡å‘ä¸‹ä¸‹ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">t-&gt;next-&gt;prior = t-&gt;prior;<span class="comment">//è¦åˆ é™¤èŠ‚ç‚¹çš„åä¸€ä¸ªèŠ‚ç‚¹çš„priorè·¨è¶ŠæŒ‡å‘ä¸Šä¸Šä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="built_in">free</span>(t);</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;èŠ‚ç‚¹ä¸å­˜åœ¨\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åŒå‘é“¾è¡¨æµ‹è¯•ä»£ç ï¼ˆé™„å¸¦å…¶ä»–æ“ä½œï¼‰"><a href="#åŒå‘é“¾è¡¨æµ‹è¯•ä»£ç ï¼ˆé™„å¸¦å…¶ä»–æ“ä½œï¼‰" class="headerlink" title="åŒå‘é“¾è¡¨æµ‹è¯•ä»£ç ï¼ˆé™„å¸¦å…¶ä»–æ“ä½œï¼‰"></a>åŒå‘é“¾è¡¨æµ‹è¯•ä»£ç ï¼ˆé™„å¸¦å…¶ä»–æ“ä½œï¼‰</h1><h2 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Elemtype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line"></span><br><span class="line">Elemtype data;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">prior</span>;</span>      <span class="comment">//å‰é©±æŒ‡é’ˆ</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">next</span>;</span>       <span class="comment">//åé©±æŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line">&#125; Duplist;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºåˆå§‹åŒ–åŒå‘é“¾è¡¨(å¤´èŠ‚ç‚¹æœ‰æ•°æ®ï¼Œä¾¿äºè¡¨å¤´æ’å…¥ï¼Œè¦ä¸å•å‘é“¾è¡¨åŒºåˆ†)</span></span><br><span class="line">Duplist *<span class="title function_">Create_DuplexLinklist</span><span class="params">(Duplist *head, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">head = (Duplist*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Duplist));</span><br><span class="line">head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">head-&gt;prior = <span class="literal">NULL</span>;            </span><br><span class="line">Duplist *end = head;                       <span class="comment">//ç”¨äºåœ¨å°¾éƒ¨æ’å…¥æ–°èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;åˆ›å»ºåŒå‘é“¾è¡¨è¾“å…¥ %d ä¸ªæ•°æ®: &quot;</span>, n);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;head-&gt;data);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">Duplist *node = (Duplist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Duplist));</span><br><span class="line">node-&gt;prior = <span class="literal">NULL</span>;</span><br><span class="line">node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;node-&gt;data);</span><br><span class="line"></span><br><span class="line">end-&gt;next = node;                      <span class="comment">//ä¹‹å‰çš„endçš„nextæŒ‡å‘æ–°èŠ‚ç‚¹node</span></span><br><span class="line">node-&gt;prior = end;                     <span class="comment">//æ–°èŠ‚ç‚¹nodeçš„å‰é©±prioræŒ‡å‘ä¹‹å‰çš„end</span></span><br><span class="line">end = node;                            <span class="comment">//endæ°¸è¿œæŒ‡å‘æœ€åçš„nodeèŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ’å…¥æ–°èŠ‚ç‚¹(åŒ…å«ä¸‰ç§æƒ…å†µ å¤´æ’ å°¾æ’ å’Œ æŒ‡å®šä½ç½®æ’å…¥)</span></span><br><span class="line">Duplist *<span class="title function_">Insert_DuplexLinklist</span><span class="params">(Duplist *head, <span class="type">int</span> pos, <span class="type">int</span> data)</span> &#123;</span><br><span class="line">Duplist *node = (Duplist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Duplist));</span><br><span class="line">node-&gt;data = data;</span><br><span class="line">node-&gt;prior = <span class="literal">NULL</span>;</span><br><span class="line">node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"><span class="comment">//posè¡¨ç¤ºè¦æ’å…¥çš„ä½ç½®ï¼ˆheadä¸º1ï¼‰</span></span><br><span class="line"><span class="keyword">if</span> (pos == <span class="number">1</span>) &#123;                       <span class="comment">//æ’åœ¨é“¾è¡¨å¤´çš„æƒ…å†µ</span></span><br><span class="line">node-&gt;next = head;                <span class="comment">//æ–°èŠ‚ç‚¹nodeçš„nextæŒ‡å‘ä¹‹å‰çš„å¤´head</span></span><br><span class="line">head-&gt;prior = node;               <span class="comment">//ä¹‹å‰çš„headçš„å‰é©±prioræŒ‡å‘äº†node</span></span><br><span class="line">head = node;                      <span class="comment">//headé‡æ–°æŒ‡å‘äº†æ’åœ¨è¡¨å¤´çš„æ–°èŠ‚ç‚¹</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Duplist *t = head;                <span class="comment">//tä¸ºéå†æŒ‡é’ˆ</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; pos - <span class="number">1</span>; i++) <span class="comment">//tæŒ‡å‘è¦æ’å…¥ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">t = t-&gt;next;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (t-&gt;next == <span class="literal">NULL</span>) &#123;            <span class="comment">//æ’åœ¨é“¾è¡¨å°¾çš„æƒ…å†µ</span></span><br><span class="line">t-&gt;next = node;               <span class="comment">//tæŒ‡å‘è¡¨å°¾ï¼Œtçš„nextæŒ‡å‘æ–°èŠ‚ç‚¹node</span></span><br><span class="line">node-&gt;prior = t;              <span class="comment">//æ–°èŠ‚ç‚¹nodeçš„å‰é©±prioræŒ‡å‘t</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//æ’åœ¨è¡¨ä¸­çš„æƒ…å†µ</span></span><br><span class="line">t-&gt;next-&gt;prior = node;        <span class="comment">//tçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹(è¦ä»£æ›¿ä½ç½®çš„èŠ‚ç‚¹)çš„å‰é©±æŒ‡å‘æ–°node</span></span><br><span class="line">node-&gt;next = t-&gt;next;         <span class="comment">//æ–°nodeçš„nextæŒ‡å‘äº†ä¹‹å‰tçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">t-&gt;next = node;               <span class="comment">//tçš„nexté‡æ–°æŒ‡å‘æ–°node</span></span><br><span class="line">node-&gt;prior = t;              <span class="comment">//nodeå‰é©±prioræŒ‡å‘äº†t</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ é™¤æŒ‡å®šä½ç½®èŠ‚ç‚¹</span></span><br><span class="line">Duplist* <span class="title function_">Delete_DuplexLinklist</span><span class="params">(Duplist *head, <span class="type">int</span> pos)</span> &#123;</span><br><span class="line">Duplist *t = head;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; pos; i++)</span><br><span class="line">t = t-&gt;next;                  <span class="comment">//æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (t-&gt;prior == <span class="literal">NULL</span>) &#123;       <span class="comment">//å¦‚æœæ˜¯å¤´èŠ‚ç‚¹</span></span><br><span class="line">head = t-&gt;next;           <span class="comment">//headå¾€åç§»</span></span><br><span class="line"><span class="built_in">free</span>(t);</span><br><span class="line">head-&gt;prior = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (t-&gt;next == <span class="literal">NULL</span>) &#123; <span class="comment">//å¦‚æœæ˜¯å°¾èŠ‚ç‚¹</span></span><br><span class="line">t-&gt;prior-&gt;next = <span class="literal">NULL</span>;    <span class="comment">//è¡¨å°¾çš„å‰ä¸€ä¸ªèŠ‚ç‚¹çš„nextç½®NULL</span></span><br><span class="line"><span class="built_in">free</span>(t);</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;                      <span class="comment">//åˆ é™¤è¡¨ä¸­èŠ‚ç‚¹çš„æƒ…å†µ</span></span><br><span class="line">t-&gt;prior-&gt;next = t-&gt;next; <span class="comment">//è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹çš„nextè·¨è¶Šç›´æ¥æŒ‡å‘ä¸‹ä¸‹ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">t-&gt;next-&gt;prior = t-&gt;prior;<span class="comment">//è¦åˆ é™¤èŠ‚ç‚¹çš„åä¸€ä¸ªèŠ‚ç‚¹çš„priorè·¨è¶ŠæŒ‡å‘ä¸Šä¸Šä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="built_in">free</span>(t);</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;èŠ‚ç‚¹ä¸å­˜åœ¨\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯»å–å•ä¸ªæ•°æ®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Read_DuplexLinklist</span><span class="params">(Duplist *head, <span class="type">int</span> pos)</span> &#123;</span><br><span class="line">Duplist *t = head;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; pos; i++)</span><br><span class="line">t = t-&gt;next;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (t != <span class="literal">NULL</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç¬¬ %d ä¸ªä½ç½®çš„æ•°æ®ä¸º %d&quot;</span>, pos, t-&gt;data);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;èŠ‚ç‚¹ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ”¹å˜æŒ‡å®šä½ç½®æ•°æ®</span></span><br><span class="line">Duplist* <span class="title function_">Change_DuplexLinklist</span><span class="params">(Duplist *head, <span class="type">int</span> pos, <span class="type">int</span> data)</span>&#123;</span><br><span class="line">Duplist *t = head;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; pos; i++)</span><br><span class="line">t = t-&gt;next;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(t != <span class="literal">NULL</span>)</span><br><span class="line">t-&gt;data = data;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;èŠ‚ç‚¹ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾æ•°æ®è¿”å›ä¸‹æ ‡</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">Find_DuplexLinklist</span><span class="params">(Duplist *head, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">Duplist *t = head;</span><br><span class="line"><span class="type">int</span> pos = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (t-&gt;data == n) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯¥æ•°æ®çš„ä½ç½®ä¸º %d&quot;</span>, pos);</span><br><span class="line">&#125;</span><br><span class="line">t = t-&gt;next;</span><br><span class="line">pos++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éå†æ‰“å°åŒå‘é“¾è¡¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Show_DuplexLinklist</span><span class="params">(Duplist *head)</span> &#123;</span><br><span class="line">Duplist *t = head;</span><br><span class="line"><span class="keyword">while</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t-&gt;data);</span><br><span class="line">t = t-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åå‘æ‰“å°åŒå‘é“¾è¡¨  </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Reverse_DuplexLinklist</span><span class="params">(Duplist *head)</span>&#123;</span><br><span class="line">Duplist *t = head;</span><br><span class="line"><span class="keyword">while</span> (t-&gt;next != <span class="literal">NULL</span>)           <span class="comment">//æŒ‡å‘æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">t = t-&gt;next;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (t != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,t-&gt;data);</span><br><span class="line">t = t-&gt;prior;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">Duplist *mylist = <span class="literal">NULL</span>; </span><br><span class="line"></span><br><span class="line">mylist = Create_DuplexLinklist(mylist, <span class="number">10</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;åˆå§‹çŠ¶æ€åŒå‘é“¾è¡¨:&quot;</span>);</span><br><span class="line">Show_DuplexLinklist(mylist);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    mylist = Insert_DuplexLinklist(mylist, <span class="number">11</span>, <span class="number">30</span>);</span><br><span class="line">mylist = Insert_DuplexLinklist(mylist, <span class="number">1</span>, <span class="number">30</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;åœ¨å¤´å’Œå°¾ çš„ä½ç½®æ’å…¥æ•°æ®30å:&quot;</span>);</span><br><span class="line">Show_DuplexLinklist(mylist);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">mylist = Change_DuplexLinklist(mylist,<span class="number">5</span>,<span class="number">22</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;æ”¹å˜ç¬¬ 5 çš„ä½ç½®æ•°æ®ä¸º 22 å:&quot;</span>);</span><br><span class="line">Show_DuplexLinklist(mylist);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">mylist = Delete_DuplexLinklist(mylist, <span class="number">8</span>);</span><br><span class="line">mylist = Delete_DuplexLinklist(mylist, <span class="number">1</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;åˆ é™¤ç¬¬ 1 å’Œ 8 çš„ä½ç½®æ•°æ®å:&quot;</span>);</span><br><span class="line">Show_DuplexLinklist(mylist);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;åŒå‘é“¾è¡¨åå‘è¾“å‡º:&quot;</span>);</span><br><span class="line">Reverse_DuplexLinklist(mylist);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../image/643.png" class="lazyload" data-srcset="/../image/643.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="643"></p><h1 id="åŒå‘å¾ªç¯é“¾è¡¨ä»¥åŠåˆ¤æ–­å¯¹ç§°"><a href="#åŒå‘å¾ªç¯é“¾è¡¨ä»¥åŠåˆ¤æ–­å¯¹ç§°" class="headerlink" title="åŒå‘å¾ªç¯é“¾è¡¨ä»¥åŠåˆ¤æ–­å¯¹ç§°"></a>åŒå‘å¾ªç¯é“¾è¡¨ä»¥åŠåˆ¤æ–­å¯¹ç§°</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Elemtype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"></span><br><span class="line">Elemtype data;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">prior</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">next</span>;</span></span><br><span class="line"></span><br><span class="line">&#125; DupLooplist;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨ (å¤´èŠ‚ç‚¹å¸¦æ•°æ®)</span></span><br><span class="line">DupLooplist* <span class="title function_">Create_DupLooplist</span><span class="params">(DupLooplist *head, <span class="type">int</span> n)</span>&#123;</span><br><span class="line">head = (DupLooplist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(DupLooplist));</span><br><span class="line">head-&gt;next = head;</span><br><span class="line">head-&gt;prior = head;</span><br><span class="line">DupLooplist *end = head;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;åˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨è¾“å…¥ %d ä¸ªæ•°æ®: \n&quot;</span>, n);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;head-&gt;data);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">DupLooplist *node = (DupLooplist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(DupLooplist));</span><br><span class="line">node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">node-&gt;prior = <span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;node-&gt;data);</span><br><span class="line"></span><br><span class="line">end-&gt;next = node;</span><br><span class="line">node-&gt;prior = end;</span><br><span class="line">end = node;</span><br><span class="line">&#125;</span><br><span class="line">end-&gt;next = head;</span><br><span class="line">head-&gt;prior = end;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Show_DupLooplist</span><span class="params">(DupLooplist *head)</span>&#123;</span><br><span class="line">DupLooplist *t = head;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t-&gt;data);</span><br><span class="line">t = t-&gt;next;</span><br><span class="line"><span class="keyword">if</span>(t == head)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Reverse_DupLooplist</span><span class="params">(DupLooplist *head)</span>&#123;</span><br><span class="line">DupLooplist *t = head-&gt;prior;</span><br><span class="line">DupLooplist *end = head-&gt;prior;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t-&gt;data);</span><br><span class="line">t = t-&gt;prior;</span><br><span class="line"><span class="keyword">if</span>(t == end)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ’å…¥æ•°æ®</span></span><br><span class="line">DupLooplist* <span class="title function_">Insert_DupLooplist</span><span class="params">(DupLooplist *head, <span class="type">int</span> pos, Elemtype data)</span>&#123;</span><br><span class="line">DupLooplist *node = (DupLooplist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(DupLooplist));</span><br><span class="line">DupLooplist *end = head-&gt;prior;</span><br><span class="line">node-&gt;data = data;</span><br><span class="line">node-&gt;prior = <span class="literal">NULL</span>;</span><br><span class="line">node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(pos == <span class="number">1</span>)&#123;                        <span class="comment">//æ’åœ¨è¡¨å¤´ æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å¤´</span></span><br><span class="line"></span><br><span class="line">node-&gt;next = head;</span><br><span class="line">head-&gt;prior = node;</span><br><span class="line">node-&gt;prior = end;</span><br><span class="line">end-&gt;next = node;</span><br><span class="line">head = node;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">DupLooplist *t = head;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; pos - <span class="number">1</span>; i++) <span class="comment">//æ‰¾åˆ°è¦æ’å…¥ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">t = t-&gt;next;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(t-&gt;next == head)&#123;             <span class="comment">//æ’åœ¨è¡¨å°¾ æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å°¾</span></span><br><span class="line">        </span><br><span class="line">        end-&gt;next = node;</span><br><span class="line">        node-&gt;prior = end;</span><br><span class="line">        node-&gt;next = head;</span><br><span class="line">        head-&gt;prior = node;        </span><br><span class="line">        end = node;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;                           <span class="comment">//æ’åœ¨è¡¨ä¸­</span></span><br><span class="line">        </span><br><span class="line">        t-&gt;next-&gt;prior = node;</span><br><span class="line">        node-&gt;next = t-&gt;next;</span><br><span class="line">        t-&gt;next = node;</span><br><span class="line">        node-&gt;prior = t;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ é™¤åŒå‘å¾ªç¯é“¾è¡¨æŒ‡å®šä½ç½®å…ƒç´ </span></span><br><span class="line">DupLooplist* <span class="title function_">Delete_DupLooplist</span><span class="params">(DupLooplist *head, <span class="type">int</span> pos)</span>&#123;</span><br><span class="line">DupLooplist *t = head;</span><br><span class="line">DupLooplist *p = t-&gt;prior;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; pos; i++)   <span class="comment">//æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹ ä»¥åŠå…¶å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">&#123;   </span><br><span class="line">t = t-&gt;next;</span><br><span class="line">p = p-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(t)&#123;</span><br><span class="line">        <span class="keyword">if</span>(pos == <span class="number">1</span>)&#123;              <span class="comment">//å¦‚æœæ˜¯å¤´èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">        p-&gt;next = t-&gt;next;</span><br><span class="line">    t-&gt;next-&gt;prior = p;</span><br><span class="line">    head = t-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(t);</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;                      <span class="comment">//å¦‚æœæ˜¯ä¸­é—´èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">        p-&gt;next = t-&gt;next;</span><br><span class="line">        t-&gt;next-&gt;prior = p;</span><br><span class="line">        <span class="built_in">free</span>(t);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°  ï¼ˆä»¥å¤´å°¾ä¹‹é—´ä¸ºåŸºå‡†ï¼‰ </span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">IsSymmetry</span><span class="params">(DupLooplist *head)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(head-&gt;next == head &amp;&amp; head-&gt;prior == head)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">DupLooplist *front, *back;</span><br><span class="line">front = head;</span><br><span class="line">back = head-&gt;prior;               <span class="comment">//åŒæŒ‡é’ˆ</span></span><br><span class="line"><span class="keyword">while</span>(front != back &amp;&amp; front-&gt;prior != back)&#123;   <span class="comment">//å¥‡æ•°ä¸ªæˆ–è€…å¶æ•°æ•°ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">if</span>(front-&gt;data != back-&gt;data)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">front = front-&gt;next;</span><br><span class="line">back = back-&gt;prior;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">DupLooplist *mylist = <span class="literal">NULL</span>;</span><br><span class="line">mylist = Create_DupLooplist(mylist, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\næ‰“å°åˆå§‹çŠ¶æ€åŒå‘å¾ªç¯é“¾è¡¨: &quot;</span>);</span><br><span class="line">Show_DupLooplist(mylist);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;\nåå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨: &quot;</span>);</span><br><span class="line">Reverse_DupLooplist(mylist);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;åˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°: &quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(IsSymmetry(mylist))</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;æ­¤åŒå‘å¾ªç¯é“¾è¡¨å¯¹ç§°&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;æ­¤åŒå‘å¾ªç¯é“¾è¡¨ä¸æ˜¯å¯¹ç§°çš„&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;åœ¨ä½ç½®2æ’å…¥æ–°èŠ‚ç‚¹å: &quot;</span>);</span><br><span class="line">mylist = Insert_DupLooplist(mylist, <span class="number">2</span>, <span class="number">30</span>);</span><br><span class="line">Show_DupLooplist(mylist);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;åˆ é™¤ä½ç½®2çš„èŠ‚ç‚¹å: &quot;</span>);</span><br><span class="line">mylist = Delete_DupLooplist(mylist, <span class="number">2</span>);</span><br><span class="line">Show_DupLooplist(mylist);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŒå‘é“¾è¡¨&quot;&gt;&lt;a href=&quot;#åŒå‘é“¾è¡¨&quot; class=&quot;headerlink&quot; title=&quot;åŒå‘é“¾è¡¨&quot;&gt;&lt;/a&gt;åŒå‘é“¾è¡¨&lt;/h1&gt;&lt;h2 id=&quot;åŒå‘é“¾è¡¨æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#åŒå‘é“¾è¡¨æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;åŒå‘é“¾è¡¨æ¦‚</summary>
      
    
    
    
    <category term="æ•°æ®ç»“æ„" scheme="http://example.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
    <category term="å­¦ä¹ " scheme="http://example.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>å•å‘é“¾è¡¨åŠå…¶åŸºæœ¬æ“ä½œ(Cè¯­è¨€)</title>
    <link href="http://example.com/2024/04/11/[%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84]%E5%8D%95%E5%90%91%E9%93%BE%E8%A1%A8%E5%8F%8A%E5%85%B6%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C(C%E8%AF%AD%E8%A8%80)/"/>
    <id>http://example.com/2024/04/11/[%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84]%E5%8D%95%E5%90%91%E9%93%BE%E8%A1%A8%E5%8F%8A%E5%85%B6%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C(C%E8%AF%AD%E8%A8%80)/</id>
    <published>2024-04-10T16:00:00.000Z</published>
    <updated>2024-04-11T16:26:48.937Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å•å‘é“¾è¡¨"><a href="#å•å‘é“¾è¡¨" class="headerlink" title="å•å‘é“¾è¡¨"></a>å•å‘é“¾è¡¨</h1><h2 id="ä»€ä¹ˆæ˜¯å•å‘é“¾è¡¨"><a href="#ä»€ä¹ˆæ˜¯å•å‘é“¾è¡¨" class="headerlink" title="ä»€ä¹ˆæ˜¯å•å‘é“¾è¡¨"></a>ä»€ä¹ˆæ˜¯å•å‘é“¾è¡¨</h2><p><strong>é“¾è¡¨</strong>æ˜¯ä¸€ç§ç‰©ç†å‚¨å­˜å•å…ƒä¸Šéè¿ç»­ã€éé¡ºåºçš„å‚¨å­˜ç»“æ„ã€‚å®ƒç”±ä¸€ç³»åˆ—ç»“ç‚¹ï¼ˆé“¾è¡¨ä¸­æ¯ä¸€ä¸ªå…ƒç´ ç§°ä¸ºç»“ç‚¹ï¼‰ç»„æˆï¼Œç»“ç‚¹å¯åŠ¨æ€ç”Ÿæˆã€‚æ¯ä¸ªç»“ç‚¹åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ªæ˜¯å­˜å‚¨æ•°æ®å…ƒç´ çš„<strong>æ•°æ®åŸŸ</strong>ï¼Œå¦ä¸€ä¸ªæ˜¯å­˜å‚¨ä¸‹ä¸€ä¸ªç»“ç‚¹åœ°å€çš„<strong>æŒ‡é’ˆåŸŸ</strong>ã€‚</p><p>å…¶å®å¯ä»¥å½¢è±¡çš„è®¤ä¸ºï¼Œ<strong>å•å‘é“¾è¡¨</strong>å°±å¥½åƒä¸€åˆ—ç«è½¦ã€‚<br>é“¾è¡¨çš„èŠ‚ç‚¹å°±å¥½åƒç«è½¦çš„æ¯ä¸€èŠ‚è½¦å¢ï¼Œè€Œé“¾è¡¨èŠ‚ç‚¹çš„æ•°æ®åŸŸå°±å¯¹åº”è½¦å¢ä¸­å­˜æ”¾çš„è´§ç‰©ï¼Œé“¾è¡¨èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸå……å½“è¿æ¥å„èŠ‚è½¦å¢çš„é”é“¾ã€‚</p><h2 id="ä¸ºä»€ä¹ˆéœ€è¦å•å‘é“¾è¡¨"><a href="#ä¸ºä»€ä¹ˆéœ€è¦å•å‘é“¾è¡¨" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦å•å‘é“¾è¡¨"></a>ä¸ºä»€ä¹ˆéœ€è¦å•å‘é“¾è¡¨</h2><p>æˆ‘ä»¬çŸ¥é“å¦‚ä½•ç”¨æ•°ç»„å»å­˜å‚¨æ•°æ®ã€‚ä½†æ˜¯åœ¨å®é™…åº”ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶ä¼šå‡ºç°ä¸€äº›ä¸å¯é¿å…çš„é—®é¢˜ï¼š</p><h3 id="é—®é¢˜1"><a href="#é—®é¢˜1" class="headerlink" title="é—®é¢˜1"></a>é—®é¢˜1</h3><p>å‡å¦‚å®šä¹‰äº†å¹¶åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ <em><strong>a[5] &#x3D; {1,2,3,4,5}</strong></em>, æ­¤æ—¶è¦åœ¨åŠ å…¥æ–°çš„å…ƒç´ ï¼Œåªèƒ½å¼€è¾Ÿä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ã€‚</p><h3 id="é—®é¢˜2"><a href="#é—®é¢˜2" class="headerlink" title="é—®é¢˜2"></a>é—®é¢˜2</h3><p>å‡å¦‚å®šä¹‰ä¸€ä¸ªæ•°ç»„ <em><strong>a[100000]</strong></em>, ä½†æ˜¯åªå­˜å‚¨äº†å‡ ä¸ªå…ƒç´ ï¼Œä¼šå¯¼è‡´æµªè´¹ç©ºé—´ã€‚</p><p>è€Œå•å‘é“¾è¡¨è¿™æ ·é“¾å¼çš„åŠ¨æ€å­˜å‚¨çš„æ•°æ®ç»“æ„ï¼Œæ°æ°è§£å†³äº†ä½¿ç”¨æ•°ç»„æ—¶è‹¥æ•°ç»„å·²æ»¡æ— æ³•æ’å…¥æ–°çš„æ•°æ®çš„é—®é¢˜ï¼Œä»¥åŠä½¿ç”¨æ•°ç»„æ—¶å¯èƒ½æµªè´¹å¤§é‡å­˜å‚¨ç©ºé—´çš„é—®é¢˜ã€‚</p><h1 id="å•å‘é“¾è¡¨çš„åˆ›å»º"><a href="#å•å‘é“¾è¡¨çš„åˆ›å»º" class="headerlink" title="å•å‘é“¾è¡¨çš„åˆ›å»º"></a>å•å‘é“¾è¡¨çš„åˆ›å»º</h1><h2 id="å•ä¸ªé“¾è¡¨èŠ‚ç‚¹çš„æ„æˆ"><a href="#å•ä¸ªé“¾è¡¨èŠ‚ç‚¹çš„æ„æˆ" class="headerlink" title="å•ä¸ªé“¾è¡¨èŠ‚ç‚¹çš„æ„æˆ"></a>å•ä¸ªé“¾è¡¨èŠ‚ç‚¹çš„æ„æˆ</h2><p>é¦–å…ˆçœ‹ä¸€ä¸‹å•å‘é“¾è¡¨èŠ‚ç‚¹çš„ç»“æ„ä½“ï¼Œæˆ‘ä»¬æŠŠå•ä¸ªèŠ‚ç‚¹çœ‹ä½œæ˜¯ä¸€èŠ‚è½¦å¢ï¼Œæ•°æ®åŸŸå°±å¥½åƒè½¦å¢å­˜å‚¨çš„è´§ç‰©ï¼ŒæŒ‡é’ˆåŸŸå°±å¥½åƒé”é“¾ã€‚</p><p><img src="/../image/627.png" class="lazyload" data-srcset="/../image/627.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="627"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Elemtype; <span class="comment">//æ•°æ®ç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    </span><br><span class="line">    Elemtype data; <span class="comment">//ç»“æ„ä½“æ•°æ®åŸŸ</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">next</span>;</span> <span class="comment">//ç»“æ„ä½“æŒ‡é’ˆåŸŸ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é“¾è¡¨çš„åˆå§‹åŒ–åˆ›å»º"><a href="#é“¾è¡¨çš„åˆå§‹åŒ–åˆ›å»º" class="headerlink" title="é“¾è¡¨çš„åˆå§‹åŒ–åˆ›å»º"></a>é“¾è¡¨çš„åˆå§‹åŒ–åˆ›å»º</h2><p>é“¾è¡¨ä¸€èˆ¬éœ€è¦ä¸€ä¸ªå¤´èŠ‚ç‚¹ï¼Œè¿™ä¸ªå¤´ç»“ç‚¹ä¸€èˆ¬æ˜¯ä¸å¸¦æ•°æ®çš„ã€‚å¯ä»¥çœ‹ä½œæ˜¯é©±åŠ¨ç«è½¦å‰è¿›çš„ç«è½¦å¤´ã€‚</p><p><img src="/../image/628.png" class="lazyload" data-srcset="/../image/628.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="628"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Linklist *<span class="title function_">Initial_linklist</span><span class="params">()</span>&#123;</span><br><span class="line">   <span class="comment">//å‘ç³»ç»Ÿç”³è¯·</span></span><br><span class="line">    Linklist *head=(Linklist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line">    head-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é“¾è¡¨åˆå§‹æ•°æ®æ’å…¥"><a href="#é“¾è¡¨åˆå§‹æ•°æ®æ’å…¥" class="headerlink" title="é“¾è¡¨åˆå§‹æ•°æ®æ’å…¥"></a>é“¾è¡¨åˆå§‹æ•°æ®æ’å…¥</h2><p>å•å‘é“¾è¡¨çš„åˆå§‹æ•°æ®å¯ä»¥æ˜¯ä»»æ„ä¸ªï¼Œæ­¤å¤„é‡‡ç”¨çš„æ˜¯å°¾æ’æ³•ï¼Œåé¢ä¼šå…·ä½“è§£é‡Šè¿™ä¸ªæ–¹æ³•ã€‚</p><p><img src="/../image/629.png" class="lazyload" data-srcset="/../image/629.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="629"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºåˆå§‹é“¾è¡¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Create_linklist</span><span class="params">(Linklist *head,<span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    Linklist *node,*end;  <span class="comment">//æ™®é€šèŠ‚ç‚¹ï¼Œå°¾èŠ‚ç‚¹</span></span><br><span class="line">    end = head ; <span class="comment">//å½“é“¾è¡¨ä¸ºç©ºæ—¶ï¼Œå¤´å°¾æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åˆ›å»ºé“¾è¡¨è¾“å…¥ %d ä¸ªå…ƒç´ :&quot;</span>, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;                <span class="comment">//nä¸ºæ’å…¥æ™®é€šèŠ‚ç‚¹çš„ä¸ªæ•°</span></span><br><span class="line">node = (Linklist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,node-&gt;next);</span><br><span class="line">    end-&gt;next=node;  <span class="comment">//å½“å‰endçš„nextæŒ‡å‘äº†æ–°èŠ‚ç‚¹node</span></span><br><span class="line">    end = node; <span class="comment">//endå¾€åç§»ï¼Œæ­¤æ—¶æ–°çš„èŠ‚ç‚¹å˜æˆå°¾èŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    end-&gt;next =<span class="literal">NULL</span>; <span class="comment">//endæœ€åå˜æˆNULL</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å•å‘é“¾è¡¨çš„åŸºæœ¬æ“ä½œ"><a href="#å•å‘é“¾è¡¨çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="å•å‘é“¾è¡¨çš„åŸºæœ¬æ“ä½œ"></a>å•å‘é“¾è¡¨çš„åŸºæœ¬æ“ä½œ</h1><h2 id="å¤´æ’æ³•-æ’å…¥å•ä¸ªæ•°æ®"><a href="#å¤´æ’æ³•-æ’å…¥å•ä¸ªæ•°æ®" class="headerlink" title="å¤´æ’æ³• æ’å…¥å•ä¸ªæ•°æ®"></a>å¤´æ’æ³• æ’å…¥å•ä¸ªæ•°æ®</h2><h3 id="å¤´æ’æ³•å›¾è§£"><a href="#å¤´æ’æ³•å›¾è§£" class="headerlink" title="å¤´æ’æ³•å›¾è§£"></a>å¤´æ’æ³•å›¾è§£</h3><p><img src="/../image/630.png" class="lazyload" data-srcset="/../image/630.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="630"></p><p><img src="/../image/631.png" class="lazyload" data-srcset="/../image/631.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="631"></p><p><img src="/../image/632.png" class="lazyload" data-srcset="/../image/632.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="632"></p><p>å¤´æ’æ³•ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">insert_front</span><span class="params">(Linklist *head,<span class="type">int</span> data)</span></span><br><span class="line">&#123;</span><br><span class="line">  Linklist *node = (Linklist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line">  node-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">  node-&gt;data=data;</span><br><span class="line">  </span><br><span class="line">  node-&gt;next=head-&gt;next; <span class="comment">//æ–°èŠ‚ç‚¹nodeçš„nextæŒ‡å‘å½“å‰headçš„next</span></span><br><span class="line">  head-&gt;next=node;  <span class="comment">//headçš„nexté‡æ–°æŒ‡å‘æ–°èŠ‚ç‚¹node</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å°¾æ’æ³•-æ’å…¥å•ä¸ªæ•°æ®"><a href="#å°¾æ’æ³•-æ’å…¥å•ä¸ªæ•°æ®" class="headerlink" title="å°¾æ’æ³• æ’å…¥å•ä¸ªæ•°æ®"></a>å°¾æ’æ³• æ’å…¥å•ä¸ªæ•°æ®</h2><h3 id="å°¾æ’æ³•å›¾è§£"><a href="#å°¾æ’æ³•å›¾è§£" class="headerlink" title="å°¾æ’æ³•å›¾è§£"></a>å°¾æ’æ³•å›¾è§£</h3><p>ä¸ªäººç†è§£ï¼Œå°¾æ’æ³•å°±æ˜¯ä¾æ¬¡nodeå¾€åé€’</p><p><img src="/../image/633.png" class="lazyload" data-srcset="/../image/633.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="633"></p><p>å°¾æ’æ³•ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">insert_back</span><span class="params">(Linklist *head,<span class="type">int</span> data)</span></span><br><span class="line">&#123;</span><br><span class="line">   Linklist *node = (Linklist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line">  node-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">  node-&gt;data=data;</span><br><span class="line">    </span><br><span class="line">  Linklist *end =head; <span class="comment">//èµ·åˆendæŒ‡å‘å¤´èŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">while</span>(end-&gt;next!=<span class="literal">NULL</span>)</span><br><span class="line">  &#123;</span><br><span class="line">      end=end-&gt;next;<span class="comment">//endæŒ‡é’ˆå¾€åç§»ï¼Œç›´åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">      end-&gt;next=node; <span class="comment">//å½“å‰endçš„nextæŒ‡å‘äº†æ–°èŠ‚ç‚¹node</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æŒ‡å®šä½ç½®æ’å…¥èŠ‚ç‚¹"><a href="#æŒ‡å®šä½ç½®æ’å…¥èŠ‚ç‚¹" class="headerlink" title="æŒ‡å®šä½ç½®æ’å…¥èŠ‚ç‚¹"></a>æŒ‡å®šä½ç½®æ’å…¥èŠ‚ç‚¹</h2><h3 id="åˆ†æåŠè§£é‡Š"><a href="#åˆ†æåŠè§£é‡Š" class="headerlink" title="åˆ†æåŠè§£é‡Š"></a>åˆ†æåŠè§£é‡Š</h3><p>æŒ‡å®šä½ç½®æ’å…¥å•ä¸ªæ•°æ®ï¼Œè¿™é‡Œä¸€èˆ¬è®¾å®šä¸ºåœ¨ç¬¬ <em><strong>k</strong></em> ä¸ªå¸¦æ•°æ®çš„æ™®é€šèŠ‚ç‚¹(é™¤å»å¤´èŠ‚ç‚¹)ä½ç½®æ’å…¥ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ã€‚å…¶å®æŒ‡å®šä½ç½®æ’å…¥æ–°èŠ‚ç‚¹çš„åŸç†å’Œå¤´æ’æ³•æ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡æ˜¯å°†ç¬¬ <em><strong>k</strong></em> ä¸ªå¸¦æ•°æ®èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹çœ‹æˆå¤´ç»“ç‚¹ä¸€æ ·ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ç¬¬ <em><strong>k-1</strong></em> ä¸ªå¸¦æ•°æ®èŠ‚ç‚¹ï¼Œå‡å¦‚éå†æŒ‡é’ˆ <em><strong>t</strong></em> ä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œé‚£ä¹ˆç®—ä¸Šå¤´èŠ‚ç‚¹ï¼Œéœ€è¦ç»å† <em><strong>k-1</strong></em> æ¬¡å¾ªç¯æ‰¾åˆ°ç¬¬ <em><strong>k-1</strong></em> ä¸ªå¸¦æ•°æ®èŠ‚ç‚¹ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœ<strong>k &#x3D; 1</strong>çš„è¯ï¼Œä¹Ÿå°±æ˜¯åœ¨ç¬¬ä¸€ä¸ªå¸¦æ•°æ®èŠ‚ç‚¹çš„ä½ç½®æ’å…¥æ–°èŠ‚ç‚¹ï¼Œä¸å­˜åœ¨ç¬¬0ä¸ªå¸¦æ•°æ®èŠ‚ç‚¹ï¼Œæ­¤æ—¶å…¶å®è¿™ä¸ªç¬¬ <em><strong>k-1</strong></em> ä¸ªèŠ‚ç‚¹å°±å˜æˆäº†å¤´èŠ‚ç‚¹ã€‚é‚£ä¹ˆæ­¤æ—¶æ˜æ˜¾å’Œå¤´æ’æ³•æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚</p><p>å›¾è§£çš„è¯å¯ä»¥å‚è€ƒå¤´æ’æ³•çš„å›¾è§£ï¼Œæ˜¯å·®ä¸å¤šçš„</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">insert_position</span><span class="params">(Linklist *head ,<span class="type">int</span> k)</span></span><br><span class="line">&#123;</span><br><span class="line">    Linklist *t=head,*in;  <span class="comment">//tä¸ºéå†æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;k<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        t=t-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(t!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            in=(Linklist*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line">            in-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;åœ¨ç¬¬ %d ä¸ªèŠ‚ç‚¹å¤„æ’å…¥æ–°èŠ‚ç‚¹çš„æ•°æ®:&quot;</span>,k);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,in-&gt;data);</span><br><span class="line">            in-&gt;next=t-&gt;next;<span class="comment">//æ’å…¥èŠ‚ç‚¹inçš„nextæŒ‡å‘å½“å‰ç¬¬k-1ä¸ªæ™®é€šèŠ‚ç‚¹çš„nextæŒ‡å‘çš„èŠ‚ç‚¹</span></span><br><span class="line">            t-&gt;next=in;<span class="comment">//ç¬¬k-1ä¸ªæ™®é€šèŠ‚ç‚¹çš„nexté‡æ–°æŒ‡å‘æ’å…¥çš„èŠ‚ç‚¹in</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="built_in">puts</span>(<span class="string">&quot;èŠ‚ç‚¹ä¸å­˜åœ¨&quot;</span>);        </span><br><span class="line">             &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><h2 id="éå†è¾“å‡ºé“¾è¡¨æ•°æ®"><a href="#éå†è¾“å‡ºé“¾è¡¨æ•°æ®" class="headerlink" title="éå†è¾“å‡ºé“¾è¡¨æ•°æ®"></a>éå†è¾“å‡ºé“¾è¡¨æ•°æ®</h2><h3 id="åˆ†æåŠè§£é‡Š-1"><a href="#åˆ†æåŠè§£é‡Š-1" class="headerlink" title="åˆ†æåŠè§£é‡Š"></a>åˆ†æåŠè§£é‡Š</h3><p>æˆ‘ä»¬éœ€è¦ç”¨æŒ‡é’ˆå»è®¿é—®é“¾è¡¨ä¸­çš„æ•°æ®ã€‚å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆ<em><strong>t</strong></em>ï¼Œæ¥å¯¹é“¾è¡¨çš„æ¯ä¸€ä¸ªå­˜æœ‰æ•°æ®çš„èŠ‚ç‚¹è¿›è¡Œè®¿é—®å¹¶è¯»å–æ•°æ®ï¼Œç›´åˆ°å½“å‰èŠ‚ç‚¹ä¸ºNULLï¼Œåœæ­¢éå†ã€‚<br>é€šä¿—åœ°æ¥è¯´ï¼Œå°±å¥½æ¯”ä¸€ä¸ªå¸è´§å‘˜å·¥ï¼Œä»–æŒ¨ä¸ªä»å¤´åˆ°å°¾å–ä¸‹æ¯ä¸€èŠ‚ç«è½¦è½¦å¢çš„è´§ç‰©ï¼Œç›´åˆ°æœ€ååˆ°è¾¾å°¾éƒ¨è½¦å¢çš„æ—¶å€™ï¼Œä»–ä¾¿ä¸å†å–ä¸‹è´§ç‰©ã€‚ğŸ¤—</p><h3 id="æ‰“å°é“¾è¡¨ä»£ç "><a href="#æ‰“å°é“¾è¡¨ä»£ç " class="headerlink" title="æ‰“å°é“¾è¡¨ä»£ç "></a>æ‰“å°é“¾è¡¨ä»£ç </h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰“å°é“¾è¡¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Show_linklist</span><span class="params">(Linklist *head)</span> &#123;</span><br><span class="line">    Linklist *t = head-&gt;next;<span class="comment">//tä¸ºéå†æŒ‡é’ˆ è®¿é—®æ¯ä¸ªèŠ‚ç‚¹æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t == <span class="literal">NULL</span>)</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;é“¾è¡¨ä¸ºç©º&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t-&gt;data);</span><br><span class="line">t = t-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹"><a href="#æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹" class="headerlink" title="æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹"></a>æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹</h2><h3 id="åˆ†æåŠè§£é‡Š-2"><a href="#åˆ†æåŠè§£é‡Š-2" class="headerlink" title="åˆ†æåŠè§£é‡Š"></a>åˆ†æåŠè§£é‡Š</h3><p>åˆ é™¤å•ä¸ªèŠ‚ç‚¹å¾ˆå®¹æ˜“ï¼Œåªéœ€è¦æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åç›´æ¥è·¨è¿‡ä¸­é—´è¿™ä¸ªåˆ é™¤çš„èŠ‚ç‚¹æŒ‡å‘åˆ é™¤èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å°±å¯ä»¥äº†ã€‚</p><h3 id="æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹-å›¾è§£"><a href="#æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹-å›¾è§£" class="headerlink" title="æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹ å›¾è§£"></a>æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹ å›¾è§£</h3><p><img src="/../image/634.png" class="lazyload" data-srcset="/../image/634.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="634"></p><p><img src="/../image/635.png" class="lazyload" data-srcset="/../image/635.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="635"></p><p><img src="/../image/636.png" class="lazyload" data-srcset="/../image/636.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="636"></p><h3 id="æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹-ä»£ç "><a href="#æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹-ä»£ç " class="headerlink" title="æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹ ä»£ç "></a>æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹ ä»£ç </h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Delete_position</span><span class="params">(Linklist *head, <span class="type">int</span> k)</span> &#123; <span class="comment">//kè¡¨ç¤ºè¦åˆ é™¤ç¬¬kä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    Linklist *t = head, *del = <span class="literal">NULL</span>;          <span class="comment">//tä¸ºéå†æŒ‡é’ˆ</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; k - <span class="number">1</span> &amp;&amp; t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">t = t-&gt;next;                          <span class="comment">//tæŒ‡å‘åˆ é™¤çš„ç¬¬kä¸ªçš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">del = t-&gt;next;                  </span><br><span class="line">t-&gt;next = del-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(del);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;èŠ‚ç‚¹ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–åŸºæœ¬æ“ä½œ"><a href="#å…¶ä»–åŸºæœ¬æ“ä½œ" class="headerlink" title="å…¶ä»–åŸºæœ¬æ“ä½œ"></a>å…¶ä»–åŸºæœ¬æ“ä½œ</h2><h3 id="x-include-include-includeâ€‹typedef-int-Elemtype-â€‹typedef-struct-Node-â€‹-Elemtype-data-struct-Node-prior-struct-Node-next-â€‹-DupLooplist-â€‹â€‹â€‹-åˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨-å¤´èŠ‚ç‚¹å¸¦æ•°æ®-DupLooplist-Create-DupLooplist-DupLooplist-head-int-n-head-DupLooplist-malloc-sizeof-DupLooplist-head-next-head-head-prior-head-DupLooplist-end-head-printf-â€œåˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨è¾“å…¥-d-ä¸ªæ•°æ®-nâ€-n-scanf-â€œ-dâ€-head-data-for-int-i-1-i-n-i-DupLooplist-node-DupLooplist-malloc-sizeof-DupLooplist-node-next-NULL-node-prior-NULL-scanf-â€œ-dâ€-node-data-â€‹-end-next-node-node-prior-end-end-node-end-next-head-head-prior-end-â€‹-return-head-â€‹â€‹â€‹-éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨void-Show-DupLooplist-DupLooplist-head-DupLooplist-t-head-while-true-printf-â€œ-d-â€œ-t-data-t-t-next-if-t-head-break-printf-â€œ-nâ€-â€‹â€‹-åå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨void-Reverse-DupLooplist-DupLooplist-head-DupLooplist-t-head-prior-DupLooplist-end-head-prior-while-true-printf-â€œ-d-â€œ-t-data-t-t-prior-if-t-end-break-printf-â€œ-nâ€-â€‹â€‹-æ’å…¥æ•°æ®DupLooplist-Insert-DupLooplist-DupLooplist-head-int-pos-Elemtype-data-DupLooplist-node-DupLooplist-malloc-sizeof-DupLooplist-DupLooplist-end-head-prior-node-data-data-node-prior-NULL-node-next-NULL-â€‹-if-pos-1-æ’åœ¨è¡¨å¤´-æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å¤´-node-next-head-head-prior-node-node-prior-end-end-next-node-head-node-â€‹-else-DupLooplist-t-head-for-int-i-1-i-pos-1-i-æ‰¾åˆ°è¦æ’å…¥ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹-t-t-next-â€‹-if-t-next-head-æ’åœ¨è¡¨å°¾-æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å°¾-end-next-node-node-prior-end-node-next-head-head-prior-node-end-node-â€‹-else-æ’åœ¨è¡¨ä¸­-t-next-prior-node-node-next-t-next-t-next-node-node-prior-t-â€‹-â€‹-return-head-â€‹â€‹-åˆ é™¤åŒå‘å¾ªç¯é“¾è¡¨æŒ‡å®šä½ç½®å…ƒç´ DupLooplist-Delete-DupLooplist-DupLooplist-head-int-pos-DupLooplist-t-head-DupLooplist-p-t-prior-for-int-i-1-i-pos-i-æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹-ä»¥åŠå…¶å‰é©±èŠ‚ç‚¹-t-t-next-p-p-next-â€‹-if-t-if-pos-1-å¦‚æœæ˜¯å¤´èŠ‚ç‚¹â€‹-p-next-t-next-t-next-prior-p-head-t-next-free-t-return-head-â€‹-else-å¦‚æœæ˜¯ä¸­é—´èŠ‚ç‚¹â€‹-p-next-t-next-t-next-prior-p-free-t-return-head-â€‹-â€‹â€‹-åˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°-ï¼ˆä»¥å¤´å°¾ä¹‹é—´ä¸ºåŸºå‡†ï¼‰-bool-IsSymmetry-DupLooplist-head-if-head-next-head-head-prior-head-return-false-â€‹-DupLooplist-front-back-front-head-back-head-prior-åŒæŒ‡é’ˆ-while-front-back-front-prior-back-å¥‡æ•°ä¸ªæˆ–è€…å¶æ•°æ•°ä¸ªèŠ‚ç‚¹-if-front-data-back-data-return-false-front-front-next-back-back-prior-return-true-â€‹â€‹â€‹int-main-DupLooplist-mylist-NULL-mylist-Create-DupLooplist-mylist-10-â€‹â€‹-puts-â€œ-næ‰“å°åˆå§‹çŠ¶æ€åŒå‘å¾ªç¯é“¾è¡¨-â€œ-Show-DupLooplist-mylist-puts-â€œ-nåå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨-â€œ-Reverse-DupLooplist-mylist-printf-â€œ-nâ€-â€‹â€‹-puts-â€œåˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°-â€œ-if-IsSymmetry-mylist-puts-â€œæ­¤åŒå‘å¾ªç¯é“¾è¡¨å¯¹ç§°â€-else-puts-â€œæ­¤åŒå‘å¾ªç¯é“¾è¡¨ä¸æ˜¯å¯¹ç§°çš„â€-printf-â€œ-nâ€-â€‹â€‹-puts-â€œåœ¨ä½ç½®2æ’å…¥æ–°èŠ‚ç‚¹å-â€œ-mylist-Insert-DupLooplist-mylist-2-30-Show-DupLooplist-mylist-printf-â€œ-nâ€-â€‹â€‹-puts-â€œåˆ é™¤ä½ç½®2çš„èŠ‚ç‚¹å-â€œ-mylist-Delete-DupLooplist-mylist-2-Show-DupLooplist-mylist-printf-â€œ-nâ€-c"><a href="#x-include-include-includeâ€‹typedef-int-Elemtype-â€‹typedef-struct-Node-â€‹-Elemtype-data-struct-Node-prior-struct-Node-next-â€‹-DupLooplist-â€‹â€‹â€‹-åˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨-å¤´èŠ‚ç‚¹å¸¦æ•°æ®-DupLooplist-Create-DupLooplist-DupLooplist-head-int-n-head-DupLooplist-malloc-sizeof-DupLooplist-head-next-head-head-prior-head-DupLooplist-end-head-printf-â€œåˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨è¾“å…¥-d-ä¸ªæ•°æ®-nâ€-n-scanf-â€œ-dâ€-head-data-for-int-i-1-i-n-i-DupLooplist-node-DupLooplist-malloc-sizeof-DupLooplist-node-next-NULL-node-prior-NULL-scanf-â€œ-dâ€-node-data-â€‹-end-next-node-node-prior-end-end-node-end-next-head-head-prior-end-â€‹-return-head-â€‹â€‹â€‹-éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨void-Show-DupLooplist-DupLooplist-head-DupLooplist-t-head-while-true-printf-â€œ-d-â€œ-t-data-t-t-next-if-t-head-break-printf-â€œ-nâ€-â€‹â€‹-åå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨void-Reverse-DupLooplist-DupLooplist-head-DupLooplist-t-head-prior-DupLooplist-end-head-prior-while-true-printf-â€œ-d-â€œ-t-data-t-t-prior-if-t-end-break-printf-â€œ-nâ€-â€‹â€‹-æ’å…¥æ•°æ®DupLooplist-Insert-DupLooplist-DupLooplist-head-int-pos-Elemtype-data-DupLooplist-node-DupLooplist-malloc-sizeof-DupLooplist-DupLooplist-end-head-prior-node-data-data-node-prior-NULL-node-next-NULL-â€‹-if-pos-1-æ’åœ¨è¡¨å¤´-æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å¤´-node-next-head-head-prior-node-node-prior-end-end-next-node-head-node-â€‹-else-DupLooplist-t-head-for-int-i-1-i-pos-1-i-æ‰¾åˆ°è¦æ’å…¥ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹-t-t-next-â€‹-if-t-next-head-æ’åœ¨è¡¨å°¾-æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å°¾-end-next-node-node-prior-end-node-next-head-head-prior-node-end-node-â€‹-else-æ’åœ¨è¡¨ä¸­-t-next-prior-node-node-next-t-next-t-next-node-node-prior-t-â€‹-â€‹-return-head-â€‹â€‹-åˆ é™¤åŒå‘å¾ªç¯é“¾è¡¨æŒ‡å®šä½ç½®å…ƒç´ DupLooplist-Delete-DupLooplist-DupLooplist-head-int-pos-DupLooplist-t-head-DupLooplist-p-t-prior-for-int-i-1-i-pos-i-æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹-ä»¥åŠå…¶å‰é©±èŠ‚ç‚¹-t-t-next-p-p-next-â€‹-if-t-if-pos-1-å¦‚æœæ˜¯å¤´èŠ‚ç‚¹â€‹-p-next-t-next-t-next-prior-p-head-t-next-free-t-return-head-â€‹-else-å¦‚æœæ˜¯ä¸­é—´èŠ‚ç‚¹â€‹-p-next-t-next-t-next-prior-p-free-t-return-head-â€‹-â€‹â€‹-åˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°-ï¼ˆä»¥å¤´å°¾ä¹‹é—´ä¸ºåŸºå‡†ï¼‰-bool-IsSymmetry-DupLooplist-head-if-head-next-head-head-prior-head-return-false-â€‹-DupLooplist-front-back-front-head-back-head-prior-åŒæŒ‡é’ˆ-while-front-back-front-prior-back-å¥‡æ•°ä¸ªæˆ–è€…å¶æ•°æ•°ä¸ªèŠ‚ç‚¹-if-front-data-back-data-return-false-front-front-next-back-back-prior-return-true-â€‹â€‹â€‹int-main-DupLooplist-mylist-NULL-mylist-Create-DupLooplist-mylist-10-â€‹â€‹-puts-â€œ-næ‰“å°åˆå§‹çŠ¶æ€åŒå‘å¾ªç¯é“¾è¡¨-â€œ-Show-DupLooplist-mylist-puts-â€œ-nåå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨-â€œ-Reverse-DupLooplist-mylist-printf-â€œ-nâ€-â€‹â€‹-puts-â€œåˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°-â€œ-if-IsSymmetry-mylist-puts-â€œæ­¤åŒå‘å¾ªç¯é“¾è¡¨å¯¹ç§°â€-else-puts-â€œæ­¤åŒå‘å¾ªç¯é“¾è¡¨ä¸æ˜¯å¯¹ç§°çš„â€-printf-â€œ-nâ€-â€‹â€‹-puts-â€œåœ¨ä½ç½®2æ’å…¥æ–°èŠ‚ç‚¹å-â€œ-mylist-Insert-DupLooplist-mylist-2-30-Show-DupLooplist-mylist-printf-â€œ-nâ€-â€‹â€‹-puts-â€œåˆ é™¤ä½ç½®2çš„èŠ‚ç‚¹å-â€œ-mylist-Delete-DupLooplist-mylist-2-Show-DupLooplist-mylist-printf-â€œ-nâ€-c" class="headerlink" title="xÂ #include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#include&lt;string.h&gt;â€‹typedef int Elemtype;â€‹typedef struct Node{â€‹    Elemtype data;    struct Node *prior;    struct Node next;â€‹} DupLooplist;â€‹â€‹â€‹&#x2F;&#x2F;åˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨ (å¤´èŠ‚ç‚¹å¸¦æ•°æ®)DupLooplist Create_DupLooplist(DupLooplist *head, int n){    head &#x3D; (DupLooplist *)malloc(sizeof(DupLooplist));    head-&gt;next &#x3D; head;    head-&gt;prior &#x3D; head;    DupLooplist *end &#x3D; head;    printf(â€œåˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨è¾“å…¥ %d ä¸ªæ•°æ®: \nâ€, n);    scanf(â€œ%dâ€, &amp;head-&gt;data);    for(int i &#x3D; 1; i &lt; n; i++){        DupLooplist *node &#x3D; (DupLooplist *)malloc(sizeof(DupLooplist));        node-&gt;next &#x3D; NULL;        node-&gt;prior &#x3D; NULL;        scanf(â€œ%dâ€, &amp;node-&gt;data);â€‹        end-&gt;next &#x3D; node;        node-&gt;prior &#x3D; end;        end &#x3D; node;    }    end-&gt;next &#x3D; head;    head-&gt;prior &#x3D; end;â€‹    return head;}â€‹â€‹â€‹&#x2F;&#x2F;éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨void Show_DupLooplist(DupLooplist *head){    DupLooplist *t &#x3D; head;    while(true){        printf(â€œ%d â€œ, t-&gt;data);        t &#x3D; t-&gt;next;        if(t &#x3D;&#x3D; head)            break;    }    printf(â€œ\nâ€);}â€‹â€‹&#x2F;&#x2F;åå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨void Reverse_DupLooplist(DupLooplist *head){    DupLooplist *t &#x3D; head-&gt;prior;    DupLooplist end &#x3D; head-&gt;prior;    while(true){        printf(â€œ%d â€œ, t-&gt;data);        t &#x3D; t-&gt;prior;        if(t &#x3D;&#x3D; end)            break;    }    printf(â€œ\nâ€);}â€‹â€‹&#x2F;&#x2F;æ’å…¥æ•°æ®DupLooplist Insert_DupLooplist(DupLooplist *head, int pos, Elemtype data){    DupLooplist *node &#x3D; (DupLooplist *)malloc(sizeof(DupLooplist));    DupLooplist *end &#x3D; head-&gt;prior;    node-&gt;data &#x3D; data;    node-&gt;prior &#x3D; NULL;    node-&gt;next &#x3D; NULL;â€‹    if(pos &#x3D;&#x3D; 1){ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â &#x2F;&#x2F;æ’åœ¨è¡¨å¤´ æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å¤´                node-&gt;next &#x3D; head;        head-&gt;prior &#x3D; node;        node-&gt;prior &#x3D; end;        end-&gt;next &#x3D; node;        head &#x3D; node;â€‹    }else{        DupLooplist t &#x3D; head;        for(int i &#x3D; 1; i &lt; pos - 1; i++) &#x2F;&#x2F;æ‰¾åˆ°è¦æ’å…¥ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹            t &#x3D; t-&gt;next;â€‹ Â  Â  Â  Â if(t-&gt;next &#x3D;&#x3D; head){ Â  Â  Â  Â  Â  Â  &#x2F;&#x2F;æ’åœ¨è¡¨å°¾ æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å°¾ Â  Â  Â        Â  Â  Â       end-&gt;next &#x3D; node; Â  Â  Â       node-&gt;prior &#x3D; end; Â  Â  Â       node-&gt;next &#x3D; head; Â  Â  Â       head-&gt;prior &#x3D; node; Â  Â  Â     Â  Â  Â       end &#x3D; node;â€‹ Â  Â  Â   }else{ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#x2F;&#x2F;æ’åœ¨è¡¨ä¸­ Â  Â  Â        Â  Â  Â       t-&gt;next-&gt;prior &#x3D; node; Â  Â  Â       node-&gt;next &#x3D; t-&gt;next; Â  Â  Â       t-&gt;next &#x3D; node; Â  Â  Â       node-&gt;prior &#x3D; t;â€‹ Â  Â  Â   }    }â€‹    return head;}â€‹â€‹&#x2F;&#x2F;åˆ é™¤åŒå‘å¾ªç¯é“¾è¡¨æŒ‡å®šä½ç½®å…ƒç´ DupLooplist Delete_DupLooplist(DupLooplist *head, int pos){    DupLooplist *t &#x3D; head;    DupLooplist *p &#x3D; t-&gt;prior;    for(int i &#x3D; 1; i &lt; pos; i++) Â  &#x2F;&#x2F;æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹ ä»¥åŠå…¶å‰é©±èŠ‚ç‚¹    { Â          t &#x3D; t-&gt;next;        p &#x3D; p-&gt;next;    }â€‹ Â  Â if(t){ Â  Â  Â  Â if(pos &#x3D;&#x3D; 1){ Â  Â  Â  Â  Â  Â  Â &#x2F;&#x2F;å¦‚æœæ˜¯å¤´èŠ‚ç‚¹â€‹ Â  Â  Â       p-&gt;next &#x3D; t-&gt;next;         Â  Â t-&gt;next-&gt;prior &#x3D; p;         Â  Â head &#x3D; t-&gt;next;         Â  Â free(t);         Â  Â return head;â€‹ Â  Â  Â   } Â  Â  Â  Â else{ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â &#x2F;&#x2F;å¦‚æœæ˜¯ä¸­é—´èŠ‚ç‚¹â€‹ Â  Â  Â       p-&gt;next &#x3D; t-&gt;next; Â  Â  Â       t-&gt;next-&gt;prior &#x3D; p; Â  Â  Â       free(t); Â  Â  Â       return head;â€‹ Â  Â  Â   } Â   }   }â€‹â€‹&#x2F;&#x2F;åˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°  ï¼ˆä»¥å¤´å°¾ä¹‹é—´ä¸ºåŸºå‡†ï¼‰ bool IsSymmetry(DupLooplist *head){    if(head-&gt;next &#x3D;&#x3D; head &amp;&amp; head-&gt;prior &#x3D;&#x3D; head)        return false;â€‹    DupLooplist *front, *back;    front &#x3D; head;    back &#x3D; head-&gt;prior; Â  Â  Â  Â  Â  Â  Â  &#x2F;&#x2F;åŒæŒ‡é’ˆ    while(front !&#x3D; back &amp;&amp; front-&gt;prior !&#x3D; back){ Â  &#x2F;&#x2F;å¥‡æ•°ä¸ªæˆ–è€…å¶æ•°æ•°ä¸ªèŠ‚ç‚¹        if(front-&gt;data !&#x3D; back-&gt;data)            return false;         Â  Â         front &#x3D; front-&gt;next;        back &#x3D; back-&gt;prior;    }     Â  Â return true;}â€‹â€‹â€‹int main(){    DupLooplist *mylist &#x3D; NULL;    mylist &#x3D; Create_DupLooplist(mylist, 10);â€‹â€‹ Â  Â puts(â€œ\næ‰“å°åˆå§‹çŠ¶æ€åŒå‘å¾ªç¯é“¾è¡¨: â€œ);    Show_DupLooplist(mylist);    puts(â€œ\nåå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨: â€œ);    Reverse_DupLooplist(mylist);    printf(â€œ\nâ€);â€‹â€‹ Â  Â puts(â€œåˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°: â€œ);    if(IsSymmetry(mylist))        puts(â€œæ­¤åŒå‘å¾ªç¯é“¾è¡¨å¯¹ç§°â€);    else        puts(â€œæ­¤åŒå‘å¾ªç¯é“¾è¡¨ä¸æ˜¯å¯¹ç§°çš„â€);    printf(â€œ\nâ€);â€‹â€‹ Â  Â puts(â€œåœ¨ä½ç½®2æ’å…¥æ–°èŠ‚ç‚¹å: â€œ);    mylist &#x3D; Insert_DupLooplist(mylist, 2, 30);    Show_DupLooplist(mylist);    printf(â€œ\nâ€);â€‹â€‹    puts(â€œåˆ é™¤ä½ç½®2çš„èŠ‚ç‚¹å: â€œ);    mylist &#x3D; Delete_DupLooplist(mylist, 2);    Show_DupLooplist(mylist);    printf(â€œ\nâ€);}c"></a>xÂ #include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#include&lt;string.h&gt;â€‹typedef int Elemtype;â€‹typedef struct Node{â€‹    Elemtype data;    struct Node *prior;    struct Node <em>next;â€‹} DupLooplist;â€‹â€‹â€‹&#x2F;&#x2F;åˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨ (å¤´èŠ‚ç‚¹å¸¦æ•°æ®)DupLooplist</em> Create_DupLooplist(DupLooplist *head, int n){    head &#x3D; (DupLooplist *)malloc(sizeof(DupLooplist));    head-&gt;next &#x3D; head;    head-&gt;prior &#x3D; head;    DupLooplist *end &#x3D; head;    printf(â€œåˆ›å»ºåˆå§‹åŒå‘å¾ªç¯é“¾è¡¨è¾“å…¥ %d ä¸ªæ•°æ®: \nâ€, n);    scanf(â€œ%dâ€, &amp;head-&gt;data);    for(int i &#x3D; 1; i &lt; n; i++){        DupLooplist *node &#x3D; (DupLooplist *)malloc(sizeof(DupLooplist));        node-&gt;next &#x3D; NULL;        node-&gt;prior &#x3D; NULL;        scanf(â€œ%dâ€, &amp;node-&gt;data);â€‹        end-&gt;next &#x3D; node;        node-&gt;prior &#x3D; end;        end &#x3D; node;    }    end-&gt;next &#x3D; head;    head-&gt;prior &#x3D; end;â€‹    return head;}â€‹â€‹â€‹&#x2F;&#x2F;éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨void Show_DupLooplist(DupLooplist *head){    DupLooplist *t &#x3D; head;    while(true){        printf(â€œ%d â€œ, t-&gt;data);        t &#x3D; t-&gt;next;        if(t &#x3D;&#x3D; head)            break;    }    printf(â€œ\nâ€);}â€‹â€‹&#x2F;&#x2F;åå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨void Reverse_DupLooplist(DupLooplist *head){    DupLooplist *t &#x3D; head-&gt;prior;    DupLooplist <em>end &#x3D; head-&gt;prior;    while(true){        printf(â€œ%d â€œ, t-&gt;data);        t &#x3D; t-&gt;prior;        if(t &#x3D;&#x3D; end)            break;    }    printf(â€œ\nâ€);}â€‹â€‹&#x2F;&#x2F;æ’å…¥æ•°æ®DupLooplist</em> Insert_DupLooplist(DupLooplist *head, int pos, Elemtype data){    DupLooplist *node &#x3D; (DupLooplist *)malloc(sizeof(DupLooplist));    DupLooplist *end &#x3D; head-&gt;prior;    node-&gt;data &#x3D; data;    node-&gt;prior &#x3D; NULL;    node-&gt;next &#x3D; NULL;â€‹    if(pos &#x3D;&#x3D; 1){ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â &#x2F;&#x2F;æ’åœ¨è¡¨å¤´ æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å¤´                node-&gt;next &#x3D; head;        head-&gt;prior &#x3D; node;        node-&gt;prior &#x3D; end;        end-&gt;next &#x3D; node;        head &#x3D; node;â€‹    }else{        DupLooplist <em>t &#x3D; head;        for(int i &#x3D; 1; i &lt; pos - 1; i++) &#x2F;&#x2F;æ‰¾åˆ°è¦æ’å…¥ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹            t &#x3D; t-&gt;next;â€‹ Â  Â  Â  Â if(t-&gt;next &#x3D;&#x3D; head){ Â  Â  Â  Â  Â  Â  &#x2F;&#x2F;æ’åœ¨è¡¨å°¾ æ–°èŠ‚ç‚¹ä½œä¸ºè¡¨å°¾ Â  Â  Â        Â  Â  Â       end-&gt;next &#x3D; node; Â  Â  Â       node-&gt;prior &#x3D; end; Â  Â  Â       node-&gt;next &#x3D; head; Â  Â  Â       head-&gt;prior &#x3D; node; Â  Â  Â     Â  Â  Â       end &#x3D; node;â€‹ Â  Â  Â   }else{ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#x2F;&#x2F;æ’åœ¨è¡¨ä¸­ Â  Â  Â        Â  Â  Â       t-&gt;next-&gt;prior &#x3D; node; Â  Â  Â       node-&gt;next &#x3D; t-&gt;next; Â  Â  Â       t-&gt;next &#x3D; node; Â  Â  Â       node-&gt;prior &#x3D; t;â€‹ Â  Â  Â   }    }â€‹    return head;}â€‹â€‹&#x2F;&#x2F;åˆ é™¤åŒå‘å¾ªç¯é“¾è¡¨æŒ‡å®šä½ç½®å…ƒç´ DupLooplist</em> Delete_DupLooplist(DupLooplist *head, int pos){    DupLooplist *t &#x3D; head;    DupLooplist *p &#x3D; t-&gt;prior;    for(int i &#x3D; 1; i &lt; pos; i++) Â  &#x2F;&#x2F;æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹ ä»¥åŠå…¶å‰é©±èŠ‚ç‚¹    { Â          t &#x3D; t-&gt;next;        p &#x3D; p-&gt;next;    }â€‹ Â  Â if(t){ Â  Â  Â  Â if(pos &#x3D;&#x3D; 1){ Â  Â  Â  Â  Â  Â  Â &#x2F;&#x2F;å¦‚æœæ˜¯å¤´èŠ‚ç‚¹â€‹ Â  Â  Â       p-&gt;next &#x3D; t-&gt;next;         Â  Â t-&gt;next-&gt;prior &#x3D; p;         Â  Â head &#x3D; t-&gt;next;         Â  Â free(t);         Â  Â return head;â€‹ Â  Â  Â   } Â  Â  Â  Â else{ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â &#x2F;&#x2F;å¦‚æœæ˜¯ä¸­é—´èŠ‚ç‚¹â€‹ Â  Â  Â       p-&gt;next &#x3D; t-&gt;next; Â  Â  Â       t-&gt;next-&gt;prior &#x3D; p; Â  Â  Â       free(t); Â  Â  Â       return head;â€‹ Â  Â  Â   } Â   }   }â€‹â€‹&#x2F;&#x2F;åˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°  ï¼ˆä»¥å¤´å°¾ä¹‹é—´ä¸ºåŸºå‡†ï¼‰ bool IsSymmetry(DupLooplist *head){    if(head-&gt;next &#x3D;&#x3D; head &amp;&amp; head-&gt;prior &#x3D;&#x3D; head)        return false;â€‹    DupLooplist *front, *back;    front &#x3D; head;    back &#x3D; head-&gt;prior; Â  Â  Â  Â  Â  Â  Â  &#x2F;&#x2F;åŒæŒ‡é’ˆ    while(front !&#x3D; back &amp;&amp; front-&gt;prior !&#x3D; back){ Â  &#x2F;&#x2F;å¥‡æ•°ä¸ªæˆ–è€…å¶æ•°æ•°ä¸ªèŠ‚ç‚¹        if(front-&gt;data !&#x3D; back-&gt;data)            return false;         Â  Â         front &#x3D; front-&gt;next;        back &#x3D; back-&gt;prior;    }     Â  Â return true;}â€‹â€‹â€‹int main(){    DupLooplist *mylist &#x3D; NULL;    mylist &#x3D; Create_DupLooplist(mylist, 10);â€‹â€‹ Â  Â puts(â€œ\næ‰“å°åˆå§‹çŠ¶æ€åŒå‘å¾ªç¯é“¾è¡¨: â€œ);    Show_DupLooplist(mylist);    puts(â€œ\nåå‘éå†æ‰“å°åŒå‘å¾ªç¯é“¾è¡¨: â€œ);    Reverse_DupLooplist(mylist);    printf(â€œ\nâ€);â€‹â€‹ Â  Â puts(â€œåˆ¤æ–­åŒå‘å¾ªç¯é“¾è¡¨æ˜¯å¦å¯¹ç§°: â€œ);    if(IsSymmetry(mylist))        puts(â€œæ­¤åŒå‘å¾ªç¯é“¾è¡¨å¯¹ç§°â€);    else        puts(â€œæ­¤åŒå‘å¾ªç¯é“¾è¡¨ä¸æ˜¯å¯¹ç§°çš„â€);    printf(â€œ\nâ€);â€‹â€‹ Â  Â puts(â€œåœ¨ä½ç½®2æ’å…¥æ–°èŠ‚ç‚¹å: â€œ);    mylist &#x3D; Insert_DupLooplist(mylist, 2, 30);    Show_DupLooplist(mylist);    printf(â€œ\nâ€);â€‹â€‹    puts(â€œåˆ é™¤ä½ç½®2çš„èŠ‚ç‚¹å: â€œ);    mylist &#x3D; Delete_DupLooplist(mylist, 2);    Show_DupLooplist(mylist);    printf(â€œ\nâ€);}c</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŸ¥æ‰¾å…ƒç´ è¿”å›èŠ‚ç‚¹ä½ç½®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Find_Element</span><span class="params">(Linklist *head, <span class="type">int</span> x)</span> &#123;</span><br><span class="line">    Linklist *t = head-&gt;next;</span><br><span class="line">    <span class="keyword">while</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="type">int</span> sub = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (t-&gt;data == x)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å…ƒç´  %d çš„ä½ç½®ä¸º: %d \n&quot;</span>, x, sub);</span><br><span class="line"></span><br><span class="line">t = t-&gt;next;</span><br><span class="line">sub++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (t == <span class="literal">NULL</span>)</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;å…ƒç´ ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯»å–æŒ‡å®šèŠ‚ç‚¹ä½ç½®å…ƒç´ </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Read_position</span><span class="params">(Linklist *head, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    Linklist *t = head-&gt;next;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">t = t-&gt;next;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ç¬¬ %d ä¸ªèŠ‚ç‚¹ä½ç½®çš„æ•°æ®ä¸º: %d \n&quot;</span>, k, t-&gt;data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¡ç®—é“¾è¡¨çš„é•¿åº¦</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">List_length</span><span class="params">(Linklist *head)</span>&#123;</span><br><span class="line">    Linklist *t = head-&gt;next;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(t)&#123;</span><br><span class="line">len++;</span><br><span class="line">        t = t-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;é“¾è¡¨çš„é•¿åº¦ä¸º: %d \n&quot;</span>, len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¸…ç©ºé“¾è¡¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Clear_linklist</span><span class="params">(Linklist *head)</span> &#123;</span><br><span class="line">    Linklist *t;</span><br><span class="line">    <span class="keyword">while</span> (head-&gt;next != <span class="literal">NULL</span>) &#123;</span><br><span class="line">t = head-&gt;next;</span><br><span class="line">head-&gt;next = t-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">IsEmpty</span><span class="params">(Linklist *head)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> head-&gt;next == <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é“¾è¡¨çš„å¥‡å¶é¡¹æ‹†åˆ†"><a href="#é“¾è¡¨çš„å¥‡å¶é¡¹æ‹†åˆ†" class="headerlink" title="é“¾è¡¨çš„å¥‡å¶é¡¹æ‹†åˆ†"></a>é“¾è¡¨çš„å¥‡å¶é¡¹æ‹†åˆ†</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‹†åˆ†é“¾è¡¨ä¸ºä¸¤ä¸ªé“¾è¡¨ å¥‡å¶é¡¹æ‹†åˆ†</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Depart_linklist</span><span class="params">(Linklist *head, Linklist *la, Linklist *lb)</span>&#123;</span><br><span class="line">    Linklist *t = head-&gt;next;</span><br><span class="line">    Linklist *ra = la, *rb = lb;  <span class="comment">//å°¾æŒ‡é’ˆ å°¾æ’æ³•</span></span><br><span class="line">    <span class="keyword">while</span>(t)&#123;</span><br><span class="line">        ra-&gt;next = t;             <span class="comment">//è¡¨a</span></span><br><span class="line">        ra = t;</span><br><span class="line">        t = t-&gt;next;</span><br><span class="line"></span><br><span class="line">        rb-&gt;next = t;             <span class="comment">//è¡¨b</span></span><br><span class="line">        rb = t;</span><br><span class="line">        t = t-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    ra-&gt;next = rb-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å®Œæ•´ç¨‹åº"><a href="#å®Œæ•´ç¨‹åº" class="headerlink" title="å®Œæ•´ç¨‹åº"></a>å®Œæ•´ç¨‹åº</h1><h2 id="å®Œæ•´ç¨‹åºæºä»£ç "><a href="#å®Œæ•´ç¨‹åºæºä»£ç " class="headerlink" title="å®Œæ•´ç¨‹åºæºä»£ç "></a>å®Œæ•´ç¨‹åºæºä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Elemtype;        <span class="comment">//æ•°æ®ç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line"></span><br><span class="line">    Elemtype data;           <span class="comment">//ç»“æ„ä½“æ•°æ®åŸŸ</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">next</span>;</span>       <span class="comment">//ç»“æ„ä½“æŒ‡é’ˆåŸŸ</span></span><br><span class="line"></span><br><span class="line">&#125; Linklist;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é“¾è¡¨çš„åˆå§‹åŒ–</span></span><br><span class="line">Linklist* <span class="title function_">Initial_linklist</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//å‘ç³»ç»Ÿç”³è¯·å†…å­˜</span></span><br><span class="line">    Linklist *head = (Linklist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line">    head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºåˆå§‹é“¾è¡¨  é‡‡ç”¨å°¾æ’æ³•</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Create_linklist</span><span class="params">(Linklist *head, <span class="type">int</span> n)</span> &#123;    <span class="comment">//å¤´èŠ‚ç‚¹(ä¸å¸¦æ•°æ®)</span></span><br><span class="line">    Linklist *node, *end;                        <span class="comment">//æ™®é€šèŠ‚ç‚¹ å°¾èŠ‚ç‚¹</span></span><br><span class="line">    end = head;                                  <span class="comment">//å½“é“¾è¡¨ä¸ºç©ºæ—¶ å¤´å°¾æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åˆ›å»ºé“¾è¡¨è¾“å…¥ %d ä¸ªå…ƒç´ :&quot;</span>, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;                <span class="comment">//nä¸ºæ’å…¥æ™®é€šèŠ‚ç‚¹çš„ä¸ªæ•°</span></span><br><span class="line">node = (Linklist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;node-&gt;data);</span><br><span class="line">end-&gt;next = node;                        <span class="comment">//å½“å‰endçš„nextæŒ‡å‘äº†æ–°èŠ‚ç‚¹node</span></span><br><span class="line">end = node;                              <span class="comment">//endå¾€åç§»ï¼Œæ­¤æ—¶æ–°çš„èŠ‚ç‚¹å˜æˆå°¾èŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    end-&gt;next = <span class="literal">NULL</span>;                            <span class="comment">//endæœ€åç½®NULL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°é“¾è¡¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Show_linklist</span><span class="params">(Linklist *head)</span> &#123;</span><br><span class="line">    Linklist *t = head-&gt;next; <span class="comment">//tä¸ºéå†æŒ‡é’ˆ è®¿é—®æ¯ä¸ªèŠ‚ç‚¹æ•°æ®</span></span><br><span class="line">    <span class="keyword">if</span> (t == <span class="literal">NULL</span>)</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;é“¾è¡¨ä¸ºç©º&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t-&gt;data);</span><br><span class="line">t = t-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤´æ’æ³• æ’å…¥å•ä¸ªæ•°æ®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Insert_Front</span><span class="params">(Linklist *head, <span class="type">int</span> data)</span> &#123;</span><br><span class="line">    Linklist *node = (Linklist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line">    node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    node-&gt;data = data;</span><br><span class="line"></span><br><span class="line">    node-&gt;next = head-&gt;next;      <span class="comment">//æ–°èŠ‚ç‚¹nodeçš„nextæŒ‡å‘å½“å‰headçš„next</span></span><br><span class="line">    head-&gt;next = node;            <span class="comment">//headçš„nexté‡æ–°æŒ‡å‘æ–°èŠ‚ç‚¹node</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°¾æ’æ³• æ’å…¥å•ä¸ªæ•°æ®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Insert_Back</span><span class="params">(Linklist *head, <span class="type">int</span> data)</span> &#123;</span><br><span class="line">    Linklist *node = (Linklist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line">    node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    node-&gt;data = data;</span><br><span class="line"></span><br><span class="line">    Linklist *end = head;         <span class="comment">//èµ·åˆendæŒ‡å‘å¤´èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">while</span> (end-&gt;next != <span class="literal">NULL</span>)</span><br><span class="line">end = end-&gt;next;          <span class="comment">//endæŒ‡é’ˆå¾€åç§»ï¼Œç›´åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    end-&gt;next = node;  <span class="comment">//å½“å‰endçš„nextæŒ‡å‘äº†æ–°èŠ‚ç‚¹node</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡å®šä½ç½®æ’å…¥å•ä¸ªæ•°æ®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Insert_position</span><span class="params">(Linklist *head, <span class="type">int</span> k)</span> &#123; <span class="comment">//kè¡¨ç¤ºåœ¨ç¬¬kä¸ªæ™®é€šèŠ‚ç‚¹çš„ä½ç½®æ’å…¥æ–°èŠ‚ç‚¹</span></span><br><span class="line">    Linklist *t = head, *in;                  <span class="comment">//tä¸ºéå†æŒ‡é’ˆ</span></span><br><span class="line">    <span class="comment">//inæ˜¯è¦æ’å…¥çš„æ–°èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k - <span class="number">1</span>; i++)</span><br><span class="line">t = t-&gt;next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">in = (Linklist *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Linklist));</span><br><span class="line">in-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;åœ¨ç¬¬ %d ä¸ªèŠ‚ç‚¹å¤„æ’å…¥æ–°èŠ‚ç‚¹çš„æ•°æ®: &quot;</span>, k);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;in-&gt;data);</span><br><span class="line">in-&gt;next = t-&gt;next;                  <span class="comment">//æ’å…¥èŠ‚ç‚¹inçš„nextæŒ‡å‘å½“å‰ç¬¬k-1ä¸ªæ™®é€šèŠ‚ç‚¹çš„nextæŒ‡å‘çš„èŠ‚ç‚¹</span></span><br><span class="line">t-&gt;next = in;                        <span class="comment">//ç¬¬k-1ä¸ªæ™®é€šèŠ‚ç‚¹çš„nexté‡æ–°æŒ‡å‘æ’å…¥çš„èŠ‚ç‚¹in</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åŸç†å’Œå¤´æ’æ³•ç±»ä¼¼ å°±å¥½åƒæŠŠç¬¬k-1ä¸ªæ™®é€šèŠ‚ç‚¹tçœ‹åšæ˜¯å¤´èŠ‚ç‚¹</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;èŠ‚ç‚¹ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡å®šä½ç½®æ”¹å˜èŠ‚ç‚¹çš„æ•°æ®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Change_position</span><span class="params">(Linklist *head, <span class="type">int</span> n)</span> &#123; <span class="comment">//nè¡¨ç¤ºè¦æ”¹å˜çš„æ˜¯ç¬¬nä¸ªæ™®é€šèŠ‚ç‚¹</span></span><br><span class="line">    Linklist *t = head;                       <span class="comment">//tä¸ºéå†æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        t = t-&gt;next;                          <span class="comment">//tæŒ‡å‘è¦æ”¹å˜çš„èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ä¿®æ”¹ç¬¬ %d ä¸ªèŠ‚ç‚¹çš„æ•°æ®: &quot;</span>, n);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t-&gt;data);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;èŠ‚ç‚¹ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delete_position</span><span class="params">(Linklist *head, <span class="type">int</span> k)</span> &#123; <span class="comment">//kè¡¨ç¤ºè¦åˆ é™¤ç¬¬kä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    Linklist *t = head, *del = <span class="literal">NULL</span>;          <span class="comment">//tä¸ºéå†æŒ‡é’ˆ</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; k - <span class="number">1</span> &amp;&amp; t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">t = t-&gt;next;                          <span class="comment">//tæŒ‡å‘åˆ é™¤çš„ç¬¬kä¸ªçš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line">del = t-&gt;next;                  </span><br><span class="line">t-&gt;next = del-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(del);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;èŠ‚ç‚¹ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥æ‰¾å…ƒç´ è¿”å›èŠ‚ç‚¹ä½ç½®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Find_Element</span><span class="params">(Linklist *head, <span class="type">int</span> x)</span> &#123;</span><br><span class="line">    Linklist *t = head-&gt;next;</span><br><span class="line">    <span class="keyword">while</span> (t != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="type">int</span> sub = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (t-&gt;data == x)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å…ƒç´  %d çš„ä½ç½®ä¸º: %d \n&quot;</span>, x, sub);</span><br><span class="line"></span><br><span class="line">t = t-&gt;next;</span><br><span class="line">sub++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (t == <span class="literal">NULL</span>)</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;å…ƒç´ ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯»å–æŒ‡å®šèŠ‚ç‚¹ä½ç½®å…ƒç´ </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Read_position</span><span class="params">(Linklist *head, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    Linklist *t = head-&gt;next;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">t = t-&gt;next;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ç¬¬ %d ä¸ªèŠ‚ç‚¹ä½ç½®çš„æ•°æ®ä¸º: %d \n&quot;</span>, k, t-&gt;data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¡ç®—é“¾è¡¨çš„é•¿åº¦</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">List_length</span><span class="params">(Linklist *head)</span>&#123;</span><br><span class="line">    Linklist *t = head-&gt;next;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(t)&#123;</span><br><span class="line">len++;</span><br><span class="line">        t = t-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;é“¾è¡¨çš„é•¿åº¦ä¸º: %d \n&quot;</span>, len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¸…ç©ºé“¾è¡¨</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Clear_linklist</span><span class="params">(Linklist *head)</span> &#123;</span><br><span class="line">    Linklist *t;</span><br><span class="line">    <span class="keyword">while</span> (head-&gt;next != <span class="literal">NULL</span>) &#123;</span><br><span class="line">t = head-&gt;next;</span><br><span class="line">head-&gt;next = t-&gt;next;</span><br><span class="line"><span class="built_in">free</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">IsEmpty</span><span class="params">(Linklist *head)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> head-&gt;next == <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//å¤´æŒ‡é’ˆåˆå§‹åŒ–</span></span><br><span class="line">    Linklist *mylist;</span><br><span class="line">    mylist = Initial_linklist();</span><br><span class="line"></span><br><span class="line">    Create_linklist(mylist, <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åˆå§‹çŠ¶æ€é“¾è¡¨:\n&quot;</span>);</span><br><span class="line">    Show_linklist(mylist);</span><br><span class="line"></span><br><span class="line">    Insert_Front(mylist, <span class="number">30</span>);</span><br><span class="line">    Insert_Back(mylist, <span class="number">30</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;é“¾è¡¨è¿›è¡Œé¦–å°¾æ’å…¥æ•°å­—30å:\n&quot;</span>);</span><br><span class="line">    Show_linklist(mylist);</span><br><span class="line"></span><br><span class="line">    Insert_position(mylist, <span class="number">5</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;é“¾è¡¨è¿›è¡Œåœ¨ç¬¬5ä¸ªèŠ‚ç‚¹åæ’å…¥æ–°èŠ‚ç‚¹å:\n&quot;</span>);</span><br><span class="line">    Show_linklist(mylist);</span><br><span class="line"></span><br><span class="line">    Change_position(mylist, <span class="number">4</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;é“¾è¡¨è¿›è¡Œæ”¹å˜ç¬¬4ä¸ªæ•°æ®å:\n&quot;</span>);</span><br><span class="line">    Show_linklist(mylist);</span><br><span class="line"></span><br><span class="line">    Delete_position(mylist, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;é“¾è¡¨è¿›è¡Œåˆ é™¤ç¬¬1ä¸ªæ•°æ®å:\n&quot;</span>);</span><br><span class="line">    Show_linklist(mylist);</span><br><span class="line"></span><br><span class="line">    Clear_linklist(mylist);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;é“¾è¡¨è¿›è¡Œæ¸…ç©ºå:\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(IsEmpty(mylist))</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;é“¾è¡¨ä¸ºç©º&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¼”ç¤ºç»“æœ"><a href="#æ¼”ç¤ºç»“æœ" class="headerlink" title="æ¼”ç¤ºç»“æœ"></a>æ¼”ç¤ºç»“æœ</h2><p><img src="/../image/637.png" class="lazyload" data-srcset="/../image/637.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="637"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å•å‘é“¾è¡¨&quot;&gt;&lt;a href=&quot;#å•å‘é“¾è¡¨&quot; class=&quot;headerlink&quot; title=&quot;å•å‘é“¾è¡¨&quot;&gt;&lt;/a&gt;å•å‘é“¾è¡¨&lt;/h1&gt;&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯å•å‘é“¾è¡¨&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯å•å‘é“¾è¡¨&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯</summary>
      
    
    
    
    <category term="æ•°æ®ç»“æ„" scheme="http://example.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
    <category term="å­¦ä¹ " scheme="http://example.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Windowså†…æ ¸é©±åŠ¨å­¦ä¹ (å››)</title>
    <link href="http://example.com/2024/04/10/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E5%9B%9B)/"/>
    <id>http://example.com/2024/04/10/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E5%9B%9B)/</id>
    <published>2024-04-09T16:00:00.000Z</published>
    <updated>2024-04-13T05:17:43.516Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é‡Œç¬”è€…ç”¨çš„ç³»ç»Ÿä¸ºWin10ï¼Œvirtual studio2019</p><h2 id="é…ç½®é©±åŠ¨å¼€å‘ç¯å¢ƒ"><a href="#é…ç½®é©±åŠ¨å¼€å‘ç¯å¢ƒ" class="headerlink" title="é…ç½®é©±åŠ¨å¼€å‘ç¯å¢ƒ"></a>é…ç½®é©±åŠ¨å¼€å‘ç¯å¢ƒ</h2><p>è¿™é‡Œå‚è€ƒå®˜æ–¹æ–‡æ¡£<a href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/download-the-wdk">https://learn.microsoft.com/zh-cn/windows-hardware/drivers/download-the-wdk</a></p><p>ç¬”è€…å»ºè®®ä¸‹è½½virtual studio2019(æ¯”è¾ƒç¨³å®š)+SDK10.0.22000.0,è¿˜æœ‰ä¸€ä¸ªåŸå› å°±æ˜¯ç”Ÿæˆçš„é©±åŠ¨åœ¨win7ï¼Œwin10ï¼Œwin11éƒ½èƒ½ä½¿ç”¨ </p><p>ç„¶åä¸‹è½½çš„WDKè¦è·ŸSDKå¯¹åº”</p><h2 id="ç¬¬ä¸€ä¸ªé©±åŠ¨"><a href="#ç¬¬ä¸€ä¸ªé©±åŠ¨" class="headerlink" title="ç¬¬ä¸€ä¸ªé©±åŠ¨"></a>ç¬¬ä¸€ä¸ªé©±åŠ¨</h2><p><img src="/../image/617.png" class="lazyload" data-srcset="/../image/617.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="617"></p><p>æˆ‘ä»¬å¯ä»¥ç‚¹å‡»PDRIVER_OBJECT ç„¶åF12çœ‹å®ƒçš„ç»“æ„</p><p><img src="/../image/618.png" class="lazyload" data-srcset="/../image/618.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="618"></p><p>è¿™é‡Œçš„åˆ†åˆ«å°±æ˜¯é©±åŠ¨çš„ä¸€äº›é…ç½®</p><p>æˆ‘ä»¬æŠŠç”Ÿæˆçš„sysæ–‡ä»¶æ‹–å…¥åˆ°è™šæ‹Ÿæœºä¸­è¿›è¡ŒåŒæœºè°ƒè¯•</p><p><img src="/../image/619.png" class="lazyload" data-srcset="/../image/619.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="619"></p><p>è¿™é‡Œç¬”è€…ç”¨çš„æ˜¯IDA7.7</p><p><img src="/../image/620.png" class="lazyload" data-srcset="/../image/620.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="620"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæ˜¯å…ˆè°ƒç”¨äº†è¿™ä¸ªcookieæ£€æŸ¥ï¼Œç„¶åæ‰è·³åˆ°çœŸæ­£çš„DriverEntryå¤„</p><p><img src="/../image/621.png" class="lazyload" data-srcset="/../image/621.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="621"></p><p>ç„¶åæˆ‘ä»¬dt pReg</p><p><img src="/../image/622.png" class="lazyload" data-srcset="/../image/622.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="622"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯„å­˜å™¨å®‰è£…çš„ä½ç½®</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬åœ¨è™šæ‹Ÿæœºä¸Šçœ‹ä¸€ä¸‹æ³¨å†Œè¡¨ç¼–è¾‘å™¨</p><p><img src="/../image/623.png" class="lazyload" data-srcset="/../image/623.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="623"></p><p>æˆ‘ä»¬å‘ç°è¿™ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\??\C:\Users\Administrator\Desktop\MyDriver1.sys   ä¸ºä»€ä¹ˆå‰é¢æœ‰ä¸¤ä¸ªé—®å·ï¼Œè¿™ä¸ªè¡¨ç¤ºæ ¹ï¼Œåé¢æ‰è¡¨ç¤ºç›˜ç¬¦</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°<strong>Start</strong>åé¢çš„æ•°æ®ä¸º3</p><p>åœ¨è¿™é‡Œå…¶å®æœ‰5ç§æ•°å­— 0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0.  ä»£è¡¨è¿›å…¥biosä¹‹åç«‹é©¬å¯åŠ¨ï¼ˆè‡ªå¯ç”¨ï¼‰</span><br><span class="line">1.  å¯åŠ¨äº†biosç³»ç»Ÿä¹‹åå†å¯åŠ¨</span><br><span class="line">2.  ç­‰winlogon.exeè¿›ç¨‹å¯åŠ¨ä¹‹åå†è‡ªå¯åŠ¨</span><br><span class="line">3.  æ‰‹åŠ¨å¯åŠ¨</span><br><span class="line">4.  ç¦æ­¢å¯åŠ¨</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™é‡Œç¬”è€…ç”¨çš„ç³»ç»Ÿä¸ºWin10ï¼Œvirtual studio2019&lt;/p&gt;
&lt;h2 id=&quot;é…ç½®é©±åŠ¨å¼€å‘ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#é…ç½®é©±åŠ¨å¼€å‘ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;é…ç½®é©±åŠ¨å¼€å‘ç¯å¢ƒ&quot;&gt;&lt;/a&gt;é…ç½®é©±åŠ¨å¼€å‘ç¯å¢ƒ&lt;/h2&gt;&lt;p&gt;è¿™é‡Œå‚è€ƒå®˜</summary>
      
    
    
    
    <category term="å†…æ ¸é©±åŠ¨" scheme="http://example.com/categories/%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8/"/>
    
    
    <category term="Windowså†…æ ¸é©±åŠ¨å¼€å‘" scheme="http://example.com/tags/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>2024é•¿åŸæ¯-ez_driverå¤ç°ä¸æ€è€ƒ</title>
    <link href="http://example.com/2024/04/09/2024%E9%95%BF%E5%9F%8E%E6%9D%AF-ez_driver%E5%A4%8D%E7%8E%B0%E4%B8%8E%E6%80%9D%E8%80%83/"/>
    <id>http://example.com/2024/04/09/2024%E9%95%BF%E5%9F%8E%E6%9D%AF-ez_driver%E5%A4%8D%E7%8E%B0%E4%B8%8E%E6%80%9D%E8%80%83/</id>
    <published>2024-04-08T16:00:00.000Z</published>
    <updated>2024-04-09T16:13:48.256Z</updated>
    
    <content type="html"><![CDATA[<p>å½“æ—¶è¿™é“é¢˜åœ¨æ¯”èµ›çš„æ—¶å€™ï¼Œå› ä¸ºè‡ªå·±å¯¹cè¯­è¨€çš„å­¦è‰ºä¸ç²¾ï¼Œæ²¡æœ‰è§£å‡ºæ¥<br>è¿™æ˜¯é“é©±åŠ¨é€†å‘é¢˜ï¼Œä½†æ˜¯æœ€ç®€å•çš„æ–¹æ³•ç”¨ä¸åˆ°åŠ¨è°ƒ</p><p>ä»¥ä¸‹æ˜¯ä¸»è¦åŠ å¯†ç¨‹åº</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_140001110</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+20h] [rbp-B8h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+28h] [rbp-B0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+2Ch] [rbp-ACh]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+30h] [rbp-A8h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+34h] [rbp-A4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [rsp+38h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+3Ch] [rbp-9Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+40h] [rbp-98h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// [rsp+44h] [rbp-94h]</span></span><br><span class="line">  PCSTR Format; <span class="comment">// [rsp+48h] [rbp-90h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+50h] [rbp-88h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+54h] [rbp-84h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v15; <span class="comment">// [rsp+58h] [rbp-80h]</span></span><br><span class="line">  _DWORD *v16; <span class="comment">// [rsp+60h] [rbp-78h]</span></span><br><span class="line">  <span class="type">char</span> *v17; <span class="comment">// [rsp+68h] [rbp-70h]</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// [rsp+70h] [rbp-68h]</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// [rsp+74h] [rbp-64h]</span></span><br><span class="line">  PCSTR v20; <span class="comment">// [rsp+78h] [rbp-60h]</span></span><br><span class="line">  <span class="type">int</span> v21[<span class="number">4</span>]; <span class="comment">// [rsp+80h] [rbp-58h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v22[<span class="number">40</span>]; <span class="comment">// [rsp+90h] [rbp-48h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v16 = (_DWORD *)<span class="built_in">sub_140001890</span>(a2);</span><br><span class="line">  v13 = v16[<span class="number">6</span>];</span><br><span class="line">  Format = *(PCSTR *)(a2 + <span class="number">24</span>);</span><br><span class="line">  v11 = v16[<span class="number">4</span>];</span><br><span class="line">  v18 = v16[<span class="number">2</span>];</span><br><span class="line">  v10 = v13;</span><br><span class="line">  <span class="keyword">if</span> ( v13 == <span class="number">0x222000</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">DbgPrint</span>(&amp;byte_140001F80);</span><br><span class="line">    <span class="built_in">memset</span>(v22, <span class="number">0</span>, <span class="built_in">sizeof</span>(v22));</span><br><span class="line">    v20 = Format;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v11; ++i )</span><br><span class="line">      v22[i] = v20[i];</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j += <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">      v5 = <span class="number">0</span>;</span><br><span class="line">      v4 = (<span class="type">unsigned</span> __int8)v22[j] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">      v4 += (<span class="type">unsigned</span> __int8)v22[j + <span class="number">1</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">      v4 += (<span class="type">unsigned</span> __int8)v22[j + <span class="number">2</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">      v4 += (<span class="type">unsigned</span> __int8)v22[j + <span class="number">3</span>];</span><br><span class="line">      v5 = (<span class="type">unsigned</span> __int8)v22[j + <span class="number">4</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line">      v5 += (<span class="type">unsigned</span> __int8)v22[j + <span class="number">5</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">      v5 += (<span class="type">unsigned</span> __int8)v22[j + <span class="number">6</span>] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">      v5 += (<span class="type">unsigned</span> __int8)v22[j + <span class="number">7</span>];</span><br><span class="line">      v21[<span class="number">0</span>] = <span class="number">6699</span>;</span><br><span class="line">      v21[<span class="number">1</span>] = <span class="number">14925</span>;</span><br><span class="line">      v21[<span class="number">2</span>] = <span class="number">24175</span>;</span><br><span class="line">      v21[<span class="number">3</span>] = <span class="number">43571</span>;</span><br><span class="line">      v19 = <span class="number">2</span>;</span><br><span class="line">      v14 = <span class="number">33</span>;</span><br><span class="line">      <span class="built_in">xtea</span>(<span class="number">33</span>i64, &amp;v4, v21);</span><br><span class="line">      v22[j] = <span class="built_in">HIBYTE</span>(v4);</span><br><span class="line">      v22[j + <span class="number">1</span>] = <span class="built_in">BYTE2</span>(v4);</span><br><span class="line">      v22[j + <span class="number">2</span>] = <span class="built_in">BYTE1</span>(v4);</span><br><span class="line">      v22[j + <span class="number">3</span>] = v4;</span><br><span class="line">      v22[j + <span class="number">4</span>] = <span class="built_in">HIBYTE</span>(v5);</span><br><span class="line">      v22[j + <span class="number">5</span>] = <span class="built_in">BYTE2</span>(v5);</span><br><span class="line">      v22[j + <span class="number">6</span>] = <span class="built_in">BYTE1</span>(v5);</span><br><span class="line">      v22[j + <span class="number">7</span>] = v5;</span><br><span class="line">    &#125;</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    v17 = v22;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v15 = v8;</span><br><span class="line">      <span class="built_in">sub_140001A70</span>(v17, v8++);</span><br><span class="line">      v17 += <span class="number">16</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( (<span class="type">int</span>)v8 &lt; <span class="number">2</span> );</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">32</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v22[k] == byte_140004000[k] )</span><br><span class="line">        ++v9;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">DbgPrint</span>(&amp;byte_140001F90);</span><br><span class="line">    <span class="keyword">if</span> ( v9 == <span class="number">32</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">strcpy</span>((<span class="type">char</span> *)Format, <span class="string">&quot;flag is you input&quot;</span>);</span><br><span class="line">      *(_QWORD *)(a2 + <span class="number">56</span>) = <span class="number">18</span>i64;</span><br><span class="line">      <span class="built_in">DbgPrint</span>(&amp;byte_140001FC0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">strcpy</span>((<span class="type">char</span> *)Format, <span class="string">&quot;wrong&quot;</span>);</span><br><span class="line">      *(_QWORD *)(a2 + <span class="number">56</span>) = <span class="number">6</span>i64;</span><br><span class="line">      <span class="built_in">DbgPrint</span>(&amp;byte_140001FE0);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v10 != <span class="number">2237440</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">DbgPrint</span>(aIrpdevicecontr, v11);</span><br><span class="line">  <span class="built_in">DbgPrint</span>(<span class="string">&quot;CODE_WRITE %X\n&quot;</span>, <span class="number">2237440</span>i64);</span><br><span class="line">  <span class="built_in">DbgPrint</span>(Format);</span><br><span class="line">  *(_QWORD *)(a2 + <span class="number">56</span>) = <span class="number">0</span>i64;</span><br><span class="line">LABEL_21:</span><br><span class="line">  *(_QWORD *)(a2 + <span class="number">56</span>) = <span class="number">65</span>i64;</span><br><span class="line">  <span class="built_in">IofCompleteRequest</span>((PIRP)a2, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>sub_140001A70</strong>å‡½æ•°å¦‚ä¸‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __fastcall <span class="title">sub_140001A70</span><span class="params">(_DWORD *a1, <span class="type">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+4h] [rbp-44h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-40h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-3Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> *v5; <span class="comment">// [rsp+10h] [rbp-38h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+18h] [rbp-30h]</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-28h]</span></span><br><span class="line"></span><br><span class="line">  v7[<span class="number">1</span>] = a2 ^ <span class="number">0x25</span>;</span><br><span class="line">  v7[<span class="number">0</span>] = a2 ^ <span class="number">0x7A</span>;</span><br><span class="line">  v7[<span class="number">8</span>] = a2 ^ <span class="number">0x1A</span>;</span><br><span class="line">  v7[<span class="number">2</span>] = a2 ^ <span class="number">0x35</span>;</span><br><span class="line">  v7[<span class="number">9</span>] = a2 ^ <span class="number">0x6D</span>;</span><br><span class="line">  v7[<span class="number">3</span>] = a2 ^ <span class="number">0x23</span>;</span><br><span class="line">  v7[<span class="number">11</span>] = a2 ^ <span class="number">0x94</span>;</span><br><span class="line">  v7[<span class="number">4</span>] = a2 ^ <span class="number">0xC5</span>;</span><br><span class="line">  v7[<span class="number">5</span>] = a2 ^ <span class="number">0x4B</span>;</span><br><span class="line">  v7[<span class="number">6</span>] = a2 ^ <span class="number">0x21</span>;</span><br><span class="line">  v7[<span class="number">7</span>] = a2 ^ <span class="number">0x35</span>;</span><br><span class="line">  v7[<span class="number">10</span>] = a2 ^ <span class="number">0x91</span>;</span><br><span class="line">  v7[<span class="number">12</span>] = a2 ^ <span class="number">0x2C</span>;</span><br><span class="line">  v7[<span class="number">13</span>] = a2 ^ <span class="number">0xC1</span>;</span><br><span class="line">  v7[<span class="number">14</span>] = a2 ^ <span class="number">0x92</span>;</span><br><span class="line">  v7[<span class="number">15</span>] = a2 ^ <span class="number">0x51</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = &amp;v4;</span><br><span class="line">    v4 = *a1 ^ a2;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (<span class="type">int</span> *)((<span class="type">char</span> *)v5 + <span class="number">1</span>);</span><br><span class="line">      *((_BYTE *)v5 - <span class="number">1</span>) ^= v7[<span class="number">15</span> - (((<span class="type">unsigned</span> __int8)i + (<span class="type">unsigned</span> __int8)j) &amp; <span class="number">0xF</span>)] | ((<span class="type">unsigned</span> __int8)j &lt;&lt; j) | j | <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v6 = ~a2 ^ v4;</span><br><span class="line">    *a1++ = v6;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®è‡ªå·±ä¸»è¦æ˜¯æ ½å€’åˆ°äº†ç±»å‹è½¬æ¢ï¼Œè¿˜æœ‰æŒ‡é’ˆè¿ç”¨çš„é—®é¢˜</p><p>æ ¹æ®ä»¥ä¸ŠåŠ å¯†ç¨‹åºå†™å‡ºè§£å¯†exp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">func1</span><span class="params">(<span class="type">uint32_t</span>* p, <span class="type">char</span>* res, <span class="type">int</span> k)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">res[k + j + <span class="number">4</span> * i] = (p[i] &gt;&gt; (<span class="number">8</span> * j)) &amp; <span class="number">0xff</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">char_to_uint</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *p,<span class="type">int</span> k,<span class="type">int</span> i)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> res = p[k + <span class="number">4</span> * i] | p[k + <span class="number">1</span> + <span class="number">4</span> * i] &lt;&lt; <span class="number">8</span> | p[k + <span class="number">2</span> + <span class="number">4</span> * i] &lt;&lt; <span class="number">16</span> | p[k + <span class="number">3</span> + <span class="number">4</span> * i] &lt;&lt; <span class="number">24</span>;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">swap</span><span class="params">(<span class="type">uint32_t</span> num)</span> &#123;</span><br><span class="line">num = (num &amp; <span class="number">0xff</span>) &lt;&lt; <span class="number">24</span> | ((num &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>) &lt;&lt; <span class="number">16</span> | ((num &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>) &lt;&lt; <span class="number">8</span> | ((num &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>);</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">char_to_uint32</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* p, <span class="type">int</span> k)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> result = p[k]|p[k+<span class="number">1</span>]&lt;&lt;<span class="number">8</span> | p[k + <span class="number">2</span>] &lt;&lt; <span class="number">16</span>| p[k + <span class="number">3</span>] &lt;&lt; <span class="number">24</span>;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> rounds, <span class="type">uint32_t</span> * a2, <span class="type">uint32_t</span>* a3)</span> &#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> sum, v0, v1, i;</span><br><span class="line"></span><br><span class="line">v0 = a2[<span class="number">0</span>];</span><br><span class="line">v1 = a2[<span class="number">1</span>];</span><br><span class="line">sum = <span class="number">1697034457</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; rounds; ++i) &#123;</span><br><span class="line">v1 -= (a3[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + sum) ^ (v0 + ((v0 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v0)));</span><br><span class="line">sum += <span class="number">1640531527</span>;</span><br><span class="line">v0 -= (a3[sum &amp; <span class="number">3</span>] + sum) ^ (v1 + ((v1 &gt;&gt; <span class="number">6</span>) ^ (<span class="number">16</span> * v1)));</span><br><span class="line">&#125;</span><br><span class="line">a2[<span class="number">0</span>] = v0;</span><br><span class="line">a2[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">func</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *flag, <span class="type">int</span> k, <span class="type">int</span> i)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> v7[<span class="number">16</span>];</span><br><span class="line">v7[<span class="number">1</span>] = i ^ <span class="number">0x25</span>;</span><br><span class="line">v7[<span class="number">0</span>] = i ^ <span class="number">0x7a</span>;</span><br><span class="line">v7[<span class="number">8</span>] = i ^ <span class="number">0x1a</span>;</span><br><span class="line">v7[<span class="number">2</span>] = i ^ <span class="number">0x35</span>;</span><br><span class="line">v7[<span class="number">9</span>] = i ^ <span class="number">0x6d</span>;</span><br><span class="line">v7[<span class="number">3</span>] = i ^ <span class="number">0x23</span>;</span><br><span class="line">v7[<span class="number">11</span>] = i ^ <span class="number">0x94</span>;</span><br><span class="line">v7[<span class="number">4</span>] = i ^ <span class="number">0xc5</span>;</span><br><span class="line">v7[<span class="number">5</span>] = i ^ <span class="number">0x4b</span>;</span><br><span class="line">v7[<span class="number">6</span>] = i ^ <span class="number">0x21</span>;</span><br><span class="line">v7[<span class="number">7</span>] = i ^ <span class="number">0x35</span>;</span><br><span class="line">v7[<span class="number">10</span>] = i ^ <span class="number">0x91</span>;</span><br><span class="line">v7[<span class="number">12</span>] = i ^ <span class="number">0x2c</span>;</span><br><span class="line">v7[<span class="number">13</span>] = i ^ <span class="number">0xc1</span>;</span><br><span class="line">v7[<span class="number">14</span>] = i ^ <span class="number">0x92</span>;</span><br><span class="line">v7[<span class="number">15</span>] = i ^ <span class="number">0x51</span>;</span><br><span class="line"><span class="keyword">for</span> ( <span class="type">int</span> z= <span class="number">0</span>; z &lt; <span class="number">4</span>; z++) </span><br><span class="line">&#123;</span><br><span class="line">flag[k + <span class="number">4</span> * z] ^= i;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> sum = v7[<span class="number">15</span> - ((z + j) &amp; <span class="number">0xf</span>)] |(j &lt;&lt; j) | j | <span class="number">4</span>;</span><br><span class="line">flag[k + <span class="number">4</span> * z + j] ^= sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v6 = char_to_uint32(flag, k + <span class="number">4</span> * z);</span><br><span class="line">v6 ^= (~i) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> e = <span class="number">0</span>; e &lt; <span class="number">4</span>; e++)</span><br><span class="line">&#123;</span><br><span class="line">flag[k + <span class="number">4</span> * z + e] = (v6 &gt;&gt; (<span class="number">8</span> * e)) &amp; <span class="number">0xff</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">32</span>] = &#123; <span class="number">0x72</span>, <span class="number">0x62</span>, <span class="number">0xae</span>, <span class="number">0x34</span>, <span class="number">0x52</span>, <span class="number">0x9a</span>, <span class="number">0x06</span>, <span class="number">0xaf</span>, <span class="number">0x72</span>, <span class="number">0xfb</span>, <span class="number">0x40</span>, <span class="number">0xc0</span>, <span class="number">0x10</span>, <span class="number">0x35</span>, <span class="number">0xbd</span>, <span class="number">0xd4</span>, <span class="number">0x22</span>, <span class="number">0xa5</span>, <span class="number">0x93</span>, <span class="number">0x07</span>, <span class="number">0xb4</span>, <span class="number">0xfb</span>, <span class="number">0xb5</span>, <span class="number">0xca</span>, <span class="number">0xe8</span>, <span class="number">0x01</span>, <span class="number">0xf5</span>, <span class="number">0xae</span>, <span class="number">0xed</span>, <span class="number">0x7b</span>, <span class="number">0xb8</span>, <span class="number">0x6a</span> &#125;;<span class="type">uint32_t</span> k[<span class="number">4</span>] = &#123; <span class="number">0x1a2b</span>, <span class="number">0x3a4d</span>, <span class="number">0x5e6f</span>, <span class="number">0xaa33</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">func(flag, i * <span class="number">16</span>, i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">8</span>) &#123;</span><br><span class="line"><span class="type">uint32_t</span> p[<span class="number">2</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">p[<span class="number">0</span>] = char_to_uint(flag, i, <span class="number">0</span>);</span><br><span class="line">p[<span class="number">1</span>] = char_to_uint(flag, i, <span class="number">1</span>);</span><br><span class="line">p[<span class="number">0</span>] = swap(p[<span class="number">0</span>]);</span><br><span class="line">p[<span class="number">1</span>] = swap(p[<span class="number">1</span>]);</span><br><span class="line">decrypt(<span class="number">33</span>, p, k);</span><br><span class="line">p[<span class="number">0</span>] = swap(p[<span class="number">0</span>]);</span><br><span class="line">p[<span class="number">1</span>] = swap(p[<span class="number">1</span>]);</span><br><span class="line">func1(p, flag, i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, flag[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ä¸€ä¸‹è‡ªå·±çš„é—®é¢˜å§ï¼Œå¯¹äºç±»å‹è½¬æ¢å’ŒæŒ‡é’ˆæŒæ¡çš„ä¸æ˜¯é‚£ä¹ˆç†Ÿ</p><p>è¿™å‡ å¤©ä¸€ç›´åœ¨å¼„åŠ¨è°ƒçš„é—®é¢˜ï¼Œæ²¡æœ‰é™ä¸‹å¿ƒæ¥é™æ€åˆ†æï¼Œæ¥ä¸‹æ¥å°±æ˜¯åŠ¨æ€è°ƒè¯•è¿™ä¸ªé©±åŠ¨</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å½“æ—¶è¿™é“é¢˜åœ¨æ¯”èµ›çš„æ—¶å€™ï¼Œå› ä¸ºè‡ªå·±å¯¹cè¯­è¨€çš„å­¦è‰ºä¸ç²¾ï¼Œæ²¡æœ‰è§£å‡ºæ¥&lt;br&gt;è¿™æ˜¯é“é©±åŠ¨é€†å‘é¢˜ï¼Œä½†æ˜¯æœ€ç®€å•çš„æ–¹æ³•ç”¨ä¸åˆ°åŠ¨è°ƒ&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸»è¦åŠ å¯†ç¨‹åº&lt;/p&gt;
&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter</summary>
      
    
    
    
    <category term="é©±åŠ¨é€†å‘" scheme="http://example.com/categories/%E9%A9%B1%E5%8A%A8%E9%80%86%E5%90%91/"/>
    
    
    <category term="ctfå­¦ä¹ " scheme="http://example.com/tags/ctf%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æ—¥è®°(20)</title>
    <link href="http://example.com/2024/04/08/%E6%97%A5%E8%AE%B0(20)/"/>
    <id>http://example.com/2024/04/08/%E6%97%A5%E8%AE%B0(20)/</id>
    <published>2024-04-07T16:00:00.000Z</published>
    <updated>2024-04-08T14:24:05.727Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰ä¸€æ®µæ—¶é—´æ²¡æœ‰æ›´æ–°æ—¥è®°äº†ï¼Œæ—¥è®°è¿™ä¸ªå¥½ä¹ æƒ¯è¿˜æ˜¯è¦ç»§ç»­åšæŒçš„<br>è¿‘æœŸé‡åˆ°çš„éº»çƒ¦<br>å¦‚ä½•åŠ¨è°ƒsysï¼ˆé•¿åŸæ¯-ez_driverï¼‰è¿™é“é¢˜<br>æ€»ç»“ä¸€ä¸‹é‡Œé¢éœ€è¦ç”¨åˆ°çš„çŸ¥è¯†å§</p><ul><li>IRPè¯·æ±‚</li><li>å†…æ ¸é€šä¿¡</li></ul><p>è¿˜æ˜¯è¦å­¦ä¹ ä¸€ä¸‹å…³äºå†…æ ¸çš„ä¸€äº›çŸ¥è¯†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¿‘æœŸçš„ä»»åŠ¡</span><br><span class="line">1.windowså†…æ ¸é©±åŠ¨å­¦ä¹ </span><br><span class="line">2.ç»§ç»­å­¦ä¹ ollvmæ··æ·†</span><br><span class="line">3.ç ”ç©¶upxæºç </span><br><span class="line">4.ç©¿æ’ç€ç»ƒé¢˜</span><br><span class="line">2-4æ¡éƒ½æ˜¯ç©¿æ’æ¥</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ‰ä¸€æ®µæ—¶é—´æ²¡æœ‰æ›´æ–°æ—¥è®°äº†ï¼Œæ—¥è®°è¿™ä¸ªå¥½ä¹ æƒ¯è¿˜æ˜¯è¦ç»§ç»­åšæŒçš„&lt;br&gt;è¿‘æœŸé‡åˆ°çš„éº»çƒ¦&lt;br&gt;å¦‚ä½•åŠ¨è°ƒsysï¼ˆé•¿åŸæ¯-ez_driverï¼‰è¿™é“é¢˜&lt;br&gt;æ€»ç»“ä¸€ä¸‹é‡Œé¢éœ€è¦ç”¨åˆ°çš„çŸ¥è¯†å§&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IRPè¯·æ±‚&lt;/li&gt;
&lt;li&gt;å†…æ ¸é€šä¿¡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿˜æ˜¯è¦</summary>
      
    
    
    
    <category term="æ—¥è®°" scheme="http://example.com/categories/%E6%97%A5%E8%AE%B0/"/>
    
    
    <category term="å­¦ä¹ " scheme="http://example.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Windowså†…æ ¸é©±åŠ¨å­¦ä¹ (ä¸‰)</title>
    <link href="http://example.com/2024/04/03/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%B8%89)/"/>
    <id>http://example.com/2024/04/03/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%B8%89)/</id>
    <published>2024-04-02T16:00:00.000Z</published>
    <updated>2024-04-13T05:17:35.989Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸€èŠ‚è®²è¿°çš„æ˜¯å¦‚ä½•æ–­åœ¨DriverEntryå¤„</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ä¸€èŠ‚è®²è¿°çš„æ˜¯å¦‚ä½•æ–­åœ¨DriverEntryå¤„&lt;/p&gt;
</summary>
      
    
    
    
    <category term="å†…æ ¸é©±åŠ¨" scheme="http://example.com/categories/%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8/"/>
    
    
    <category term="Windowså†…æ ¸é©±åŠ¨å¼€å‘" scheme="http://example.com/tags/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Windowså†…æ ¸é©±åŠ¨å­¦ä¹ (äºŒ)</title>
    <link href="http://example.com/2024/04/02/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/"/>
    <id>http://example.com/2024/04/02/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/</id>
    <published>2024-04-01T16:00:00.000Z</published>
    <updated>2024-04-13T05:17:22.144Z</updated>
    
    <content type="html"><![CDATA[<p>ç”±äºä½œè€…æœ¬äººç¬¬ä¸€æ¬¡å­¦ä¹ å†…æ ¸é©±åŠ¨ï¼Œä¸è¶³ä¹‹å¤„ï¼Œæœ›å„ä½å¸ˆå‚…å¤šå¤šæŒ‡å‡º</p><p>è¿™ä¸€èŠ‚ä¸»è¦æ˜¯åœ¨é…ç½®ç¯å¢ƒä¸­é‡åˆ°çš„é—®é¢˜ä»¥åŠè§£å†³åŠæ³•</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ç”±äºä½œè€…æœ¬äººç¬¬ä¸€æ¬¡å­¦ä¹ å†…æ ¸é©±åŠ¨ï¼Œä¸è¶³ä¹‹å¤„ï¼Œæœ›å„ä½å¸ˆå‚…å¤šå¤šæŒ‡å‡º&lt;/p&gt;
&lt;p&gt;è¿™ä¸€èŠ‚ä¸»è¦æ˜¯åœ¨é…ç½®ç¯å¢ƒä¸­é‡åˆ°çš„é—®é¢˜ä»¥åŠè§£å†³åŠæ³•&lt;/p&gt;
</summary>
      
    
    
    
    <category term="å†…æ ¸é©±åŠ¨" scheme="http://example.com/categories/%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8/"/>
    
    
    <category term="Windowså†…æ ¸é©±åŠ¨å¼€å‘" scheme="http://example.com/tags/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Windowså†…æ ¸é©±åŠ¨å­¦ä¹ (ä¸€)</title>
    <link href="http://example.com/2024/04/01/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%B8%80)/"/>
    <id>http://example.com/2024/04/01/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%AD%A6%E4%B9%A0(%E4%B8%80)/</id>
    <published>2024-03-31T16:00:00.000Z</published>
    <updated>2024-04-13T05:17:53.465Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸€èŠ‚ä¸»è¦è®²è¿°å¦‚ä½•é…ç½®ç¯å¢ƒ</p><h2 id="é…ç½®ç¯å¢ƒ"><a href="#é…ç½®ç¯å¢ƒ" class="headerlink" title="é…ç½®ç¯å¢ƒ"></a>é…ç½®ç¯å¢ƒ</h2><h3 id="ä¸€-windbgåŒæœºè°ƒè¯•å†…æ ¸é©±åŠ¨"><a href="#ä¸€-windbgåŒæœºè°ƒè¯•å†…æ ¸é©±åŠ¨" class="headerlink" title="ä¸€.windbgåŒæœºè°ƒè¯•å†…æ ¸é©±åŠ¨"></a>ä¸€.windbgåŒæœºè°ƒè¯•å†…æ ¸é©±åŠ¨</h3><p>é¦–å…ˆè¦å‡†å¤‡çš„å·¥å…·:windbg,è™šæ‹Ÿæœºï¼Œwin7ç³»ç»Ÿ(è¿™é‡Œæˆ‘ç”¨çš„64ä½ç³»ç»Ÿæ¼”ç¤º)</p><p>1.æ‰“å¼€è™šæ‹Ÿæœºè®¾ç½®ï¼Œè®¾ç½®ä¸²æµç«¯å£ï¼Œå¦‚æœæœ‰æ‰“å°æœºè¿™ä¸ªç¡¬ä»¶è¦å…ˆåˆ å»</p><p><img src="/../image/612.png" class="lazyload" data-srcset="/../image/612.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="612"></p><p>æŒ‰ä¸Šå›¾è¿›è¡Œé…ç½®</p><p>2.è™šæ‹Ÿæœºä¸Šçš„é…ç½®</p><p>ç”±äºç¬”è€…ç”¨çš„æ˜¯win7ç³»ç»Ÿï¼Œè¿™é‡Œé€‰æ‹©win7è¿›è¡Œæ¼”ç¤ºï¼Œå¼€æœºè¿›å…¥æ¡Œé¢åï¼Œåœ¨è¿è¡Œçª—å£è¾“å…¥ msconfig â€“&gt; å¼•å¯¼ â€“&gt; é«˜çº§é€‰é¡¹ â€“&gt; è°ƒè¯• â€“&gt; ç¡®å®šã€‚</p><p><img src="/../image/613.png" class="lazyload" data-srcset="/../image/613.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="613"></p><p>ä¹‹åè¿˜æœ‰ä¸€ä¸ªè®¾ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cdedit</span><br><span class="line"></span><br><span class="line">bcdedit /copy &#123;current&#125; /d debug</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bcdedit /displayorder &#123;ä¸Šé¢å‡ºç°çš„æ•°å­—&#125; /addlast</span><br><span class="line"></span><br><span class="line">bcdedit /dbgsettings SERIAL DEBUGPORT:1 BAUDRATE:115200</span><br><span class="line"></span><br><span class="line"> bcdedit /bootdebug &#123;åŒä¸Š&#125; ON</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bcdedit /debug &#123;åŒä¸Š&#125; ON</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è™šæ‹Ÿæœºåˆ°æ­¤æˆ‘ä»¬ä¹Ÿå°±è®¾ç½®å®Œæˆ</p><p>æ¥ä¸‹æ¥å°±æ˜¯çœŸæœº</p><p>æ‰“å¼€windbgï¼ŒFile-kernel debug</p><p><img src="/../image/614.png" class="lazyload" data-srcset="/../image/614.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="614"></p><p>å†æ¬¡æ‰“å¼€è™šæ‹Ÿæœº</p><p><img src="/../image/615.png" class="lazyload" data-srcset="/../image/615.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="615"></p><p>ç„¶åç‚¹enterä¹‹åï¼Œè¿…é€Ÿå›åˆ°ä¸»æœºä¸Šï¼Œä»¥ç®¡ç†å‘˜æ–¹å¼æ‰“å¼€windbgï¼Œè¿™æ ·æ‰ä¼šåŠ è½½</p><p><img src="/../image/616.png" class="lazyload" data-srcset="/../image/616.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="616"></p><p>è®©æˆ‘ä»¬ç‚¹gè®©ä»–è¿è¡Œèµ·æ¥,ç„¶åç‚¹breakè®©ä»–åœä¸‹æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bu [åŠ è½½çš„é©±åŠ¨]+driverentry</span><br><span class="line">//ä¸€å®šè¦æ˜¯åœ¨é©±åŠ¨å…¥å£å¤„ä¸‹æ–­ç‚¹ï¼Œä¸ç„¶æ–­ä¸ä¸‹æ¥</span><br></pre></td></tr></table></figure><p>ä¹‹åå°±å¯ä»¥è¿›è¡Œè°ƒè¯•äº†</p><p>ç¬¦å·è¡¨ä¸‹è½½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.sympath SRV*e:\symbols*https://msdl.microsoft.com/download/symbols</span><br><span class="line">.reload /f</span><br></pre></td></tr></table></figure><h3 id="äºŒ-IDA-windbgåŒæœºè°ƒè¯•"><a href="#äºŒ-IDA-windbgåŒæœºè°ƒè¯•" class="headerlink" title="äºŒ.IDA+windbgåŒæœºè°ƒè¯•"></a>äºŒ.IDA+windbgåŒæœºè°ƒè¯•</h3>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ä¸€èŠ‚ä¸»è¦è®²è¿°å¦‚ä½•é…ç½®ç¯å¢ƒ&lt;/p&gt;
&lt;h2 id=&quot;é…ç½®ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#é…ç½®ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;é…ç½®ç¯å¢ƒ&quot;&gt;&lt;/a&gt;é…ç½®ç¯å¢ƒ&lt;/h2&gt;&lt;h3 id=&quot;ä¸€-windbgåŒæœºè°ƒè¯•å†…æ ¸é©±åŠ¨&quot;&gt;&lt;a href=&quot;#ä¸€-windbg</summary>
      
    
    
    
    <category term="å†…æ ¸é©±åŠ¨" scheme="http://example.com/categories/%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8/"/>
    
    
    <category term="Windowså†…æ ¸é©±åŠ¨å¼€å‘" scheme="http://example.com/tags/Windows%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>DLLå­¦ä¹ (äºŒ)</title>
    <link href="http://example.com/2024/03/31/DLL%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/"/>
    <id>http://example.com/2024/03/31/DLL%E5%AD%A6%E4%B9%A0(%E4%BA%8C)/</id>
    <published>2024-03-30T16:00:00.000Z</published>
    <updated>2024-03-31T03:12:40.270Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¼–å†™DLL"><a href="#ç¼–å†™DLL" class="headerlink" title="ç¼–å†™DLL"></a>ç¼–å†™DLL</h2><p>åœ¨VS2019åˆ›å»ºåŠ¨æ€é“¾æ¥åº“</p><p>è¿™ä¸ªå‡½æ•°å°±æ˜¯DLLçš„å¯¼å‡ºå‡½æ•°</p><p><img src="/../image/608.png" class="lazyload" data-srcset="/../image/608.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="608"></p><p>è¿™ä¸ªç›¸å½“äºå°±æ˜¯æ­£å¸¸åº”ç”¨ç¨‹åºçš„mainå‡½æ•°</p><p><img src="/../image/609.png" class="lazyload" data-srcset="/../image/609.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="609"></p><p>ç„¶åæˆ‘ä»¬ä»‹ç»å…³äºè¿™ä¸ªå‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL APIENTRY <span class="title">DllMain</span><span class="params">( HMODULE hModule,   <span class="comment">//DLL æ¨¡å—çš„å¥æŸ„ã€‚è¯¥å€¼æ˜¯ DLL çš„åŸºå€ã€‚</span></span></span></span><br><span class="line"><span class="params"><span class="function">                       DWORD  ul_reason_for_call,<span class="comment">//æŒ‡ç¤ºè°ƒç”¨ DLL å…¥å£ç‚¹å‡½æ•°çš„åŸå› ä»£ç </span></span></span></span><br><span class="line"><span class="params"><span class="function">                       LPVOID lpReserved <span class="comment">//å¦‚æœ fdwReason ä¸º DLL_PROCESS_DETACHï¼Œåˆ™ lpvReserved ä¸º NULLï¼ˆå¦‚æœå·²è°ƒç”¨ FreeLibrary æˆ– DLL åŠ è½½å¤±è´¥ï¼‰;å¦‚æœè¿›ç¨‹æ­£åœ¨ç»ˆæ­¢ï¼Œåˆ™ä¸º non-NULLã€‚</span></span></span></span><br><span class="line"><span class="params"><span class="function">                     )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (ul_reason_for_call)</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="comment">//å½“DLLè¢«è¿›ç¨‹åŠ è½½æ—¶DLLmainè¢«è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">case</span> DLL_PROCESS_ATTACH:</span><br><span class="line">     <span class="comment">//æœ‰çº¿ç¨‹è¢«åˆ›å»ºæ—¶,DLLmainè¢«è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">case</span> DLL_THREAD_ATTACH:</span><br><span class="line">     <span class="comment">//æœ‰çº¿ç¨‹ç»“æŸæ—¶DLLmainè¢«è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">case</span> DLL_THREAD_DETACH:</span><br><span class="line">     <span class="comment">//å½“DLLè¢«è¿›ç¨‹å¸è½½æ—¶DLLmainè¢«è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">case</span> DLL_PROCESS_DETACH:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯¼å‡ºå‡½æ•°çš„ç¼–å†™"><a href="#å¯¼å‡ºå‡½æ•°çš„ç¼–å†™" class="headerlink" title="å¯¼å‡ºå‡½æ•°çš„ç¼–å†™"></a>å¯¼å‡ºå‡½æ•°çš„ç¼–å†™</h2><h3 id="çŸ¥è¯†ç‚¹1"><a href="#çŸ¥è¯†ç‚¹1" class="headerlink" title="çŸ¥è¯†ç‚¹1"></a>çŸ¥è¯†ç‚¹1</h3><p><strong>extern â€œCâ€</strong></p><p>extern â€œCâ€ çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®å®ç° C++ä»£ç è°ƒç”¨å…¶ä»–Cè¯­è¨€ä»£ç ã€‚åŠ ä¸Š externâ€câ€åï¼Œä¼šæŒ‡ç¤ºç¼–è¯‘å™¨è¿™éƒ¨åˆ†ä»£ç æŒ‰cè¯­è¨€çš„è¿›è¡Œç¼–è¯‘ï¼Œè€Œä¸æ˜¯c+çš„ã€‚ç”±äºc++æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘å™¨ç·¨è¯‘å‡½æ•°çš„è¿‡ç¨‹ä¸­ä¼šå°†å‡½æ•°çš„å‚æ•°ç±»å‹ä¹ŸåŠ åˆ°ç¼–è¯‘åçš„ä»£ç ä¸­ï¼Œè€Œä¸ä»…ä»…æ˜¯å‡½æ•°å;è€Œcè¯­è¨€å¹¶ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘cè¯­è¨€ä»£ç çš„å‡½æ•°æ—¶ä¸ä¼šå¸¦ä¸Šå‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œä¸€èˆ¬ä¹‹åŒ…æ‹¬å‡½æ•°åã€‚<br>è¿™ä¸ªåŠŸèƒ½ååˆ†æœ‰ç”¨å¤„ï¼Œå› ä¸ºåœ¨ c+å‡ºç°ä»¥å‰ï¼Œå¾ˆå¤šä»£ç éƒ½æ˜¯cè¯­è¨€å†™çš„ï¼Œè€Œä¸”å¾ˆåº•å±‚çš„åº“ä¹Ÿæ˜¯Cè¯­è¨€å†™çš„ï¼Œä¸ºäº†æ›´å¥½çš„æ”¯æŒåŸæ¥çš„Cä»£ç å’Œå·²ç»å†™å¥½çš„cè¯­è¨€åº“ï¼Œéœ€è¦åœ¨ c++ä¸­å°½å¯èƒ½çš„æ”¯æŒcï¼Œè€Œ externâ€câ€å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªç­–ç•¥ã€‚</p><p>ç®€å•ç‚¹:é˜²æ­¢ç¼–è¯‘åå‡½æ•°åè¢«ç¼–è¯‘å™¨ä¿®æ”¹æˆ–è€…ç²‰ç¢<br>è¿™ä¸ªåŠŸèƒ½ä¸»è¦ç”¨åœ¨ä¸‹é¢çš„æƒ…å†µ:<br>1ã€C++ä»£ç è°ƒç”¨cè¯­è¨€ä»£ç <br>2ã€åœ¨ C++çš„å¤´æ–‡ä»¶ä¸­ä½¿ç”¨<br>3ã€åœ¨å¤šä¸ªäººååŒå¼€å‘æ—¶ï¼Œå¯èƒ½æœ‰çš„äººæ¯”è¾ƒæ“…é•¿cè¯­è¨€ï¼Œè€Œæœ‰çš„äººæ“…é•¿ c++ï¼Œè¿™æ ·çš„æƒ…å†µä¸‹ä¹Ÿä¼šæœ‰ç”¨åˆ°</p><h3 id="çŸ¥è¯†ç‚¹2"><a href="#çŸ¥è¯†ç‚¹2" class="headerlink" title="çŸ¥è¯†ç‚¹2"></a>çŸ¥è¯†ç‚¹2</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å£°æ˜å¯¼å‡ºå‡½æ•°-&gt;æŠŠè¿™ä¸ªcccå‡½æ•°å¯¼å‡ºå»</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)  <span class="function"><span class="type">void</span> <span class="title">ccc</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ccc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h2 id="é™æ€åº“"><a href="#é™æ€åº“" class="headerlink" title="é™æ€åº“"></a>é™æ€åº“</h2><p>é™æ€åº“æ˜¯æŒ‡åœ¨æˆ‘ä»¬çš„åº”ç”¨ä¸­ï¼Œæœ‰ä¸€äº›å…¬å…±ä»£ç æ˜¯éœ€è¦åå¤ä½¿ç”¨ï¼Œå°±æŠŠè¿™äº›ä»£ç ç¼–è¯‘ä¸ºâ€œåº“â€æ–‡ä»¶;åœ¨é“¾æ¥æ­¥éª¤ä¸­ï¼Œè¿æ¥å™¨å°†ä»åº“æ–‡ä»¶å–å¾—æ‰€éœ€çš„ä»£ç ï¼Œå¤åˆ¶åˆ°ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„è¿™ç§åº“ã€‚<br>ç¨‹åºç¼–è¯‘ä¸€èˆ¬éœ€ç»é¢„å¤„ç†ã€ç¼–è¯‘ã€æ±‡ç¼–å’Œé“¾æ¥å‡ ä¸ªæ­¥éª¤ã€‚é™æ€åº“ç‰¹ç‚¹æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŒ…å«äº†åº“ä»£ç çš„ä¸€ä»½å®Œæ•´æ‹·è´;ç¼ºç‚¹å°±æ˜¯è¢«å¤šæ¬¡ä½¿ç”¨å°±ä¼šæœ‰å¤šä»½å†—ä½™æ‹·è´ã€‚<br>é™æ€åº“å’ŒåŠ¨æ€åº“æ˜¯ä¸¤ç§å…±äº«ç¨‹åºä»£ç çš„æ–¹å¼ï¼Œå®ƒä»¬çš„åŒºåˆ«æ˜¯;é™æ€åº“åœ¨ç¨‹åºçš„é“¾æ¥é˜¶æ®µè¢«å¤åˆ¶åˆ°äº†ç¨‹åºä¸­ï¼Œå’Œç¨‹åºè¿è¡Œçš„æ—¶å€™æ²¡æœ‰å…³ç³»;åŠ¨æ€åº“åœ¨é“¾æ¥é˜¶æ®µæ²¡æœ‰è¢«å¤åˆ¶åˆ°ç¨‹åºä¸­ï¼Œè€Œæ˜¯ç¨‹åºåœ¨è¿è¡Œæ—¶ç”±ç³»ç»ŸåŠ¨æ€åŠ è½½åˆ°å†…å­˜ä¸­ä¾›ç¨‹åºè°ƒç”¨ã€‚ä½¿ç”¨åŠ¨æ€åº“çš„ä¼˜ç‚¹æ˜¯ç³»ç»Ÿåªéœ€è½½å…¥ä¸€æ¬¡åŠ¨æ€åº“ï¼Œä¸åŒçš„ç¨‹åºå¯ä»¥å¾—åˆ°å†…å­˜ä¸­ç›¸åŒçš„åŠ¨æ€åº“çš„å‰¯æœ¬ï¼Œå› æ­¤èŠ‚çœäº†å¾ˆå¤šå†…å­˜ã€‚</p><h2 id="é™æ€è°ƒç”¨DLL"><a href="#é™æ€è°ƒç”¨DLL" class="headerlink" title="é™æ€è°ƒç”¨DLL"></a>é™æ€è°ƒç”¨DLL</h2><p>å¦‚ä½•è®©åº”ç”¨ç¨‹åºä½¿ç”¨æˆ‘ä»¬çš„å¯¼å‡ºå‡½æ•°è¿›è¡Œé€šè®¯?<br>#pragma comment (lib,â€dâ€)æ³¨æ„:æ²¡æœ‰åˆ†å·<br>#pragma comment( comment-type ,[â€œcommentstringâ€])comment-typeæ˜¯ä¸€ä¸ªé¢„å®šä¹‰çš„æ ‡è¯†ç¬¦ï¼ŒæŒ‡å®šæ³¨é‡Šçš„ç±»å‹ï¼Œåº”è¯¥æ˜¯compilerï¼Œexestzï¼Œlibï¼Œlinker ä¹‹ä¸€ã€‚commentstring,æ˜¯ä¸€ä¸ªæä¾›ä¸º comment-type æä¾›é™„åŠ ä¿¡æ¯çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¯¼å‡ºå‡½æ•°</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> __declspec(dllexport)  <span class="function"><span class="type">void</span> <span class="title">ccc</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ccc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="built_in">MessageBox</span>(<span class="literal">NULL</span>, <span class="string">&quot;å¯¼å‡ºå‡½æ•°è¢«è°ƒç”¨æˆåŠŸ!&quot;</span>, <span class="string">&quot;ä¿¡æ¯ï¼š&quot;</span>, MB_YESNO);   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;FirstDLL&quot;</span>)</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function"><span class="type">void</span> <span class="title">ccc</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">ccc</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>dll è¿˜æœ‰ libï¼Œå¤åˆ¶åˆ°<br>ç¬¬ä¸€æ­¥:å¤åˆ¶æ–‡ä»¶åˆ°ç¼–è¯‘ç¨‹åºæ‰€åœ¨çš„ç›®å½•<br>ç¬¬äºŒæ­¥:å¤åˆ¶æ–‡ä»¶åˆ°è§£å†³æ–¹æ¡ˆçš„ç›®å½•</p><p>ç¼–è¯‘çš„æ—¶å€™:éœ€è¦ lib æ–‡ä»¶<br>è¿è¡Œçš„æ—¶å€™:ä¸éœ€è¦ libï¼Œéœ€è¦ dl</p><h2 id="åŠ¨æ€è°ƒç”¨DLL"><a href="#åŠ¨æ€è°ƒç”¨DLL" class="headerlink" title="åŠ¨æ€è°ƒç”¨DLL"></a>åŠ¨æ€è°ƒç”¨DLL</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span>  <span class="title">void</span><span class="params">(*PMessage_Box)</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//å°†æŒ‡å®šçš„æ¨¡å—åŠ è½½åˆ°è°ƒç”¨è¿‡ç¨‹çš„åœ°å€ç©ºé—´ä¸­</span></span><br><span class="line"></span><br><span class="line">HMODULE hMoudle = <span class="built_in">LoadLibrary</span>(<span class="string">&quot;FirstDLL.dll&quot;</span>);</span><br><span class="line"><span class="comment">//åˆ¤æ–­å¥æŸ„æ˜¯å¦ä¸ºç©º</span></span><br><span class="line"><span class="keyword">if</span> (hMoudle == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">MessageBox</span>(<span class="literal">NULL</span>, <span class="string">&quot;å¥æŸ„å‡ºé”™!&quot;</span>, <span class="string">&quot;æ ‡é¢˜:&quot;</span>, MB_OK);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»æŒ‡å®šçš„åŠ¨æ€é“¾æ¥åº“(DLL)ä¸­æ£€ç´¢å¯¼å‡ºçš„å‡½æ•°cccçš„åœ°å€</span></span><br><span class="line">PMessage_Box pMsg = (PMessage_Box)<span class="built_in">GetProcAddress</span>(hMoudle, <span class="string">&quot;ccc&quot;</span>);</span><br><span class="line"><span class="built_in">pMsg</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœå½“å‰ç›®å½•ä¸‹æ²¡æœ‰dllæ–‡ä»¶</p><p><img src="/../image/610.png" class="lazyload" data-srcset="/../image/610.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="610"></p><p>æœ‰dllæ–‡ä»¶</p><p><img src="/../image/611.png" class="lazyload" data-srcset="/../image/611.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="611"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ç¼–å†™DLL&quot;&gt;&lt;a href=&quot;#ç¼–å†™DLL&quot; class=&quot;headerlink&quot; title=&quot;ç¼–å†™DLL&quot;&gt;&lt;/a&gt;ç¼–å†™DLL&lt;/h2&gt;&lt;p&gt;åœ¨VS2019åˆ›å»ºåŠ¨æ€é“¾æ¥åº“&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå‡½æ•°å°±æ˜¯DLLçš„å¯¼å‡ºå‡½æ•°&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/../</summary>
      
    
    
    
    <category term="dllæ³¨å…¥" scheme="http://example.com/categories/dll%E6%B3%A8%E5%85%A5/"/>
    
    
    <category term="å­¦ä¹ " scheme="http://example.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>DLLå­¦ä¹ (ä¸€)</title>
    <link href="http://example.com/2024/03/30/DLL%E5%AD%A6%E4%B9%A0(%E4%B8%80)/"/>
    <id>http://example.com/2024/03/30/DLL%E5%AD%A6%E4%B9%A0(%E4%B8%80)/</id>
    <published>2024-03-29T16:00:00.000Z</published>
    <updated>2024-03-31T01:09:12.899Z</updated>
    
    <content type="html"><![CDATA[<h2 id="äº†è§£dll"><a href="#äº†è§£dll" class="headerlink" title="äº†è§£dll"></a>äº†è§£dll</h2><p>DLL æ˜¯ Dynamic Link Libraryçš„ç¼©å†™ï¼Œæ„ä¸ºåŠ¨æ€é“¾æ¥åº“</p><p>åœ¨Windowsä¸­ï¼Œè®¸å¤šåº”ç”¨ç¨‹åºå¹¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå®ƒä»¬è¢«åˆ†å‰²æˆä¸€äº›ç›¸å¯¹ç‹¬ç«‹çš„åŠ¨æ€é“¾æ¥åº“ï¼Œå³DLLæ–‡ä»¶ï¼Œæ”¾ç½®äºç³»ç»Ÿä¸­ã€‚</p><p>æ¯”å¦‚:</p><p>windowsç³»ç»Ÿå°±æ˜¯ç”±è®¸å¤šçš„åŠ¨æ€é“¾æ¥åº“(DLL æ–‡ä»¶)æ„æˆ</p><p><img src="/../image/606.png" class="lazyload" data-srcset="/../image/606.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="606"></p><p>å½“æˆ‘ä»¬æ‰§è¡ŒæŸä¸€ä¸ªç¨‹åºæ—¶ï¼Œç›¸åº”çš„DLLæ–‡ä»¶å°±ä¼šè¢«è°ƒç”¨ï¼Œä¸€ä¸ªåº”ç”¨ç¨‹åºå¯æœ‰å¤šä¸ªDLLæ–‡ä»¶ï¼Œä¸€ä¸ªDLLæ–‡ä»¶ä¹Ÿå¯èƒ½è¢«å‡ ä¸ªåº”ç”¨ç¨‹åºæ‰€å…±ç”¨ï¼Œè¿™æ ·çš„DLLæ–‡ä»¶è¢«ç§°ä¸ºå…±äº«DLLæ–‡ä»¶</p><p><img src="/../image/607.png" class="lazyload" data-srcset="/../image/607.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="607"></p><p>å…±äº«DLLæ„ŸæŸ“æ‰ï¼Œé‡å¯ç”µè„‘çš„æ—¶å€™ï¼Œæ‰€æœ‰è°ƒç”¨å®ƒçš„éƒ½ä¼šè¢«æ„ŸæŸ“</p><p>å®ƒå…è®¸ç¨‹åºå…±äº«æ‰§è¡Œç‰¹æ®Šä»»åŠ¡æ‰€éœ€çš„ä»£ç å’Œå…¶ä»–èµ„æº</p><p>æ¯”è¾ƒå¤§çš„åº”ç”¨ç¨‹åºéƒ½ç”±å¾ˆå¤šæ¨¡å—(åŠ¨æ€é“¾æ¥åº“)ç»„æˆ,è¿™äº›æ¨¡å—åˆ†åˆ«å®Œæˆç›¸å¯¹ç‹¬ç«‹çš„åŠŸèƒ½ï¼Œå®ƒä»¬å½¼æ­¤åä½œæ¥å®Œæˆ</p><p>Windows ç³»ç»Ÿå¹³å°ä¸Šæä¾›äº†ä¸€ç§å®Œå…¨ä¸åŒçš„è¾ƒæœ‰æ•ˆçš„ç¼–æå’Œè¿è¡Œç¯å¢ƒï¼Œä½ å¯ä»¥å°†ç‹¬ç«‹çš„ç¨‹åºæ¨¡å—åˆ›å»ºä¸ºè¾ƒå°çš„ DLL æ–‡ä»¶ï¼Œå¹¶å¯å¯¹å®ƒä»¬å•ç‹¬ç¼–è¯‘å’Œæµ‹è¯•ã€‚åœ¨è¿è¡Œæ—¶ï¼Œåªæœ‰å½“ EXE ç¨‹åºç¡®å®è¦è°ƒç”¨è¿™äº› DLL æ¨¡å—çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿæ‰ä¼šå°†å®ƒä»¬è£…è½½åˆ°å†…å­˜ç©ºé—´ä¸­ã€‚<br>è¿™ç§æ–¹å¼ä¸ä»…å‡å°‘äº† EXE æ–‡ä»¶çš„å¤§å°å’Œå¯¹å†…å­˜ç©ºé—´çš„éœ€æ±‚ï¼Œè€Œä¸”ä½¿è¿™äº› DL æ¨¡å—å¯ä»¥åŒæ—¶è¢«å¤šä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨ã€‚Windows è‡ªå·±å°±å°†äº›ä¸»è¦çš„ç³»ç»ŸåŠŸèƒ½ä»¥ DLL æ¨¡å—çš„å½¢å¼å®ç°ï¼Œ<br>èˆ¬æ¥è¯´ï¼ŒDLL æ˜¯ä¸€ç§ç£ç›˜æ–‡ä»¶ï¼Œä»¥.dIã€.DRVã€.FONã€.SYS å’Œè®¸å¤šä»¥,EXE ä¸ºæ‰©å±•åçš„ç³»ç»Ÿæ–‡ä»¶éƒ½å¯ä»¥æ˜¯ DLL[åŠ¨å¿—é“¾æ¥åº“ã€‚</p><p>å®ƒç”±å…¨å±€æ•°æ®ã€æœåŠ¡çš„æ•°å’Œèµ„æºç»„æˆï¼Œåœ¨è¿è¡Œæ—¶è¢«ç³»ç»ŸåŠ æˆ‘åˆ°è°ƒç”¨è¿›ç¨‹çš„è™šæ‹Ÿç©ºé—´ä¸­ï¼Œæˆä¸ºè°ƒç”¨è¿›ç¨‹çš„ä¸€éƒ¨åˆ†-&gt;ç†è§£æ–¹æ³•:<br>æŠŠå¤–æŒ‚ DLLå¤–éƒ¨åŠ è½½åˆ°æ¸¸æˆä¸­ï¼Œæˆä¸ºæ¸¸æˆçš„ä¸€éƒ¨åˆ†.</p><p>æ³¨æ„ç‚¹:</p><p>å¦‚æœä¸å…¶å®ƒDLLä¹‹é—´æ²¡æœ‰å†²çªï¼Œè¯¥æ–‡ä»¶é€šå¸¸æ˜ å°„åˆ°è¿›ç¨‹è™šæ‹Ÿç©ºé—´çš„åŒä¸€åœ°å€ä¸Šã€‚</p><p>DLL æ¨¡å—ä¸­åŒ…å«å„ç§å¯¼å‡ºå‡½æ•°ï¼Œç”¨äºå‘å¤–ç•Œæä¾›æœåŠ¡ï¼Œexe</p><p>ä¸€ä¸ªDLL åœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DLL å®ç°äº†ä»£ç å°è£…æ€§;</span><br><span class="line"></span><br><span class="line">DLL çš„ç¼–åˆ¶ä¸å…·ä½“çš„ç¼–ç¨‹è¯­è¨€åŠç¼–è¯‘å™¨æ— å…³ï¼ŒC/C++/æ˜“è¯­è¨€/VB/py/delphiï¼›</span><br><span class="line"></span><br><span class="line">DLL æ¨¡å—éœ€è¦çš„å †æ ˆå†…å­˜éƒ½æ˜¯ä»è¿è¡Œè¿›ç¨‹çš„å †æ ˆä¸­åˆ†é…å‡ºæ¥çš„ï¼›</span><br><span class="line"></span><br><span class="line">DLL å‡½æ•°ä¸­çš„ä»£ç æ‰€åˆ›å»ºçš„ä»»ä½•å¯¹è±¡(åŒ…æ‹¬å˜é‡)éƒ½å½’è°ƒäºå®ƒçš„çº¿ç¨‹æˆ–è¿›ç¨‹æ‰€æœ‰ï¼›</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;äº†è§£dll&quot;&gt;&lt;a href=&quot;#äº†è§£dll&quot; class=&quot;headerlink&quot; title=&quot;äº†è§£dll&quot;&gt;&lt;/a&gt;äº†è§£dll&lt;/h2&gt;&lt;p&gt;DLL æ˜¯ Dynamic Link Libraryçš„ç¼©å†™ï¼Œæ„ä¸ºåŠ¨æ€é“¾æ¥åº“&lt;/p&gt;
&lt;p&gt;åœ¨Windowsä¸­ï¼Œè®¸å¤šåº”</summary>
      
    
    
    
    <category term="dllæ³¨å…¥" scheme="http://example.com/categories/dll%E6%B3%A8%E5%85%A5/"/>
    
    
    <category term="å­¦ä¹ " scheme="http://example.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>DLLæ³¨å…¥å­¦ä¹ (ä¸€)è¿œç¨‹çº¿ç¨‹æ³¨å…¥</title>
    <link href="http://example.com/2024/03/30/DLL%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0(%E4%B8%80)%E8%BF%9C%E7%A8%8B%E7%BA%BF%E7%A8%8B%E6%B3%A8%E5%85%A5/"/>
    <id>http://example.com/2024/03/30/DLL%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0(%E4%B8%80)%E8%BF%9C%E7%A8%8B%E7%BA%BF%E7%A8%8B%E6%B3%A8%E5%85%A5/</id>
    <published>2024-03-29T16:00:00.000Z</published>
    <updated>2024-03-31T04:47:52.996Z</updated>
    
    <content type="html"><![CDATA[<p>è¿œç¨‹çº¿ç¨‹æŒ‡çš„æ˜¯è·¨è¿›ç¨‹ï¼Œå¯ä»¥åœ¨åˆ«çš„è¿›ç¨‹é‡Œåˆ›å»ºçº¿ç¨‹</p><p>ç”¨åˆ°çš„APIå‡½æ•°æ˜¯ CreateRemoteThread</p><p>ä½¿ç”¨ CreateRemoteThread åˆ›å»ºè¿œç¨‹çº¿ç¨‹çš„æ—¶å€™ï¼Œéœ€è¦æä¾›ç›®æ ‡è¿›ç¨‹çš„å¥æŸ„ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡OpenProcesså¾—åˆ°ï¼Œç„¶åè¿˜éœ€è¦ä¸€ä¸ªå‡½æ•°åœ°å€å’Œä¸€ä¸ªå‚æ•°åœ°å€</p><p>è¿™ä¸ªå‡½æ•°åœ°å€æ˜¯åœ¨ç›®æ ‡è¿›ç¨‹é‡Œåˆ›å»ºçº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°åªèƒ½å¸¦æœ‰ä¸€ä¸ªå‚æ•°</p><p>è¯´ä¹Ÿå·§ï¼ŒåŠ è½½DLLçš„å‡½æ•° LoadLibrary åˆšå¥½ä¹Ÿåªè¦ä¸€ä¸ªå‚æ•°ï¼Œé‚£å°±æ˜¯DLLæ–‡ä»¶çš„è·¯å¾„</p><p>åœ¨å¾®è½¯çš„å®˜æ–¹æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°,CreateRemoteThread å‡½æ•°çš„ä½œç”¨æ˜¯ åˆ›å»ºåœ¨å¦ä¸€ä¸ªè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­è¿è¡Œçš„çº¿ç¨‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HANDLE <span class="title">CreateRemoteThread</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  HANDLE                 hProcess,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  LPSECURITY_ATTRIBUTES  lpThreadAttributes,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  SIZE_T                 dwStackSize,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  LPTHREAD_START_ROUTINE lpStartAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  LPVOID                 lpParameter,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  DWORD                  dwCreationFlags,</span></span></span><br><span class="line"><span class="params"><span class="function">  [out] LPDWORD                lpThreadId</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><p>è¿™é‡Œå…ˆæä¸€ä¸‹ä¸€ä¸ªå¯èƒ½ä¼šé‡åˆ°çš„å‘ï¼ŒDLLæ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œå¦‚æœç›®æ ‡è¿›ç¨‹æ˜¯64ä½çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†™çš„ç¨‹åºä¹Ÿå¾—æ˜¯64ä½çš„ï¼Œæ³¨å…¥çš„DLLä¹Ÿå¿…é¡»æ˜¯64ä½çš„ï¼Œä¸ç„¶æ³¨å…¥ä¼šå¤±è´¥ï¼ï¼</p><p>æˆ‘çš„å­¦ä¹ æ€è·¯æ˜¯ç”±å†…å‘å¤–é€æ¸æ•£å¼€ï¼Œæˆ‘ä»¬å…ˆä»CreateRemoteThreadè¿™ä¸ªå‡½æ•°å¼€å§‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CreateRemoteThread</span>() </span><br><span class="line"><span class="comment">//æºç </span></span><br><span class="line"><span class="function">HANDLE</span></span><br><span class="line"><span class="function">WINAPI</span></span><br><span class="line"><span class="function"><span class="title">CreateRemoteThread</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ HANDLE hProcess,        <span class="comment">//ç›®æ ‡è¿›ç¨‹å¥æŸ„</span></span></span></span><br><span class="line"><span class="params"><span class="function">    _In_opt_ LPSECURITY_ATTRIBUTES lpThreadAttributes,    <span class="comment">//å®‰å…¨å±æ€§ä¸€èˆ¬NULL</span></span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ SIZE_T dwStackSize,    <span class="comment">//ç¼ºçœå †æ ˆå¤§å° ä¸€èˆ¬NULL</span></span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ LPTHREAD_START_ROUTINE lpStartAddress,    <span class="comment">//å‡½æ•°åœ°å€æŒ‡é’ˆ</span></span></span></span><br><span class="line"><span class="params"><span class="function">    _In_opt_ LPVOID lpParameter,    <span class="comment">//å‡½æ•°å‚æ•°</span></span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ DWORD dwCreationFlags,        <span class="comment">//åˆ›å»ºåçº¿ç¨‹çš„çŠ¶æ€,0è¡¨ç¤ºç«‹å³æ‰§è¡Œ,æš‚åœCREATE_SUSPENDEDéœ€è¦è°ƒç”¨ResumeThreadå»æ¢å¤</span></span></span></span><br><span class="line"><span class="params"><span class="function">    _Out_opt_ LPDWORD lpThreadId    <span class="comment">//ç”¨æ¥æ¥æ”¶æ–°åˆ›å»ºçº¿ç¨‹çš„çº¿ç¨‹ID,å¯ä»¥ä¸ºNULL</span></span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¹‹å‰çš„win32 APIå­¦ä¹  æˆ‘ä»¬çŸ¥é“è¿›ç¨‹å¥æŸ„æ˜¯éœ€è¦è·å–çš„</p><p>å› æ­¤è¿™ä¸ªå‡½æ•°éœ€è¦ç”¨åˆ°çš„è¿›ç¨‹å¥æŸ„ã€å‡½æ•°åœ°å€ã€å‚æ•°åœ°å€è¿™ä¸‰ä¸ªå‚æ•°éœ€è¦æˆ‘ä»¬æå‰å»è·å¾—</p><h3 id="è·å¾—è¿›ç¨‹ID"><a href="#è·å¾—è¿›ç¨‹ID" class="headerlink" title="è·å¾—è¿›ç¨‹ID"></a>è·å¾—è¿›ç¨‹ID</h3><p>é€šè¿‡OpenProcessè·å¾—å³å¯</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, Pid);</span><br><span class="line"><span class="keyword">if</span> (hProcess == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›ç¨‹PIDå¯ä»¥é€šè¿‡ä»»åŠ¡ç®¡ç†å™¨è‡ªè¡ŒæŸ¥çœ‹</p><p>å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ä»£ç æ¥è·å–ï¼Œæ¯”å¦‚é€šè¿‡FindWindowæ ¹æ®çª—å£åè·å–çª—å£å¥æŸ„ï¼Œç„¶åä½¿ç”¨GetWindowThreadProcessIdæ¥è·å–è¿›ç¨‹PID</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HWND wndProcess = ::<span class="built_in">FindWind</span>(<span class="literal">NULL</span>,<span class="string">L&quot;çª—å£çš„åç§°&quot;</span>)</span><br><span class="line"><span class="built_in">GetWindowThreadProcessId</span>(wndProcess,pid)</span><br></pre></td></tr></table></figure><h3 id="è·å–å‡½æ•°åœ°å€"><a href="#è·å–å‡½æ•°åœ°å€" class="headerlink" title="è·å–å‡½æ•°åœ°å€"></a>è·å–å‡½æ•°åœ°å€</h3><p>ç”±äºkernel32.dllä¸­çš„å‡½æ•°åœ°å€åœ¨windowsä¸Šæ˜¯å›ºå®šçš„ä½ç½®ï¼Œæ‰€ä»¥åœ¨æœ¬è¿›ç¨‹ä¸­è·å–åˆ°çš„åœ°å€åœ¨åˆ«çš„è¿›ç¨‹ä¸­ä¹Ÿé€‚ç”¨ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–LoadLibraryAå‡½æ•°åœ°å€</span></span><br><span class="line">PTHREAD_START_ROUTINE load_start_addr = (PTHREAD_START_ROUTINE)<span class="built_in">GetProcAddress</span>(<span class="built_in">GetModuleHandle</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;Kernel32&quot;</span>)), <span class="string">&quot;LoadLibraryA&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="è·å–å‚æ•°åœ°å€"><a href="#è·å–å‚æ•°åœ°å€" class="headerlink" title="è·å–å‚æ•°åœ°å€"></a>è·å–å‚æ•°åœ°å€</h3><p>è¿™é‡Œéœ€è¦æ‰“å¼€è¿›ç¨‹ï¼Œå‘ç›®æ ‡è¿›ç¨‹ç”³è¯·ä¸€ç‰‡åœ°å€ç©ºé—´ï¼Œç„¶åå‘è¿™ä¸ªç©ºé—´å†™å…¥dllæ–‡ä»¶çš„è·¯å¾„</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰“å¼€è¿›ç¨‹,è·å–è¿›ç¨‹å¥æŸ„</span></span><br><span class="line">HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, Pid);</span><br><span class="line"><span class="keyword">if</span> (hProcess == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘ç›®æ ‡è¿›ç¨‹ç”³è¯·ç©ºé—´,è¿”å›é¦–åœ°å€æŒ‡é’ˆ</span></span><br><span class="line"><span class="type">int</span> nDllSize = <span class="built_in">strlen</span>(dll) + <span class="number">1</span>;</span><br><span class="line">LPVOID pDllAddr = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="literal">NULL</span>, nDllSize, MEM_COMMIT, PAGE_READWRITE);</span><br><span class="line"><span class="keyword">if</span> (pDllAddr == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘ç›®æ ‡è¿›ç¨‹ç”³è¯·çš„ç©ºé—´å†™å…¥dllç»å¯¹è·¯å¾„</span></span><br><span class="line">DWORD dwWriteNum = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">WriteProcessMemory</span>(hProcess, pDllAddr, dll, nDllSize, &amp;dwWriteNum);</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸çŸ¥é“dllè·¯å¾„æœ‰æ²¡æœ‰æˆåŠŸå†™å…¥ç›®æ ‡è¿›ç¨‹ï¼Œå¯é€šè¿‡CEè½¯ä»¶æ‰“å¼€ç›®æ ‡è¿›ç¨‹æŸ¥çœ‹å†…å­˜æ¥åˆ¤æ–­</p><h3 id="DLLæ³¨å…¥"><a href="#DLLæ³¨å…¥" class="headerlink" title="DLLæ³¨å…¥"></a>DLLæ³¨å…¥</h3><p>æ¥ä¸‹æ¥è°ƒç”¨CreateRemoteThreadè¿›è¡Œdllæ³¨å…¥å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DLLæ³¨å…¥</span></span><br><span class="line">HANDLE hThread = <span class="built_in">CreateRemoteThread</span>(hProcess, <span class="literal">NULL</span>, <span class="number">0</span>, load_start_addr, pDllAddr, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç­‰å¾…ç›®æ ‡dllçš„åŠ è½½ç»“æŸ</span></span><br><span class="line"><span class="built_in">WaitForSingleObject</span>(hThread, INFINITE);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…³é—­åˆšåˆšåˆ›å»ºçš„å¥æŸ„</span></span><br><span class="line"><span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br></pre></td></tr></table></figure><h3 id="å¸è½½æ³¨å…¥çš„DLL"><a href="#å¸è½½æ³¨å…¥çš„DLL" class="headerlink" title="å¸è½½æ³¨å…¥çš„DLL"></a>å¸è½½æ³¨å…¥çš„DLL</h3><p>å¸è½½æ³¨å…¥çš„DLLï¼Œå’Œæ³¨å…¥DLLçš„åŸç†ç›¸åŒï¼Œéƒ½æ˜¯é€šè¿‡åˆ›å»ºè¿œç¨‹çº¿ç¨‹å»æ‰§è¡Œä¸€ä¸ªåªæœ‰ä¸€ä¸ªå‚æ•°çš„å‡½æ•°æ¥è¿›è¡Œ</p><p>å¸è½½ç”¨åˆ°çš„å‡½æ•°æ˜¯ï¼šFreeLibraryï¼Œå‚æ•°ä¸ºæ¨¡å—å¥æŸ„ï¼Œè¿™ä¸ªæ¨¡å—å¥æŸ„å¯é€šè¿‡å¯¹ç›®æ ‡è¿›ç¨‹åˆ›å»ºå¿«ç…§ï¼Œç„¶åéå†å…¶ä¸­çš„æ¨¡å—æ¥è·å¾—ï¼Œå…³äºåˆ›å»ºå¿«ç…§éå†æ¨¡å—ç›¸å…³å†…å®¹ï¼Œå¯ä»æˆ‘ä»¥å‰çš„ç¬”è®°ä¸­æ‰¾åˆ°ï¼Œè¿™é‡Œå°±ä¸å†å•°å—¦äº†ã€‚</p><h3 id="FreeLibrary-å‡½æ•°ä»‹ç»"><a href="#FreeLibrary-å‡½æ•°ä»‹ç»" class="headerlink" title="FreeLibrary å‡½æ•°ä»‹ç»"></a>FreeLibrary å‡½æ•°ä»‹ç»</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL</span></span><br><span class="line"><span class="function">WINAPI</span></span><br><span class="line"><span class="function"><span class="title">FreeLibrary</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ HMODULE hLibModule    <span class="comment">//æ¨¡å—å¥æŸ„,å¯é€šè¿‡éå†è·å¾—</span></span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>;</span><br></pre></td></tr></table></figure><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">CInjectDllDlg::UnInjectDll</span><span class="params">(DWORD dwPid, LPCSTR szDllName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> åœ¨æ­¤å¤„æ·»åŠ å®ç°ä»£ç .</span></span><br><span class="line">    <span class="keyword">if</span> (dwPid == <span class="number">0</span> || <span class="built_in">strlen</span>(szDllName) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºDLLå¿«ç…§</span></span><br><span class="line">    HANDLE hSnap = <span class="built_in">CreateToolhelp32Snapshot</span>(TH32CS_SNAPMODULE, dwPid);</span><br><span class="line">    MODULEENTRY32 me32;</span><br><span class="line">    me32.dwSize = <span class="built_in">sizeof</span>(me32);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿™é‡Œå¯»æ‰¾æŒ‡å®šçš„dllä¿¡æ¯,æ‰¾åˆ°äº†å,ç»“æ„ä½“é‡Œçš„hModuleå‚æ•°é‡Œä¼šå­˜æœ‰dllæ¨¡å—å¥æŸ„</span></span><br><span class="line">    BOOL bRet = <span class="built_in">Module32First</span>(hSnap,&amp;me32);</span><br><span class="line">    TCHAR szDllNameW[MAX_PATH] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="built_in">MultiByteToWideChar</span>(CP_ACP, <span class="literal">NULL</span>, szDllName, <span class="number">-1</span>, szDllNameW, <span class="built_in">strlen</span>(szDllName));</span><br><span class="line">    <span class="keyword">while</span> (bRet) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">lstrcmp</span>(_wcsupr(me32.szExePath), _wcsupr(szDllNameW)) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        bRet = <span class="built_in">Module32Next</span>(hSnap, &amp;me32);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">CloseHandle</span>(hSnap);</span><br><span class="line">    <span class="type">char</span>* pFunName = <span class="string">&quot;FreeLibrary&quot;</span>;</span><br><span class="line">    <span class="comment">// æ‰“å¼€ç›®æ ‡è¿›ç¨‹</span></span><br><span class="line">    HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, dwPid);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (hProcess == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è®¡ç®—æ¬²æ³¨å…¥DLLæ–‡ä»¶å®Œæ•´è·¯å¾„çš„é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span> nDllLen = <span class="built_in">strlen</span>(szDllName) + <span class="built_in">sizeof</span>(TCHAR);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å¾—å‡½æ•°çš„åœ°å€</span></span><br><span class="line">    FARPROC pFunAddr = <span class="built_in">GetProcAddress</span>(<span class="built_in">GetModuleHandle</span>(<span class="string">L&quot;kernel32.dll&quot;</span>), pFunName);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºè¿œç¨‹çº¿ç¨‹</span></span><br><span class="line">    HANDLE hThread = <span class="built_in">CreateRemoteThread</span>(hProcess,</span><br><span class="line">        <span class="literal">NULL</span>, <span class="number">0</span>,</span><br><span class="line">        (PTHREAD_START_ROUTINE)pFunAddr,<span class="comment">//LoadLibraryAå‡½æ•°</span></span><br><span class="line">        me32.hModule,        <span class="comment">//å‚æ•°æ˜¯dllåœ°å€æŒ‡é’ˆ</span></span><br><span class="line">        <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">//WaitForSingleObject(hThread, INFINITE);//ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿œç¨‹çº¿ç¨‹æŒ‡çš„æ˜¯è·¨è¿›ç¨‹ï¼Œå¯ä»¥åœ¨åˆ«çš„è¿›ç¨‹é‡Œåˆ›å»ºçº¿ç¨‹&lt;/p&gt;
&lt;p&gt;ç”¨åˆ°çš„APIå‡½æ•°æ˜¯ CreateRemoteThread&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ CreateRemoteThread åˆ›å»ºè¿œç¨‹çº¿ç¨‹çš„æ—¶å€™ï¼Œéœ€è¦æä¾›ç›®æ ‡è¿›ç¨‹çš„å¥æŸ„ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡OpenProcesså¾—åˆ°ï¼Œç„¶åè¿˜éœ€è¦ä¸€</summary>
      
    
    
    
    <category term="dllæ³¨å…¥" scheme="http://example.com/categories/dll%E6%B3%A8%E5%85%A5/"/>
    
    
    <category term="å­¦ä¹ " scheme="http://example.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>win32APIå­¦ä¹ (ç¬¬ä¸€å¤©)</title>
    <link href="http://example.com/2024/03/30/win32API%E5%AD%A6%E4%B9%A0(%E7%AC%AC%E4%B8%80%E5%A4%A9)/"/>
    <id>http://example.com/2024/03/30/win32API%E5%AD%A6%E4%B9%A0(%E7%AC%AC%E4%B8%80%E5%A4%A9)/</id>
    <published>2024-03-29T16:00:00.000Z</published>
    <updated>2024-03-30T12:49:33.570Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å®ä¾‹ä¸€-å®ç°æ¤ç‰©å¤§æˆ˜åƒµå°¸æ— é™é˜³å…‰"><a href="#å®ä¾‹ä¸€-å®ç°æ¤ç‰©å¤§æˆ˜åƒµå°¸æ— é™é˜³å…‰" class="headerlink" title="å®ä¾‹ä¸€(å®ç°æ¤ç‰©å¤§æˆ˜åƒµå°¸æ— é™é˜³å…‰)"></a>å®ä¾‹ä¸€(å®ç°æ¤ç‰©å¤§æˆ˜åƒµå°¸æ— é™é˜³å…‰)</h2><p>æˆ‘ä»¬æƒ³åˆ©ç”¨MFCå®ç°çª—å£åŒ–</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FindWindow   æŸ¥æ‰¾çª—å£å¥æŸ„</span><br><span class="line"><span class="comment">//æºç </span></span><br><span class="line"><span class="function">HWND <span class="title">FindWindowW</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [in, optional] LPCWSTR lpClassName,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in, optional] LPCWSTR lpWindowName</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"><span class="comment">//é¦–å…ˆè¿™ä¸ªå‡½æ•°æ˜¯è¿”å›HWNDç±»å‹ï¼Œç„¶åè¿”å›çš„æ˜¯çª—å£å¥æŸ„</span></span><br><span class="line">HWND wndProcess = ::<span class="built_in">FindWind</span>(<span class="literal">NULL</span>,<span class="string">L&quot;çª—å£çš„åç§°&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GetWindowThreadProcessId è·å–pid</span><br><span class="line"><span class="comment">//æºç </span></span><br><span class="line"><span class="function">DWORD <span class="title">GetWindowThreadProcessId</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]            HWND    hWnd,</span></span></span><br><span class="line"><span class="params"><span class="function">  [out, optional] LPDWORD lpdwProcessId</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"><span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çª—å£å¥æŸ„ï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‰ç…§å®˜æ–¹æ–‡æ¡£é‡Œé¢æ‰€è¯´ï¼šæŒ‡å‘æ¥æ”¶è¿›ç¨‹æ ‡è¯†ç¬¦çš„å˜é‡çš„æŒ‡é’ˆ</span></span><br><span class="line"><span class="built_in">GetWindowThreadProcessId</span>(wndProcess,pid)</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">OpenProcess æ‰“å¼€è¿›ç¨‹ï¼Œè·å–è¿›ç¨‹å¥æŸ„</span><br><span class="line"><span class="comment">//æºç </span></span><br><span class="line">HANDLEï¼Œ <span class="built_in">OpenProcess</span>(</span><br><span class="line">  [in] DWORD dwDesiredAccess,</span><br><span class="line">  [in] BOOL  bInheritHandle,</span><br><span class="line">  [in] DWORD dwProcessId</span><br><span class="line">);</span><br><span class="line"><span class="comment">// å®ƒçš„è¿”å›ç±»å‹ä¸ºHANDLEï¼Œè¿”å›å€¼æ˜¯è¿›ç¨‹å¥æŸ„</span></span><br><span class="line">HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS,FALSE,pid)</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ReadProcessMemory è¯»è¿›ç¨‹å†…å­˜</span><br><span class="line"><span class="comment">//æºç </span></span><br><span class="line"><span class="function">BOOL <span class="title">ReadProcessMemory</span><span class="params">()</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  HANDLE  hProcess,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  LPCVOID lpBaseAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">  [out] LPVOID  lpBuffer,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  SIZE_T  nSize,</span></span></span><br><span class="line"><span class="params"><span class="function">  [out] SIZE_T  *lpNumberOfBytesRead</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"><span class="comment">//æˆ‘ä»¬ä»æºç å¯ä»¥çœ‹å‡ºï¼Œå®ƒæœ‰äº”ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºhProcess(è¿›ç¨‹å¥æŸ„),ç¬¬äºŒä¸ªå‚æ•°ä¸ºæŒ‡å‘æŒ‡å®šè¿›ç¨‹ä¸­è¦ä»ä¸­è¯»å–çš„åŸºå€çš„æŒ‡é’ˆï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæŒ‡å‘ç¼“å†²åŒºçš„æŒ‡é’ˆ(å°±æ˜¯æˆ‘ä»¬è¦ä¿®æ”¹çš„å€¼)ï¼Œç¬¬å››ä¸ªå‚æ•°ä¸ºè¦ä»æŒ‡å®šè¿›ç¨‹è¯»å–çš„å­—èŠ‚æ•°ï¼Œç¬¬äº”ä¸ªå‚æ•°ä¸ºNULL</span></span><br><span class="line"><span class="built_in">ReadProcessMemory</span>(hProcess,(LPCVOID)åŸºå€,&amp;è¦æ”¹å˜çš„æ•°ï¼Œ<span class="built_in">sizeof</span>(è¦æ”¹å˜çš„æ•°)ï¼Œ<span class="literal">NULL</span>)</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">WriteProcessMemory å†™å…¥è¿›ç¨‹å†…å­˜</span><br><span class="line"><span class="comment">//æºç </span></span><br><span class="line"><span class="function">BOOL <span class="title">WriteProcessMemory</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  HANDLE  hProcess,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  LPVOID  lpBaseAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  LPCVOID lpBuffer,</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]  SIZE_T  nSize,</span></span></span><br><span class="line"><span class="params"><span class="function">  [out] SIZE_T  *lpNumberOfBytesWritten</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"><span class="comment">//æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å’Œ ReadProcessMemory() å‡½æ•°ç›¸å·®ä¸å¤§ï¼Œå¯ä»¥è¾…åŠ©ç†è§£</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CloseHandle å…³é—­è¿›ç¨‹ï¼Œå…³é—­å¥æŸ„</span><br><span class="line"><span class="comment">//å¥æŸ„</span></span><br><span class="line"><span class="function">BOOL <span class="title">CloseHandle</span><span class="params">()</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [in] HANDLE hObject</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess)</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">CMFCApplication2Dlg::OnBnClickedButton1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> åœ¨æ­¤æ·»åŠ æ§ä»¶é€šçŸ¥å¤„ç†ç¨‹åºä»£ç </span></span><br><span class="line">HWND çª—å£å¥æŸ„ = ::<span class="built_in">FindWindow</span>(<span class="literal">NULL</span>,<span class="string">L&quot;æ¤ç‰©å¤§æˆ˜åƒµå°¸ä¸­æ–‡ç‰ˆ&quot;</span>);</span><br><span class="line">DWORD pid;</span><br><span class="line"><span class="built_in">GetWindowThreadProcessId</span>(çª—å£å¥æŸ„, &amp;pid);</span><br><span class="line"><span class="keyword">if</span> (pid == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">HANDLE è¿›ç¨‹å¥æŸ„ = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, pid);</span><br><span class="line"><span class="keyword">if</span> (è¿›ç¨‹å¥æŸ„ == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> é˜³å…‰;</span><br><span class="line"><span class="type">int</span> ä¿®æ”¹çš„é˜³å…‰æ•° = <span class="number">888888</span>;</span><br><span class="line"><span class="built_in">ReadProcessMemory</span>(è¿›ç¨‹å¥æŸ„, (LPCVOID)<span class="number">0x006A9EC0</span>,&amp;é˜³å…‰,<span class="built_in">sizeof</span>(é˜³å…‰),<span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">ReadProcessMemory</span>(è¿›ç¨‹å¥æŸ„, (LPCVOID)(é˜³å…‰+<span class="number">0x768</span>), &amp;é˜³å…‰, <span class="built_in">sizeof</span>(é˜³å…‰), <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">WriteProcessMemory</span>(è¿›ç¨‹å¥æŸ„,(LPVOID)(é˜³å…‰+<span class="number">0x5560</span>), &amp;ä¿®æ”¹çš„é˜³å…‰æ•°, <span class="built_in">sizeof</span>(ä¿®æ”¹çš„é˜³å…‰æ•°), <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">CloseHandle</span>(è¿›ç¨‹å¥æŸ„);<span class="comment">//è¿›ç¨‹å¥æŸ„ä¸€å®šè¦åŠæ—¶å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../image/605.png" class="lazyload" data-srcset="/../image/605.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="605"></p><h2 id="å®ä¾‹äºŒ-æ¤ç‰©å¤§æˆ˜åƒµå°¸ï¼Œç§æ¤æ— å†·å´"><a href="#å®ä¾‹äºŒ-æ¤ç‰©å¤§æˆ˜åƒµå°¸ï¼Œç§æ¤æ— å†·å´" class="headerlink" title="å®ä¾‹äºŒ(æ¤ç‰©å¤§æˆ˜åƒµå°¸ï¼Œç§æ¤æ— å†·å´)"></a>å®ä¾‹äºŒ(æ¤ç‰©å¤§æˆ˜åƒµå°¸ï¼Œç§æ¤æ— å†·å´)</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å®ä¾‹ä¸€-å®ç°æ¤ç‰©å¤§æˆ˜åƒµå°¸æ— é™é˜³å…‰&quot;&gt;&lt;a href=&quot;#å®ä¾‹ä¸€-å®ç°æ¤ç‰©å¤§æˆ˜åƒµå°¸æ— é™é˜³å…‰&quot; class=&quot;headerlink&quot; title=&quot;å®ä¾‹ä¸€(å®ç°æ¤ç‰©å¤§æˆ˜åƒµå°¸æ— é™é˜³å…‰)&quot;&gt;&lt;/a&gt;å®ä¾‹ä¸€(å®ç°æ¤ç‰©å¤§æˆ˜åƒµå°¸æ— é™é˜³å…‰)&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬æƒ³åˆ©ç”¨MFCå®ç°çª—å£</summary>
      
    
    
    
    <category term="WIN32API" scheme="http://example.com/categories/WIN32API/"/>
    
    
    <category term="å­¦ä¹ " scheme="http://example.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>IDAå­¦ä¹ ä¹‹c++é€†å‘</title>
    <link href="http://example.com/2024/03/28/IDA%E5%AD%A6%E4%B9%A0%E4%B9%8Bc++%E9%80%86%E5%90%91/"/>
    <id>http://example.com/2024/03/28/IDA%E5%AD%A6%E4%B9%A0%E4%B9%8Bc++%E9%80%86%E5%90%91/</id>
    <published>2024-03-27T16:00:00.000Z</published>
    <updated>2024-03-28T07:20:47.165Z</updated>
    
    <content type="html"><![CDATA[<h2 id="STL-é€†å‘æ–¹æ³•è®º"><a href="#STL-é€†å‘æ–¹æ³•è®º" class="headerlink" title="STL é€†å‘æ–¹æ³•è®º"></a>STL é€†å‘æ–¹æ³•è®º</h2><ul><li>è¯†åˆ« STL å®¹å™¨ç±»å‹</li><li>è¯†åˆ« STL å®¹å™¨æ“ä½œ</li><li>æå–STL å®¹å™¨ä¸­çš„æ•°æ®</li></ul><h3 id="é€†å‘STL-ä¸»è¦çš„é—®é¢˜"><a href="#é€†å‘STL-ä¸»è¦çš„é—®é¢˜" class="headerlink" title="é€†å‘STL ä¸»è¦çš„é—®é¢˜:"></a>é€†å‘STL ä¸»è¦çš„é—®é¢˜:</h3><ul><li>ç¼ºå°‘ç¬¦å·,æ— æ³•åˆ¤æ–­STL å®¹å™¨ç±»å‹ ï¼ˆä¸»è¦å›°éš¾ï¼‰</li><li>STL å†…éƒ¨æ•°æ®ç»“æ„å¤æ‚ï¼Œéš¾ä»¥æå–æ•°æ®</li><li>03 ä¼˜åŒ–ä½¿å¤§é‡ stl å‡½æ•°è¢« inline</li><li>æ–¹æ³•: è§£æ STL å®¹å™¨å†…å­˜æ•°æ®ï¼Œä»å†…å­˜æ•°æ®è§’åº¦åˆ¤æ–­å®¹å™¨ç±»å‹ï¼Œæå–å®¹å™¨å†…åˆ¤æ–­å‡½æ•°æ“ä½œ</li></ul><h2 id="å¸¸è§-STLå®¹å™¨"><a href="#å¸¸è§-STLå®¹å™¨" class="headerlink" title="å¸¸è§ STLå®¹å™¨"></a>å¸¸è§ STLå®¹å™¨</h2><ul><li><p>åºåˆ—å®¹å™¨</p><ul><li><p>vector</p></li><li><p>Deque</p></li><li><p>List</p></li><li><p>String</p></li></ul></li><li><p>å…³è”å®¹å™¨</p><ul><li>Pair</li><li>Map</li><li>Set</li><li>MultiMap &#x2F; MultiSet</li></ul></li><li><p>æ— åºå…³è”å®¹å™¨</p><ul><li>unordered_map</li></ul></li></ul><h2 id="å¸¸è§-STL-å®¹å™¨é€‚é…å™¨"><a href="#å¸¸è§-STL-å®¹å™¨é€‚é…å™¨" class="headerlink" title="å¸¸è§ STL å®¹å™¨é€‚é…å™¨"></a>å¸¸è§ STL å®¹å™¨é€‚é…å™¨</h2><p><strong>å®¹å™¨é€‚é…å™¨</strong>æ˜¯ä¸€ä¸ªå°è£…äº†åºåˆ—å®¹å™¨çš„ç±»æ¨¡æ¿ï¼Œå®ƒåœ¨ä¸€èˆ¬åºåˆ—å®¹å™¨çš„åŸºç¡€ä¸Šæä¾›äº†ä¸€äº›ä¸åŒçš„åŠŸèƒ½ã€‚ä¹‹æ‰€ä»¥ç§°ä½œé€‚é…å™¨ç±»ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥é€šè¿‡é€‚é…å®¹å™¨ç°æœ‰çš„æ¥å£æ¥æä¾›ä¸åŒçš„åŠŸèƒ½ã€‚</p><ul><li><p>stack ï¼šdeque</p></li><li><p>queue ï¼šdeque</p></li><li><p>priority_queue ï¼švector</p></li></ul><p>é€†å‘æ—¶å¤„ç†å®¹å™¨é€‚é…å™¨åªéœ€è¦ç”¨åº•å±‚å®¹å™¨æ¥å¤„ç†å³å¯ã€‚</p><h2 id="std-string"><a href="#std-string" class="headerlink" title="std::string"></a>std::string</h2><ul><li><p>å›ºå®šé•¿åº¦ 32 å­—èŠ‚ï¼Œ4 ä¸ª dq</p></li><li><p>ç¬¬ä¸€ä¸ªæŒ‡é’ˆå­—æ®µæŒ‡å‘æ•°æ®åœ°å€</p></li><li><p>ç¬¬äºŒä¸ª size_t å­—æ®µå­˜å‚¨å­—ç¬¦ä¸²é•¿åº¦</p></li></ul><h3 id="std-stringå†…å­˜å¸ƒå±€"><a href="#std-stringå†…å­˜å¸ƒå±€" class="headerlink" title="std::stringå†…å­˜å¸ƒå±€"></a>std::stringå†…å­˜å¸ƒå±€</h3><p><img src="/../image/572.png" class="lazyload" data-srcset="/../image/572.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="572"></p><h3 id="IDA-dumpè„šæœ¬"><a href="#IDA-dumpè„šæœ¬" class="headerlink" title="IDA dumpè„šæœ¬"></a>IDA dumpè„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dbg_read_cppstr_64</span>(<span class="params">objectAddr</span>):</span><br><span class="line">    <span class="comment"># A easy function for read std::string</span></span><br><span class="line">    strPtr = idc.read_dbg_qword(objectAddr)</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        onebyte = idc.read_dbg_byte(strPtr+i)</span><br><span class="line">        <span class="keyword">if</span> onebyte == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result += <span class="built_in">chr</span>(onebyte)</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">     <span class="keyword">return</span> result       </span><br></pre></td></tr></table></figure><h2 id="std-stringsteam"><a href="#std-stringsteam" class="headerlink" title="std::stringsteam"></a>std::stringsteam</h2><ul><li>å­—ç¬¦ä¸²æµï¼ˆç†è§£æˆæ–‡ä»¶æµï¼Œæœ‰è¯»å†™æŒ‡é’ˆï¼‰</li><li>è¾“å…¥æµ &#x2F; è¾“å‡ºæµ</li></ul><h3 id="std-stringsteam-å†…å­˜å¸ƒå±€"><a href="#std-stringsteam-å†…å­˜å¸ƒå±€" class="headerlink" title="std::stringsteam å†…å­˜å¸ƒå±€"></a>std::stringsteam å†…å­˜å¸ƒå±€</h3><p><img src="/../image/573.png" class="lazyload" data-srcset="/../image/573.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="573"></p><h3 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h3><p>æ„å»ºä¸€ä¸ªç»“æ„ä½“</p><p><img src="/../image/574.png" class="lazyload" data-srcset="/../image/574.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="574"></p><h2 id="std-vector"><a href="#std-vector" class="headerlink" title="std::vector"></a>std::vector</h2><ul><li><p>å›ºå®šé•¿åº¦ 24 å­—èŠ‚ï¼Œ3 ä¸ª dq</p></li><li><p>ç¬¬ä¸€ä¸ªæŒ‡é’ˆå­—æ®µæŒ‡å‘æ•°ç»„èµ·å§‹åœ°å€</p></li><li><p>ç¬¬äºŒä¸ªæŒ‡é’ˆå­—æ®µæŒ‡å‘æ•°ç»„æœ€åå…ƒç´ åœ°å€</p></li><li><p>ç¬¬ä¸‰ä¸ªæŒ‡é’ˆå­—æ®µæŒ‡å‘æœ€å¤§å†…å­˜åœ°å€</p></li></ul><h3 id="std-vectorå†…å­˜å¸ƒå±€"><a href="#std-vectorå†…å­˜å¸ƒå±€" class="headerlink" title="std::vectorå†…å­˜å¸ƒå±€"></a>std::vectorå†…å­˜å¸ƒå±€</h3><p><img src="/../image/575.png" class="lazyload" data-srcset="/../image/575.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="575"></p><h3 id="IDA-dumpè„šæœ¬-1"><a href="#IDA-dumpè„šæœ¬-1" class="headerlink" title="IDA dumpè„šæœ¬"></a>IDA dumpè„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dump_vector</span>(<span class="params">addr</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Dump a vector of type stf::vector&lt;type&gt; GNU C++  x64&quot;&quot;&quot;</span></span><br><span class="line">    ELEMENT_SIZE = <span class="number">8</span></span><br><span class="line">    data_addr = []</span><br><span class="line">    vector_base = idc.read_dbg_qword(addr+<span class="number">0x0</span>)</span><br><span class="line">    vector_end = idc.read_dbg_qword(addr+<span class="number">0x8</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(vector_base,vector_end,ELEMENT_SIZE):</span><br><span class="line">        data_addr.append(i)</span><br><span class="line">    <span class="keyword">return</span> data_addr    </span><br></pre></td></tr></table></figure><h2 id="std-list"><a href="#std-list" class="headerlink" title="std::list"></a>std::list</h2><ul><li><p>åŒå‘å¾ªç¯é“¾è¡¨å­˜å‚¨</p></li><li><p>å¤´ç»“æ„ + èŠ‚ç‚¹ç»“æ„</p></li><li><p>éå†é•¿åº¦å¯ä»¥ç”¨ size å­—æ®µç¡®å®š</p></li></ul><p><img src="/../image/569.png" class="lazyload" data-srcset="/../image/569.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="569"></p><h3 id="std-listå†…å­˜å¸ƒå±€"><a href="#std-listå†…å­˜å¸ƒå±€" class="headerlink" title="std::listå†…å­˜å¸ƒå±€"></a>std::listå†…å­˜å¸ƒå±€</h3><p><img src="/../image/576.png" class="lazyload" data-srcset="/../image/576.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="576"></p><h3 id="IDA-dumpè„šæœ¬-2"><a href="#IDA-dumpè„šæœ¬-2" class="headerlink" title="IDA dumpè„šæœ¬"></a>IDA dumpè„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump_stl_list</span>(<span class="params">p_list_header</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Dump a list of type std::list&lt;type&gt; FNU  C++  x64&quot;&quot;&quot;</span></span><br><span class="line">    data_addr = []</span><br><span class="line">    list_size = idc.read_dbg_qword(p_list_header+<span class="number">0x10</span>)</span><br><span class="line">    cur_node=p_list_header</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(lsit_size):</span><br><span class="line">        cur_node = idc.read_dbg_qword(cur_node + <span class="number">0x0</span>)</span><br><span class="line">        data_addr.append(cur_node+ <span class="number">0x10</span>)</span><br><span class="line">    <span class="keyword">return</span> data_addr   </span><br></pre></td></tr></table></figure><h2 id="std-deque"><a href="#std-deque" class="headerlink" title="std::deque"></a>std::deque</h2><ul><li><p>å¤´ç»“æ„ + è¿­ä»£å™¨ç»“æ„</p></li><li><p>é€‚ç”¨ std::deque &#x2F; std::stack</p></li></ul><p><img src="/../image/570.png" class="lazyload" data-srcset="/../image/570.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="570"></p><ul><li><p>stl_deque.start.node ç¡®å®šfirst map é¡¹ä½ç½®</p></li><li><p>stl_deque.start.last - stl_deque.start.first ç¡®å®šç¼“å†²åŒºå¤§å°</p></li><li><p>stl_deque.finish.node ç¡®å®šlast map é¡¹ä½ç½®</p></li><li><p>å¯¹äºæ¯ä¸€ä¸ª map é¡¹ï¼š</p><ul><li>start é¡¹ï¼Œè§£æ cur, last åŒºé—´</li><li>finish é¡¹ï¼Œè§£æ start, cur åŒºé—´</li><li>å…¶ä½™é¡¹ï¼Œè§£æ start, last åŒºé—´</li></ul></li></ul><h3 id="std-dequeå†…å­˜å¸ƒå±€"><a href="#std-dequeå†…å­˜å¸ƒå±€" class="headerlink" title="std::dequeå†…å­˜å¸ƒå±€"></a>std::dequeå†…å­˜å¸ƒå±€</h3><p> <img src="/../image/577.png" class="lazyload" data-srcset="/../image/577.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="577"></p><h3 id="IDA-dumpè„šæœ¬-3"><a href="#IDA-dumpè„šæœ¬-3" class="headerlink" title="IDA dumpè„šæœ¬"></a>IDA dumpè„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">deque_iter = nametuple(<span class="string">&#x27;deque_iter&#x27;</span>,[<span class="string">&#x27;cur&#x27;</span>,<span class="string">&#x27;first&#x27;</span>,<span class="string">&#x27;last&#x27;</span>,<span class="string">&#x27;node&#x27;</span>])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_iter</span>(<span class="params">addr</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Parse a deque iterator&quot;&quot;&quot;</span></span><br><span class="line">    cur = idc.read_dbg_qword(addr+ <span class="number">0x0</span>)</span><br><span class="line">    first = idc.read_dbg_qword(addr + <span class="number">0x8</span>)</span><br><span class="line">    last = idc.read_dbg_qword(addr+ <span class="number">0x10</span>)</span><br><span class="line">    node = idc.read_dbg_qword(addr + <span class="number">0x18</span>)</span><br><span class="line">    <span class="keyword">return</span> deque_iter(cur ,first,last,node)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump_deque</span>(<span class="params">addr</span>):</span><br><span class="line">    ELEMENT_SIZE = <span class="number">4</span> <span class="comment"># std::deque&lt;xx&gt;  xx çš„ç±»å‹å¤§å°æ¥æŒ‡å®š</span></span><br><span class="line">    data_addr = []</span><br><span class="line">    start_iter =parse_iter(addr+<span class="number">0x10</span>)</span><br><span class="line">    finsh_iter= parse_iter(addr+<span class="number">0x30</span>)</span><br><span class="line">    buf_size=start_iter.last - start_iter.first</span><br><span class="line">    map_start = start_iter.node</span><br><span class="line">    map_finish = finish_iter.node</span><br><span class="line">    <span class="comment"># parse first buffer data</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start_iter.cur,start_iter.last,ELEMENT_SIZE):</span><br><span class="line">        data_addr.append(i)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start_iter.first,start_iter.cur,ELEMENT_SIZE):</span><br><span class="line">        data_addr.append(i)   </span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(map_start+ <span class="number">8</span> ,mqp_finish-<span class="number">8</span>,<span class="number">8</span>):</span><br><span class="line">        buf_start = idc.read_dbg_qword(b)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(buf_start,buf_start+buf_size,ELEMENT_SIZE):</span><br><span class="line">            data_addr.append(i)</span><br><span class="line">        <span class="keyword">return</span> data_addr    </span><br></pre></td></tr></table></figure><h2 id="std-map"><a href="#std-map" class="headerlink" title="std::map"></a>std::map</h2><ul><li><p>åº•å±‚é‡‡ç”¨ Rb-Tree å®ç°ï¼ˆçº¢é»‘äºŒå‰æ ‘ï¼‰</p></li><li><p>å¤´ç»“æ„ + èŠ‚ç‚¹ç»“æ„</p></li><li><p>ç”¨äºŒå‰æ ‘éå†å¯æå–æ•°æ®</p></li><li><p>é€‚ç”¨ std::map &#x2F; std::set &#x2F; std::multimap &#x2F; std::multiset</p></li></ul><h3 id="std-mapå†…å­˜å¸ƒå±€"><a href="#std-mapå†…å­˜å¸ƒå±€" class="headerlink" title="std::mapå†…å­˜å¸ƒå±€"></a>std::mapå†…å­˜å¸ƒå±€</h3><p><img src="/../image/578.png" class="lazyload" data-srcset="/../image/578.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="578"></p><h3 id="IDA-dumpè„šæœ¬-4"><a href="#IDA-dumpè„šæœ¬-4" class="headerlink" title="IDA dumpè„šæœ¬"></a>IDA dumpè„šæœ¬</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># parse gnu C++ stlmap</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_gnu_map_header</span>(<span class="params">address</span>):</span><br><span class="line">    root = idc.read_dbg_qword(address+<span class="number">0x10</span>)</span><br><span class="line">    <span class="keyword">return</span> root</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_gnu_map_node</span>(<span class="params">address</span>):</span><br><span class="line">    left = idc.read_dbg_qword(address+<span class="number">0x10</span>)</span><br><span class="line">    right = idc.read_dbg_qword(address+<span class="number">0x18</span>)</span><br><span class="line">    data = address+<span class="number">0x20</span></span><br><span class="line">    <span class="keyword">return</span> left,right,data</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_gnu_map_traval</span>(<span class="params">address</span>):</span><br><span class="line">    <span class="comment"># address  &lt;- std::map struct address</span></span><br><span class="line">    result = []</span><br><span class="line">    worklist = [parse_gnu_map_header(address)]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(worklist) &gt; <span class="number">0</span>:</span><br><span class="line">        addr = worklist.pop()</span><br><span class="line">        (left ,right,data)=parse_gnu_map_node(addr)</span><br><span class="line">        <span class="keyword">if</span> left &gt;<span class="number">0</span> : worklist.append(left)</span><br><span class="line">        <span class="keyword">if</span> right &gt;<span class="number">0</span>: worklist.append(right)</span><br><span class="line">        result.append(data)</span><br><span class="line">     <span class="keyword">return</span> result        </span><br></pre></td></tr></table></figure><h2 id="std-unsorted-map"><a href="#std-unsorted-map" class="headerlink" title="std::unsorted_map"></a>std::unsorted_map</h2><ul><li><p>åº•å±‚é‡‡ç”¨ HashTable å®ç°</p></li><li><p>å¤´ç»“æ„ + Bucket æ•°ç»„ + èŠ‚ç‚¹ç»“æ„</p></li><li><p><strong>æ‰€æœ‰èŠ‚ç‚¹ç»“æ„ç”¨å•é“¾è¡¨ä¸²è”ï¼ˆ****dump</strong> <strong>åªéœ€è¦éå†å•é“¾è¡¨ï¼‰</strong></p></li><li><p><strong>å¤´ç»“æ„çš„ç¬¬ä¸‰ä¸ªå­—æ®µä¸ºå•é“¾è¡¨å¤´</strong></p></li><li><p><strong>é€‚ç”¨</strong> **std::**<strong>unsorted_map</strong> **&#x2F; std::**<strong>unsorted_set</strong> <strong>&#x2F; â€¦</strong></p></li></ul><p><img src="/../image/571.png" class="lazyload" data-srcset="/../image/571.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="571"></p><h3 id="std-unsorted-mapå†…å­˜å¸ƒå±€"><a href="#std-unsorted-mapå†…å­˜å¸ƒå±€" class="headerlink" title="std::unsorted_mapå†…å­˜å¸ƒå±€"></a>std::unsorted_mapå†…å­˜å¸ƒå±€</h3><p><img src="/../image/579.png" class="lazyload" data-srcset="/../image/579.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="579"></p><p>IDA dumpè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dump_stl_hashmap</span>(<span class="params">addr</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;dump stl hashmap gnu c++ x64&quot;&quot;&quot;</span></span><br><span class="line">    data_addr = []</span><br><span class="line">    bucket_addr = idc.read_dbg_qword(addr + <span class="number">0x10</span>)</span><br><span class="line">    node_addr = bucket_addr</span><br><span class="line">    <span class="keyword">while</span> node_addr != <span class="number">0</span>:</span><br><span class="line">        data_addr.append(node_addr+<span class="number">0x8</span>)</span><br><span class="line">        node_addr = idc.read_dbg_qword(node_addr)</span><br><span class="line">    <span class="keyword">return</span> data_addr    </span><br></pre></td></tr></table></figure><h2 id="std-shared-ptr"><a href="#std-shared-ptr" class="headerlink" title="std::shared_ptr"></a>std::shared_ptr</h2><ul><li>ç¬¬ä¸€ä¸ªæŒ‡é’ˆå°±æ˜¯æ•°æ®æŒ‡é’ˆ</li></ul><h3 id="std-shared-ptrå†…å­˜å¸ƒå±€"><a href="#std-shared-ptrå†…å­˜å¸ƒå±€" class="headerlink" title="std::shared_ptrå†…å­˜å¸ƒå±€"></a>std::shared_ptrå†…å­˜å¸ƒå±€</h3><p><img src="/../image/580.png" class="lazyload" data-srcset="/../image/580.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="580"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;STL-é€†å‘æ–¹æ³•è®º&quot;&gt;&lt;a href=&quot;#STL-é€†å‘æ–¹æ³•è®º&quot; class=&quot;headerlink&quot; title=&quot;STL é€†å‘æ–¹æ³•è®º&quot;&gt;&lt;/a&gt;STL é€†å‘æ–¹æ³•è®º&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;è¯†åˆ« STL å®¹å™¨ç±»å‹&lt;/li&gt;
&lt;li&gt;è¯†åˆ« STL å®¹å™¨æ“ä½œ&lt;/li</summary>
      
    
    
    
    <category term="IDAå­¦ä¹ " scheme="http://example.com/categories/IDA%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctfå­¦ä¹ " scheme="http://example.com/tags/ctf%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>IDAå­¦ä¹ ä¹‹ç±»å‹ä¿®å¤</title>
    <link href="http://example.com/2024/03/28/IDA%E5%AD%A6%E4%B9%A0%E4%B9%8B%E7%B1%BB%E5%9E%8B%E4%BF%AE%E5%A4%8D/"/>
    <id>http://example.com/2024/03/28/IDA%E5%AD%A6%E4%B9%A0%E4%B9%8B%E7%B1%BB%E5%9E%8B%E4%BF%AE%E5%A4%8D/</id>
    <published>2024-03-27T16:00:00.000Z</published>
    <updated>2024-03-28T09:16:46.866Z</updated>
    
    <content type="html"><![CDATA[<p>æºç ç¼–è¯‘æˆäºŒè¿›åˆ¶ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå¤§é‡è¾…åŠ©ä¿¡æ¯è¢«åˆ é™¤ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ç±»å‹ä¿¡æ¯</p><p>ä¸ºä»€ä¹ˆè¦ä¿®å¤ä¼ªä»£ç ä¸­çš„ç±»å‹ï¼Ÿ</p><ul><li>æé«˜ä¼ªä»£ç çš„å‡†ç¡®åº¦</li><li>æŒ‡å¯¼ IDA åç¼–è¯‘å™¨ä¸­çš„ä¼˜åŒ–å™¨ä½¿ç”¨æ­£ç¡®çš„ä¼˜åŒ–æ–¹æ¡ˆ</li><li>è®© IDA ç”Ÿæˆçš„ä¼ªä»£ç æ›´æ¥è¿‘æºç </li></ul><p>æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä¿®å¤å“ªäº›ç±»å‹ï¼Ÿ</p><ul><li>å‡½æ•°è¿”å›å€¼ç±»å‹</li><li>å‚æ•°ç±»å‹ &#x2F; å±€éƒ¨å˜é‡ç±»å‹ &#x2F; å…¨å±€å˜é‡ç±»å‹</li><li>æ•°ç»„ç±»å‹ &#x2F; æ•°ç»„å¤§å°</li><li>ç»“æ„ä½“ç±»å‹</li><li>è™šè¡¨ç±»å‹</li></ul><h2 id="åˆ¤æ–­å‡½æ•°çš„è¿”å›å€¼æ˜¯å¦æœ‰æ„ä¹‰"><a href="#åˆ¤æ–­å‡½æ•°çš„è¿”å›å€¼æ˜¯å¦æœ‰æ„ä¹‰" class="headerlink" title="åˆ¤æ–­å‡½æ•°çš„è¿”å›å€¼æ˜¯å¦æœ‰æ„ä¹‰"></a>åˆ¤æ–­å‡½æ•°çš„è¿”å›å€¼æ˜¯å¦æœ‰æ„ä¹‰</h2><p><img src="/../image/581.png" class="lazyload" data-srcset="/../image/581.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="581"></p><p>å¾ˆæ˜¾ç„¶è¿™ä¸ªå‡½æ•°æ˜¯æ²¡æœ‰è¿”å›å€¼çš„</p><p><img src="/../image/582.png" class="lazyload" data-srcset="/../image/582.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="582"></p><p>ä¿®å¤å®Œå°±çœ‹èµ·æ¥ç®€ä¾¿äº†å¾ˆå¤š</p><p><img src="/../image/583.png" class="lazyload" data-srcset="/../image/583.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="583"></p><h2 id="IDA-ä¸­æœ€å¸¸è§çš„ç±»å‹è¯†åˆ«é”™è¯¯ï¼šæŒ‡é’ˆå‹è¯†åˆ«ä¸ºæ•´æ•°å‹"><a href="#IDA-ä¸­æœ€å¸¸è§çš„ç±»å‹è¯†åˆ«é”™è¯¯ï¼šæŒ‡é’ˆå‹è¯†åˆ«ä¸ºæ•´æ•°å‹" class="headerlink" title="IDA ä¸­æœ€å¸¸è§çš„ç±»å‹è¯†åˆ«é”™è¯¯ï¼šæŒ‡é’ˆå‹è¯†åˆ«ä¸ºæ•´æ•°å‹"></a>IDA ä¸­æœ€å¸¸è§çš„ç±»å‹è¯†åˆ«é”™è¯¯ï¼šæŒ‡é’ˆå‹è¯†åˆ«ä¸ºæ•´æ•°å‹</h2><p>å›¾ä¸­èµ‹å€¼è¯­å¥çš„å·¦ä¾§æœ‰ä¸¤æ¬¡å†…å­˜è®¿é—®</p><p>ç¬¬ä¸€æ¬¡å†…å­˜è®¿é—®ï¼š t &#x3D; *(_DWORD *)(a1 + 4 * v5)</p><p>ç¬¬äºŒæ¬¡å†…å­˜è®¿é—®ï¼š *(_BYTE *)(a3 + t)</p><p><img src="/../image/584.png" class="lazyload" data-srcset="/../image/584.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="584"></p><p>ç¬¬ä¸€æ¬¡å†…å­˜è®¿é—®ï¼š v5 ä¸ºä¸‹æ ‡ï¼Œa1 ä¸ºå››å­—èŠ‚æ•´æ•°æ•°ç»„åŸºåœ°å€ï¼ŒIDA å°† a1 çš„ç±»å‹è¯†åˆ«ä¸º intï¼Œæ­£ç¡®çš„ç±»å‹åº”è¯¥æ˜¯ int *</p><p>ç¬¬äºŒæ¬¡å†…å­˜è®¿é—®ï¼š a3 ä¸º char * æ•°ç»„åŸºåœ°å€ï¼Œt ä¸ºæ•°ç»„ä¸‹æ ‡</p><p>ä¿®å¤å</p><p><img src="/../image/585.png" class="lazyload" data-srcset="/../image/585.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="585"></p><p>IDA æ•°ç»„ä¿®å¤ä¸»è¦æœ‰ä¸¤ç§ï¼š</p><p>1.å±€éƒ¨å˜é‡ä¸­å®šä¹‰çš„æ•°ç»„</p><p>2.å…¨å±€å˜é‡ä¸­å®šä¹‰çš„æ•°ç»„</p><p>æ•°ç»„ä¿®å¤è¦è€ƒè™‘ï¼šæ•°æ®ç±»å‹ + æ•°ç»„å¤§å°</p><h2 id="å±€éƒ¨å˜é‡ä¸­çš„æ•°ç»„ä¿®å¤"><a href="#å±€éƒ¨å˜é‡ä¸­çš„æ•°ç»„ä¿®å¤" class="headerlink" title="å±€éƒ¨å˜é‡ä¸­çš„æ•°ç»„ä¿®å¤"></a>å±€éƒ¨å˜é‡ä¸­çš„æ•°ç»„ä¿®å¤</h2><p><img src="/../image/586.png" class="lazyload" data-srcset="/../image/586.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="586"></p><p>If ä¸­å­˜åœ¨ Source[32] å¼•ç”¨ï¼ŒSource æ˜¯ä¸€ä¸ªæœªåˆå§‹åŒ–æ•°ç»„ã€çœ‹ä¸Šå»è«åå…¶å¦™ã€‘</p><p>é—®é¢˜ï¼š</p><ul><li>IDA é”™è¯¯è¯†åˆ«äº† Str æ•°ç»„å¤§å°ï¼Œå¯¼è‡´ Str æ•°ç»„çš„ä¸€éƒ¨åˆ†å˜æˆäº† Source æ•°ç»„</li></ul><p>è§£å†³ï¼š</p><ul><li>ä¿®æ­£ Str æ•°ç»„çš„å¤§å°ä¸º 52</li></ul><p>ä¿®å¤å</p><p><img src="/../image/587.png" class="lazyload" data-srcset="/../image/587.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="587"></p><p>å…¨å±€å˜é‡ä¸­çš„æ•°ç»„ä¿®å¤</p><p><img src="/../image/589.png" class="lazyload" data-srcset="/../image/589.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="589"></p><ul><li><p>è¿™æ˜¯ä¸€ä¸ªæ•´æ•°æ•°ç»„æ•°æ®ï¼Œå…¨å±€å˜é‡ï¼Œæ•°æ®ä½äº .data æ®µ</p></li><li><p>æˆ‘ä»¬é€šè¿‡å¯¹ a1 åœ°å€å¼•ç”¨çš„ä»£ç åˆ†æåå¾—å‡ºï¼š</p><ul><li><p>a1 æ˜¯æ•´æ•°æ•°ç»„</p></li><li><p>a1 æ•°ç»„çš„å¤§å°ä¸º 32</p></li></ul></li></ul><p>å¦‚ä½•ä¿®æ­£å‘¢ï¼Ÿ</p><ul><li>ç‚¹å‡»ç¬¬ä¸€é¡¹åœ°å€æŒ‰ d é”®ï¼Œè°ƒæ•´ a1 ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¤§å°ä¸ºæ•°ç»„å…ƒç´ ç±»å‹å¯¹åº”çš„ç±»å‹å­—èŠ‚å¤§å°ï¼Œddï¼ˆ4ï¼‰ dwï¼ˆ2ï¼‰ dbï¼ˆ1ï¼‰</li><li>å³é”®é€‰æ‹© ã€Arrayã€‘ï¼Œåœ¨ ã€Array Sizeã€‘å¡«ä¸Šæ•°ç»„å¯¹åº”çš„å…ƒç´ ä¸ªæ•°</li><li>æœ€åç‚¹å‡» ã€okã€‘<br><img src="/../image/588.png" class="lazyload" data-srcset="/../image/588.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="588"></li></ul><h2 id="ä¿®å¤æšä¸¾å€¼"><a href="#ä¿®å¤æšä¸¾å€¼" class="headerlink" title="ä¿®å¤æšä¸¾å€¼"></a>ä¿®å¤æšä¸¾å€¼</h2><p>IDA çš„ç±»å‹æ•°æ®åº“å†…ç½®äº†å¸¸è§çš„æšä¸¾ï¼ˆå®ï¼‰çš„å€¼ï¼Œå¯ä»¥ç›´æ¥å¼•å…¥å¹¶ä¿®å¤ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢å¯¹äº ptrace çš„è°ƒç”¨</p><p><img src="/../image/590.png" class="lazyload" data-srcset="/../image/590.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="590"></p><p>ç¬¬ä¸€ä¸ªæ•°å­—ä»£è¡¨çš„æ˜¯å®ƒè¦å®ç°çš„åŠŸèƒ½</p><p>é€‰ä¸­ 12 è¿™ä¸ªæ•°å­—ï¼ŒæŒ‰ä¸‹å¿«æ·é”® â€œMâ€ï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©å¯¹åº”çš„å¸¸é‡å€¼ã€‚</p><p><img src="/../image/591.png" class="lazyload" data-srcset="/../image/591.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="591"></p><h2 id="IDAç»“æ„ä½“ä¿®å¤"><a href="#IDAç»“æ„ä½“ä¿®å¤" class="headerlink" title="IDAç»“æ„ä½“ä¿®å¤"></a>IDAç»“æ„ä½“ä¿®å¤</h2><ul><li>ç¡®å®šç»“æ„ä½“å¤§å°</li></ul><p><img src="/../image/592.png" class="lazyload" data-srcset="/../image/592.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="592"></p><p>â€‹     -  å†…å­˜åˆ†é…å¯ä»¥ç›´æ¥ç¡®å®šç»“æ„ä½“å¤§å°</p><p>â€‹     -  memcpy &#x2F; å±€éƒ¨å˜é‡åç§»å·® -&gt; é—´æ¥ç¡®å®š ï¼ˆç»“æ„ä½“&#x2F;ç±»å±€éƒ¨å˜é‡ï¼‰</p><ul><li>åˆ›å»ºç›¸ç­‰å¤§å°åŒ¿åç»“æ„ä½“ï¼Œå¹¶å°†ç›¸å…³å˜é‡ã€å‚æ•°çš„ç±»å‹ä¿®æ”¹ä¸ºè¯¥ç»“æ„ä½“</li></ul><p><img src="/../image/593.png" class="lazyload" data-srcset="/../image/593.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="593"></p><ul><li><p>åˆ›å»ºç›¸ç­‰å¤§å°åŒ¿åç»“æ„ä½“ï¼Œå¹¶å°†ç›¸å…³å˜é‡ã€å‚æ•°çš„ç±»å‹ä¿®æ”¹ä¸ºè¯¥ç»“æ„ä½“</p></li><li><p>æ–¹æ³•ä¸€ï¼šConvert ..</p></li></ul><p>åœ¨å‡½æ•°é‡Œé¢å°†ç¬¬ä¸€ä¸ªå‚æ•°æ”¹ä¸ºç»“æ„ä½“æŒ‡é’ˆåï¼Œæˆ‘ä»¬å‘ç°è¿˜æœ‰LODWORDï¼Œå› ä¸ºæˆ‘ä»¬è®¾ç½®çš„æ˜¯dqword</p><p><img src="/../image/594.png" class="lazyload" data-srcset="/../image/594.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="594"></p><p>æˆ‘ä»¬åªéœ€æŠŠå®ƒè®¾ç½®æˆDWORDå°±è¡Œ</p><p><img src="/../image/595.png" class="lazyload" data-srcset="/../image/595.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="595"></p><p><img src="/../image/596.png" class="lazyload" data-srcset="/../image/596.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="596"></p><ul><li><p>å¯ä»¥çœ‹å‡º field_4C æ˜¯ DWORD æ•°ç»„ 5 ä¸ªå…ƒç´ ã€‚</p></li><li><p>åœ¨ field_4C ä½ç½®å³é”®ï¼Œç‚¹å‡» [Array] ï¼Œåˆ›å»ºæ•°ç»„ï¼Œå¦‚ä¸‹å›¾ã€‚</p></li><li><p>ç»™ field_4C å–ä¸€ä¸ªåå­—ï¼Œå« array1</p></li></ul><p><img src="/../image/597.png" class="lazyload" data-srcset="/../image/597.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="597"></p><ul><li><p>è¿™é‡Œåˆå§‹åŒ–äº†å¾ˆå¤šå¯¹è±¡ï¼Œå…± 64 ä¸ªï¼ˆçœ‹æ„é€ å‡½æ•°äº¤å‰å¼•ç”¨æ•°ï¼‰</p></li><li><p>å¯¹è±¡çš„æŒ‡é’ˆçš„å­˜åˆ°äº†è¿ç»­å…¨å±€å†…å­˜ A1C0</p></li><li><p>å› æ­¤ 0xA1C0 æ˜¯ struc_1 * [66] æ•°ç»„</p></li><li><p>å­—ç¬¦ä¸²åæ˜¯å¤§å¯Œç¿é‡Œçš„åœ°å›¾æˆ¿å­ç±»å‹åã€‚</p></li><li><p>0xA1C0 å¯èƒ½æ˜¯åœ°å›¾ï¼Œ struc_1 æ”¹åæˆ house</p></li></ul><p><img src="/../image/598.png" class="lazyload" data-srcset="/../image/598.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="598"></p><ul><li><p>åˆ†æå¦å¤–ä¸€ä¸ªç»“æ„ä½“ï¼Œè¿™ä¸ªç»“æ„ä½“æ²¡æœ‰ä½¿ç”¨ new &#x2F; malloc åˆ†é…å†…å­˜ï¼Œå¦‚ä½•ç¡®å®šå¤§å°ï¼Ÿ</p></li><li><p>åŒä¸€ä¸ªå‡½æ•°ï¼ŒçŒœæµ‹è¿™ä¸¤ä¸ªç»“æ„ä½“ç›¸é‚»ï¼Œåœ°å€åšå·®å¾—åˆ° 0x80</p></li></ul><p><img src="/../image/599.png" class="lazyload" data-srcset="/../image/599.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="599"></p><ul><li>å…¨å±€å­—æ®µäº¤å‰å¼•ç”¨ Ctrl + alt + X ï¼ˆè¦å°½å¯èƒ½å°†ç›¸å…³å‡½æ•°æ‰¾å‡ºæ¥å¹¶ä¿®å¤ç±»å‹ï¼Œæœ‰åˆ©äºæŸ¥æ‰¾ï¼‰</li></ul><h2 id="IDA-è™šè¡¨ä¿®å¤"><a href="#IDA-è™šè¡¨ä¿®å¤" class="headerlink" title="IDA è™šè¡¨ä¿®å¤"></a>IDA è™šè¡¨ä¿®å¤</h2><ul><li>è™šè¡¨ä¿®å¤ä¸»è¦æ˜¯ä¸ºäº†é‡å»ºè™šè¡¨äº¤å‰å¼•ç”¨</li></ul><p><img src="/../image/600.png" class="lazyload" data-srcset="/../image/600.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="600"></p><ul><li>æ²¡æœ‰ä¿®å¤ï¼Œä¸çŸ¥é“å¼•ç”¨çš„æ˜¯ä»€ä¹ˆå‡½æ•°</li><li>æ‰¾åˆ°ä¸€ä¸ªè™šè¡¨çš„å‡½æ•°è¡¨</li></ul><p><img src="/../image/601.png" class="lazyload" data-srcset="/../image/601.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="601"></p><p>æŒ‰ç…§ä»¥ä¸Šå‡½æ•°è¡¨åˆ›å»ºç»“æ„ä½“ vtable</p><ul><li>åˆ›å»ºç»“æ„ä½“å¦‚ä¸‹:</li></ul><p><img src="/../image/602.png" class="lazyload" data-srcset="/../image/602.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="602"></p><ul><li>åˆ›å»ºç±»ç»“æ„ä½“ï¼Œå¹¶å°†ç¬¬ä¸€ä¸ªæˆå‘˜çš„ç±»å‹è®¾ç½®æˆè™šè¡¨æŒ‡é’ˆ</li></ul><p><img src="/../image/603.png" class="lazyload" data-srcset="/../image/603.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="603"></p><p>ä¿®å¤ä¹‹å</p><p><img src="/../image/604.png" class="lazyload" data-srcset="/../image/604.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="604"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æºç ç¼–è¯‘æˆäºŒè¿›åˆ¶ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå¤§é‡è¾…åŠ©ä¿¡æ¯è¢«åˆ é™¤ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ç±»å‹ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¦ä¿®å¤ä¼ªä»£ç ä¸­çš„ç±»å‹ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æé«˜ä¼ªä»£ç çš„å‡†ç¡®åº¦&lt;/li&gt;
&lt;li&gt;æŒ‡å¯¼ IDA åç¼–è¯‘å™¨ä¸­çš„ä¼˜åŒ–å™¨ä½¿ç”¨æ­£ç¡®çš„ä¼˜åŒ–æ–¹æ¡ˆ&lt;/li&gt;
&lt;li&gt;è®© IDA ç”Ÿæˆçš„ä¼ª</summary>
      
    
    
    
    <category term="IDAå­¦ä¹ " scheme="http://example.com/categories/IDA%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctfå­¦ä¹ " scheme="http://example.com/tags/ctf%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>IDAç–‘éš¾æ‚ç—‡å­¦ä¹ </title>
    <link href="http://example.com/2024/03/27/IDA%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87%E5%AD%A6%E4%B9%A0/"/>
    <id>http://example.com/2024/03/27/IDA%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87%E5%AD%A6%E4%B9%A0/</id>
    <published>2024-03-26T16:00:00.000Z</published>
    <updated>2024-03-27T17:19:41.414Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-IDA-Decompile-as-call"><a href="#1-IDA-Decompile-as-call" class="headerlink" title="1.IDA Decompile as call"></a>1.IDA Decompile as call</h2><p>å¼ºç½‘æ¯æŸvmé€†å‘é‡å»ºåçš„ä»£ç ï¼Œå…¶syscall äºæ ‡å‡†çš„ Linux syscall æœ‰åŒºåˆ«ï¼Œå¯¼è‡´ IDA å¯¹å…¶ä¼˜åŒ–äº§ç”Ÿé”™è¯¯çš„ä»£ç </p><p>è®¾æƒ³ä¸€ç§æƒ…å†µï¼Œåœ¨ä¸€ä¸ªè‡ªå®šä¹‰è¿è¡Œç¯å¢ƒä¸­ï¼Œsyscall</p><ul><li><p>rax ä¼ å…¥è°ƒç”¨å·</p></li><li><p>rax ä½œä¸ºè¿”å›å€¼ä¼ é€’</p></li></ul><p>é»˜è®¤æƒ…å†µ(linux syscall)ä¸‹,idaè®¤ä¸ºæ­¤å¤„çš„ syscall ä¸ä¼šä¿®æ”¹ rax å¯„å­˜å™¨çš„å€¼,å¯¼è‡´ raxå¯„å­˜å™¨å¸¸é‡ä¼ æ’­ä¼˜åŒ–</p><p><img src="/../image/546.png" class="lazyload" data-srcset="/../image/546.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="546"></p><p>è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä¹Ÿæ— æ³•çœ‹å‡ºå®ƒå¯¹eaxçš„å¤„ç†ä½“ç°åœ¨å“ªé‡Œï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°†å®ƒå˜æˆä¸€æ¡callæŒ‡ä»¤</p><p>1.é€‰ä¸­syscallæŒ‡ä»¤</p><p>2.èœå•ï¼šEdit -&gt; Other -&gt; Decompile as  call è¾“å…¥å¦‚ä¸‹å®šä¹‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int __usercall mysyscall@&lt;eax&gt;(int num@&lt;eax&gt;);</span><br></pre></td></tr></table></figure><p>å°†ä¸¤æ¬¡è¯»å– fs:0 ç”¨Decompile as call å®šä¹‰ä¸º: </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__int64 getFuckKey();</span><br></pre></td></tr></table></figure><p><img src="/../image/547.png" class="lazyload" data-srcset="/../image/547.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="547"></p><p>ä¿®å¤å</p><p><img src="/../image/548.png" class="lazyload" data-srcset="/../image/548.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="548"></p><h2 id="2-IDA-positive-sp-value"><a href="#2-IDA-positive-sp-value" class="headerlink" title="2.IDA positive sp value"></a>2.IDA positive sp value</h2><p>è¿™æ˜¯ç”±äºæ ˆä¸å¹³è¡¡å¯¼è‡´çš„</p><p><img src="/../image/549.png" class="lazyload" data-srcset="/../image/549.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="549"></p><p>ç‚¹å‡»options-generalï¼Œå‹¾é€‰ stack pointer</p><p><img src="/../image/550.png" class="lazyload" data-srcset="/../image/550.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="550"></p><p>æ˜¯è¿™é‡Œå¯¼è‡´äº†æ ˆä¸å¹³è¡¡</p><p><img src="/../image/551.png" class="lazyload" data-srcset="/../image/551.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="551"></p><p><img src="/../image/552.png" class="lazyload" data-srcset="/../image/552.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="552"></p><h2 id="3-IDA-too-big-stack-frame"><a href="#3-IDA-too-big-stack-frame" class="headerlink" title="3.IDA too big stack frame"></a>3.IDA too big stack frame</h2><p>è¿™ä¸ªåŸç†å…¶å®è·Ÿæ ˆä¸å¹³è¡¡ä¸€æ ·ï¼Œåªä¸è¿‡ add esp , xxxx çš„æ—¶å€™å°†æ ˆæ”¹çš„ç‰¹åˆ«å¤§ï¼Œæˆ‘ä»¬ä¾æ—§å‹¾é€‰stack pointer</p><p><img src="/../image/553.png" class="lazyload" data-srcset="/../image/553.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="553"></p><h2 id="4-IDA-è·³è½¬è¡¨ä¿®å¤"><a href="#4-IDA-è·³è½¬è¡¨ä¿®å¤" class="headerlink" title="4.IDA è·³è½¬è¡¨ä¿®å¤"></a>4.IDA è·³è½¬è¡¨ä¿®å¤</h2><p>æœ‰çš„æ—¶å€™è¯†åˆ«ä¸å‡ºæ¥ï¼Œå–å†³äºIDAçš„ç‰ˆæœ¬</p><p>ç¬”è€…åœ¨æ­¤ä½¿ç”¨çš„æ˜¯IDA 7.6</p><p><img src="/../image/554.png" class="lazyload" data-srcset="/../image/554.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="554"></p><p><img src="/../image/555.png" class="lazyload" data-srcset="/../image/555.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="555"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Edit -&gt; Other -&gt; Specify Switch.. æ‰“å¼€é…ç½®çª—å£</span><br></pre></td></tr></table></figure><p><img src="/../image/556.png" class="lazyload" data-srcset="/../image/556.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="556"></p><p><img src="/../image/557.png" class="lazyload" data-srcset="/../image/557.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="557"></p><h2 id="5-å‡½æ•°å¤§å°é™åˆ¶"><a href="#5-å‡½æ•°å¤§å°é™åˆ¶" class="headerlink" title="5.å‡½æ•°å¤§å°é™åˆ¶"></a>5.å‡½æ•°å¤§å°é™åˆ¶</h2><ul><li><p>IDA åç¼–è¯‘å‡½æ•°æœ‰å¤§å°é™åˆ¶ï¼Œè¶…è¿‡æœ€å¤§é•¿åº¦å°†æŠ¥é”™</p></li><li><p>cfg&#x2F;hexrays.cfg é…ç½®æ–‡ä»¶å¯ä»¥ä¿®æ”¹æœ€å¤§åç¼–è¯‘å‡½æ•°å¤§å°é…ç½®é¡¹</p></li><li><p>é…ç½®é¡¹ï¼šMAX_FUNCSIZEï¼Œé»˜è®¤ 64</p></li></ul><h2 id="6-Golang-åç¼–è¯‘å¤±è´¥å¤„ç†"><a href="#6-Golang-åç¼–è¯‘å¤±è´¥å¤„ç†" class="headerlink" title="6.Golang åç¼–è¯‘å¤±è´¥å¤„ç†"></a>6.Golang åç¼–è¯‘å¤±è´¥å¤„ç†</h2><ul><li><p>é€†å‘åˆ†æ golang å‡½æ•°æ—¶ï¼ŒæŠ¥é”™ â€œCall analysis failedâ€¦â€</p></li><li><p>é—®é¢˜åŸå› æ˜¯ IDA åˆ†æ 0xBB620 å¤„å‡½æ•°è°ƒç”¨çš„ç›®æ ‡å‡½æ•°å‚æ•°é”™è¯¯</p></li><li><p>ä¿®æ”¹è°ƒç”¨ç›®æ ‡å‡½æ•°çš„åŸå‹å®šä¹‰ä¸º void x(); å³å¯è§£å†³é—®é¢˜</p></li></ul><p><img src="/../image/558.png" class="lazyload" data-srcset="/../image/558.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="558"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-IDA-Decompile-as-call&quot;&gt;&lt;a href=&quot;#1-IDA-Decompile-as-call&quot; class=&quot;headerlink&quot; title=&quot;1.IDA Decompile as call&quot;&gt;&lt;/a&gt;1.IDA Decompile a</summary>
      
    
    
    
    <category term="IDAå­¦ä¹ " scheme="http://example.com/categories/IDA%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ctfå­¦ä¹ " scheme="http://example.com/tags/ctf%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
</feed>
